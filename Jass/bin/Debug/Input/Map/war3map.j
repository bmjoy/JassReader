globalsstring array hinteger oreal Areal Breal array C
real array D
real array E
real array F
real array G
real Hreal Ireal Jinteger Ktimer Litem array M
integer Ncode Oreal Pinteger array Qconstant timer R=CreateTimer()unit array S
real array T
real array U
integer array Vinteger W=0boolexpr Xtimer Yboolean Z=falseinteger d4integer array e4
integer array f4
integer array g4
integer array h4
integer array i4
integer array j4
integer array k4
real array m4real array n4real o4real p4constant group q4=CreateGroup()player r4integer array t4
real array u4boolean array v4
boolean array w4
integer array x4
trigger array y4
unit z4real array A4trigger array a4
unit B4trigger array b4
integer array C4
unit c4unit D4string array E4integer F4=0
integer G4=0
integer H4=0
constant integer I4=$C8boolean l4=trueboolean array J4
constant timer K4=CreateTimer()unit array L4real array M4real array N4integer array O4
real array P4integer Q4=0
boolean R4=false
boolexpr S4player T4=nullconstant force U4=CreateForce()constant trigger V4=CreateTrigger()integer W4integer X4constant timer Y4=CreateTimer()unit array Z4real array d7integer array e7
integer array f7
unit array g7real array h7boolean array i7
integer j7=0
boolexpr k7constant integer m7=StringLength("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_-+= \\!@#$%^&*()/?>.<,;:'\"{}[]|`~")string array n7string array o7string array p7string array q7string array r7boolean s7=false
gamecache t7=nullinteger u7=1
integer v7=0
timer w7=CreateTimer()integer x7=0
integer y7=0
constant player z7=Player($F)constant timer A7=CreateTimer()destructable array a7unit array B7boolean b7=false
trigger C7=nullinteger c7=0
integer array D7
integer array E7
string array F7integer array G7
sound array H7boolean array I7
integer l7=0
constant trigger J7=CreateTrigger()integer array K7
timer L7=nulltimer array M7timer array N7timerdialog array O7
real array P7integer array Q7
string array R7location array S7boolean array T7
constant trigger U7=CreateTrigger()boolean V7=false
real W7real X7real Y7real Z7unit array d8integer e8constant sound g8=CreateSoundFromLabel("InterfaceError",false,false,false,$A,$A)
boolean h8=truereal array i8playercolor array j8
constant playercolor k8=GetPlayerColor(Player($F))boolean m8=false
region n8region o8integer p8integer q8trigger r8trigger s8unit t8unit u8integer array v8
integer w8integer x8='A0D1'integer y8='A0D0'integer z8='A0E3'integer array A8
integer array a8
boolexpr B8boolean b8integer array C8
integer c8boolean D8boolexpr E8unit array F8unit array G8integer H8integer array I8
integer l8boolexpr J8boolexpr K8unit array L8boolean array M8
real array N8real array O8boolexpr P8boolexpr Q8boolexpr R8boolexpr S8boolexpr T8unit array U8real array V8real array W8timer array X8integer Y8=0
code Z8constant trigger d9=CreateTrigger()player e9integer f9integer g9group h9
hashtable i9=InitHashtable()
integer j9integer k9integer m9integer n9integer o9integer p9integer q9integer r9integer s9integer t9integer u9integer v9integer w9boolexpr x9boolexpr y9constant group z9=CreateGroup()boolexpr A9constant timer a9=CreateTimer()constant timer B9=CreateTimer()boolexpr b9rect C9boolean c9=false
multiboard array D9multiboard array E9integer array F9
multiboard G9=nullinteger array H9
integer I9=0
string array l9multiboarditem J9integer K9=0
constant timer L9=CreateTimer()integer M9integer N9constant hashtable O9=InitHashtable()constant group P9=CreateGroup()rect Q9location R9boolean S9=trueboolean T9=false
boolean U9=false
string V9integer W9=$FAinteger X9='}'integer Y9=1
integer Z9=-1integer dd=0
integer ed=0
integer fd=2
integer gd=-1integer hd=$Aboolean jdboolean kd=false
boolean md=false
boolean nd=false
boolean od=false
boolean pd=trueboolean qd=trueboolean rd=trueboolean sd=trueboolean td=false
boolean ud=trueboolean vd=false
boolean wd=false
boolean xd=false
boolean yd=trueboolean zd=false
integer Ad=0
integer ad=-1integer Bd=0
integer bd=0
integer Cd=0
integer cd=0
integer Dd=0
integer Ed=0
integer Fd=0
boolean array Gd
integer array Hd
location array Idinteger array ld
group array Jdinteger array Kd
rect array Ldinteger array Md
integer array Nd
string array Odinteger array Pd
location array Qdinteger array Rd
integer array Sd
integer array Td
integer array Ud
integer array Vd
integer array Wd
integer array Xd
integer array Yd
integer array Zd
integer array de
integer array ee
integer array fe
integer array ge
integer array he
constant force ie=CreateForce()constant force je=CreateForce()constant force ke=CreateForce()integer array me
force array neunit array oestring array peboolean array qe
integer re=0
timer se
integer array te
real array ueinteger array ve
integer array xe
integer array ye
boolean array ze
real array Aeunit array aeboolean array Be
unit array beforce array Cetimer array ceboolean array De
player array Eeboolean Fe=trueboolean Ge=false
constant integer He=7-1integer array Ie
boolexpr leinteger Jeinteger Keinteger Leinteger Meinteger Neinteger Oeinteger Peinteger Qeinteger Reinteger Seinteger Teinteger Ueinteger array Ve
integer We='A01I'integer Xeboolexpr Yeboolexpr Zeinteger df='n01C'boolexpr efconstant group ff=CreateGroup()boolexpr gfboolexpr hfconstant timer jf=CreateTimer()real kf=25.real array mfinteger array nf
string ofreal array pfinteger qfconstant group rf=CreateGroup()boolexpr sfboolexpr tfboolexpr ufinteger vf='A0BD'weathereffect wf
boolexpr xfboolexpr yfinteger zf='A07T'constant group Af=CreateGroup()boolexpr afinteger array Bf
constant trigger bf=CreateTrigger()boolexpr Cfboolexpr cfboolexpr Dfconstant timer Ef=CreateTimer()unit array Ffinteger Gf=0
weathereffect Hf
real Ifreal lfreal Jfreal Kfboolexpr Lfinteger array Mf
trigger Nf=nullboolean Ofboolean Pfboolexpr Qfstring Rftimer Sf=nulltrigger Tf=nullinteger array Uf
integer array Vf
timer Wf=nulltimer Xf=CreateTimer()timerdialog Yftrigger Zf=CreateTrigger()dialog dg=DialogCreate()
button array egboolean fg=false
boolean gg=false
trigger hgtrigger igtrigger jgboolexpr kginteger mg=0
constant timer ng=CreateTimer()constant timerdialog og=CreateTimerDialog(ng)integer pg=-1integer qgboolean array rg
boolean sg=false
string tg=nullboolean ug=false
constant timer vg=CreateTimer()boolean wg=false
integer xginteger ygconstant trigger zg=CreateTrigger()fogmodifier Agfogmodifier aginteger Bg=-1integer bgtrigger Cgrect cg=null
rect Dg=null
rect Eg=null
rect Fg=null
sound Gg=nullsound Hg=nullsound Ig=nullsound lg=nullsound Jg=nullsound Kg=nullsound Lg=nullsound Mg=nullsound Ng=nullsound Og=nullsound Pg=nullsound Qg=nullsound Rg=nullsound Sg=nullsound Tg=nullsound Ug=nulltrigger Vg=nulltrigger Wg=nulltrigger Xg=nulltrigger Yg=nulltrigger Zg=nulltrigger dh=nulltrigger eh=nulltrigger fh=nulltrigger gh=nulltrigger hh=nulltrigger ih=nulltrigger jh=nulltrigger kh=nullforce mh
boolean nh=trueboolexpr ohinteger ph=0
integer qh=0
integer array rh
real array shstring array thinteger array uh
string array vhinteger array wh
integer xh=0
integer yh=0
integer array zh
integer array Ah
trigger array ah
trigger array Bh
integer bh=0
integer Ch=0
integer array Dh
integer array Eh
integer array Fh
integer array Gh
integer Hh=0
integer Ih=0
integer array lh
integer Jh=0
integer Kh=0
integer array Lh
integer Mh=0
integer Nh=0
integer array Oh
integer array Ph
integer array Qh
integer array Rh
integer Sh=0
integer Th=0
integer array Uh
integer array Vh
integer array Wh
integer array Xh
integer array Yh
integer array Zh
integer array di
integer array ei
integer array fi
trigger gitrigger hiunit iiinteger jiinteger kiboolean miendglobalsnative GetUnitGoldCost takes integer unitid returns integernative GetUnitWoodCost takes integer unitid returns integernative GetUnitBuildTime takes integer unitid returns integer
native GetUpgradeLevel takes integer id returns integernative GetUpgradeGoldCost takes integer id returns integernative GetUpgradeWoodCost takes integer id returns integerfunction ni takes nothing returns integerlocal integer oi=phif(oi!=0)thenset ph=rh[oi]else
set qh=qh+1set oi=qhendifif(oi>8190)thenreturn 0
endifset wh[oi]=0
set rh[oi]=-1return oiendfunctionfunction pi takes nothing returns integerlocal integer oi=Shif(oi!=0)thenset Sh=Uh[oi]else
set Th=Th+1set oi=Thendifif(oi>$CB)thenreturn 0
endifset Wh[oi]=(oi-1)*40
set Yh[oi]=(oi-1)*7set di[oi]=(oi-1)*16
set fi[oi]=(oi-1)*4set Uh[oi]=-1return oiendfunctionfunction qi takes nothing returns integerlocal integer oi=Mhif(oi!=0)thenset Mh=Oh[oi]else
set Nh=Nh+1set oi=Nhendifif(oi>$7FE)thenreturn 0
endifset Qh[oi]=(oi-1)*4set Oh[oi]=-1return oiendfunctionfunction ri takes nothing returns integerlocal integer oi=Jhif(oi!=0)thenset Jh=Lh[oi]else
set Kh=Kh+1set oi=Khendifif(oi>8190)thenreturn 0
endifset Lh[oi]=-1return oiendfunctionfunction si takes nothing returns integerlocal integer oi=Hhif(oi!=0)thenset Hh=lh[oi]else
set Ih=Ih+1set oi=Ihendifif(oi>8190)thenreturn 0
endifset lh[oi]=-1return oiendfunctionfunction ti takes integer oi,unit u returns booleanset ki=oiset ii=u
call TriggerEvaluate(Bh[Ah[oi]])
return miendfunctionfunction ui takes nothing returns integerlocal integer vi
local integer oi=xhif(oi!=0)thenset xh=zh[oi]else
set yh=yh+1set oi=yhendifif(oi>8190)thenreturn 0
endifset Ah[oi]=16set vi=oiset zh[oi]=-1return oiendfunctionfunction wi takes nothing returns integerlocal integer vi
local integer oi=xhif(oi!=0)thenset xh=zh[oi]else
set yh=yh+1set oi=yhendifif(oi>8190)thenreturn 0
endifset Ah[oi]=$Fset vi=oiset zh[oi]=-1return oiendfunctionfunction xi takes nothing returns integerlocal integer vi
local integer oi=xhif(oi!=0)thenset xh=zh[oi]else
set yh=yh+1set oi=yhendifif(oi>8190)thenreturn 0
endifset Ah[oi]=$Eset vi=oiset zh[oi]=-1return oiendfunctionfunction yi takes nothing returns integerlocal integer vi
local integer oi=xhif(oi!=0)thenset xh=zh[oi]else
set yh=yh+1set oi=yhendifif(oi>8190)thenreturn 0
endifset Ah[oi]=$Dset vi=oiset zh[oi]=-1return oiendfunctionfunction zi takes nothing returns integerlocal integer vi
local integer oi=xhif(oi!=0)thenset xh=zh[oi]else
set yh=yh+1set oi=yhendifif(oi>8190)thenreturn 0
endifset Ah[oi]=$Cset vi=oiset zh[oi]=-1return oiendfunctionfunction Ai takes nothing returns integerlocal integer vi
local integer oi=xhif(oi!=0)thenset xh=zh[oi]else
set yh=yh+1set oi=yhendifif(oi>8190)thenreturn 0
endifset Ah[oi]=$Bset vi=oiset zh[oi]=-1return oiendfunctionfunction Bi takes nothing returns integerlocal integer vi
local integer oi=xhif(oi!=0)thenset xh=zh[oi]else
set yh=yh+1set oi=yhendifif(oi>8190)thenreturn 0
endifset Ah[oi]=$Aset vi=oiset zh[oi]=-1return oiendfunctionfunction Ci takes nothing returns integerlocal integer vi
local integer oi=xhif(oi!=0)thenset xh=zh[oi]else
set yh=yh+1set oi=yhendifif(oi>8190)thenreturn 0
endifset Ah[oi]=9
set vi=oiset zh[oi]=-1return oiendfunctionfunction ci takes nothing returns integerlocal integer vi
local integer oi=xhif(oi!=0)thenset xh=zh[oi]else
set yh=yh+1set oi=yhendifif(oi>8190)thenreturn 0
endifset Ah[oi]=8
set vi=oiset zh[oi]=-1return oiendfunctionfunction Di takes nothing returns integerlocal integer vi
local integer oi=xhif(oi!=0)thenset xh=zh[oi]else
set yh=yh+1set oi=yhendifif(oi>8190)thenreturn 0
endifset Ah[oi]=7
set vi=oiset zh[oi]=-1return oiendfunctionfunction Ei takes nothing returns integerlocal integer vi
local integer oi=xhif(oi!=0)thenset xh=zh[oi]else
set yh=yh+1set oi=yhendifif(oi>8190)thenreturn 0
endifset Ah[oi]=6
set vi=oiset zh[oi]=-1return oiendfunctionfunction Fi takes nothing returns integerlocal integer vi
local integer oi=xhif(oi!=0)thenset xh=zh[oi]else
set yh=yh+1set oi=yhendifif(oi>8190)thenreturn 0
endifset Ah[oi]=5
set vi=oiset zh[oi]=-1return oiendfunctionfunction Gi takes integer oi,integer Hi returns nothingset Eh[Fh[oi]+Gh[oi]]=Hi
set Gh[oi]=Gh[oi]+1endfunctionfunction Ii takes nothing returns integerlocal integer oi=bhif(oi!=0)thenset bh=Dh[oi]else
set Ch=Ch+1set oi=Chendifif(oi>510)thenreturn 0
endifset Fh[oi]=(oi-1)*16
set Dh[oi]=-1return oiendfunctionfunction li takes integer oi returns nothing
if oi==null then
returnelseif(Dh[oi]!=-1)thenreturnendifset Dh[oi]=bhset bh=oiendfunctionfunction Ji takes nothing returns integerlocal integer vi
local integer oi=xhif(oi!=0)thenset xh=zh[oi]else
set yh=yh+1set oi=yhendifif(oi>8190)thenreturn 0
endifset Ah[oi]=17set vi=oiset zh[oi]=-1return oiendfunctionfunction Ki takes nothing returns string
local integer i=GetRandomInt(0,o)local string s=h[i]set h[i]=h[o]set o=o-1return s
endfunctionfunction Li takes nothing returns nothingset h[0]="General"set h[1]="FanToMace"
set h[2]="antiPOD"set h[3]="ADMIN"
set h[4]="Ms Weapon"
set h[5]="C|c00ff008000l"set h[6]="O|c00ff00ff:"set h[7]=":|c00ff8040O"set h[8]="INqUSitor"
set h[9]="Your_Death"set h[$A]="Nan Yanoi"set h[$B]="Impale"set h[$C]="Proxima"set h[$D]="13|c00ff0000th"set h[$E]="Mariana"set h[$F]="ProFan"set h[16]="Active"set h[17]="Master"set h[18]="Nice Guy"
set h[19]="Kasr'Kin"
set h[20]="Pr0[tag]on1st"set h[21]="Imperor"set h[22]="FBI agent :)"
set h[23]="Spell"set h[24]="WTFG0D"set h[25]="Leaver :P"set h[26]="Your Windows"
set h[27]="GreatWarrior"
set h[28]="ShadowOfFlame"set h[29]="No_Ob"set h[30]="Shurf"set h[31]="I am WH :'("set h[32]="CriticalError"set h[33]="Brain"set h[34]="L|c0000ff40ord"set h[35]="Princess"
set o=35
endfunctionfunction Mi takes nothing returns nothinglocal integer i=0if(md)thenset H=128.else
set H=128.*2.endifset F[0]=-1.*Hset G[0]=1.*Hset F[1]=-1.*Hset G[1]=-1.*Hset F[2]=1.*Hset G[2]=-1.*Hset F[3]=1.*Hset G[3]=1.*Hset D[0]=5568.set E[0]=512.set D[1]=5568.set E[1]=-1.*512.set D[2]=-1.*5568.set E[2]=-1.*512.set D[3]=-1.*5568.set E[3]=512.loop
set C[i]=E[i]set i=i+1exitwhen i>3
endloopendfunctionfunction Ni takes nothing returns nothinglocal integer i=0set H=128.set F[0]=-1.*Hset G[0]=1.*Hset F[1]=-1.*Hset G[1]=-1.*Hset F[2]=1.*Hset G[2]=-1.*Hset F[3]=1.*Hset G[3]=1.*Hset D[0]=5568.set E[0]=512.set D[1]=5568.set E[1]=-1.*512.set D[2]=-1.*5568.set E[2]=-1.*512.set D[3]=-1.*5568.set E[3]=512.loop
set C[i]=E[i]set i=i+1exitwhen i>3
endloopendfunctionfunction Oi takes integer Pi returns nothing
set A=D[Pi]set B=E[Pi]endfunctionfunction Qi takes integer Pi returns nothing
set E[Pi]=E[Pi]+(G[Pi])if(RAbsBJ(E[Pi])>1920.)thenset D[Pi]=D[Pi]+(F[Pi])if(RAbsBJ(D[Pi])<1664.)thencall Ni()returnendifset E[Pi]=C[Pi]endifendfunctionfunction Ri takes nothing returns nothinglocal unit u=GetEnumUnit()set I=I+(GetUnitX(u))set J=J+(GetUnitY(u))set K=K+1set u=nullendfunctionfunction Si takes unit Ti,unit Ui returns booleanset r4=GetOwningPlayer(Ui)if(IsPlayerInForce(r4,ie))thencall DisplayTextToForce(ie,pe[GetPlayerId(GetOwningPlayer(Ti))]+": I'm going to use RS!!!")elseif(IsPlayerInForce(r4,je))thencall DisplayTextToForce(je,pe[GetPlayerId(GetOwningPlayer(Ti))]+": I'm going to use RS!!!")endifcall GroupEnumUnitsInRange(q4,GetUnitX(Ui),GetUnitY(Ui),1690.1,y9)set I=.0
set J=.0
set K=0call ForGroup(q4,function Ri)if(K!=0)then
set I=I/(K)set J=J/(K)return IssuePointOrderById(Ti,$D0208,I,J)endifreturn false
endfunctionfunction Vi takes nothing returns nothinglocal integer i=0loop
call RemoveItem(M[i])set i=i+1exitwhen i>=Nendloopcall TimerStart(L,31.25,false,O)
endfunctionfunction Wi takes nothing returns nothinglocal integer i=0set P=P+(3.)
loop
set M[i]=CreateItem('I000',GetRandomReal(GetRectMinX(Dg),GetRectMaxX(Dg)),GetRandomReal(GetRectMinY(Dg),GetRectMaxY(Dg)))call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Demon\\DarkPortal\\DarkPortalTarget.mdl",GetItemX(M[i]),GetItemY(M[i])))
set M[i+1]=CreateItem('I000',GetRandomReal(GetRectMinX(cg),GetRectMaxX(cg)),GetRandomReal(GetRectMinY(cg),GetRectMaxY(cg)))call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Demon\\DarkPortal\\DarkPortalTarget.mdl",GetItemX(M[i+1]),GetItemY(M[i+1])))
set i=i+(2)exitwhen i>=Nendloopcall TimerStart(L,4.75,false,function Vi)endfunctionfunction Xi takes nothing returns nothingcall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffFFFF80Bounty incoming!|r")
call TimerStart(L,4.,false,function Wi)endfunctionfunction Yi takes player p returns nothinglocal integer id=GetPlayerId(p)local integer Zi=R2I((I2R(ge[id])+4.)*.25*(8.+P))set Yd[id]=Yd[id]+1call DisplayTextToPlayer(p,.0,.0,"|cffFFFF80You found |cffFFFF00"+I2S(Zi)+"|cffFFFF80 gold!|r")set Zd[id]=Zd[id]+(Zi)call AdjustPlayerStateBJ(Zi,p,PLAYER_STATE_RESOURCE_GOLD)endfunctionfunction dj takes boolean ej returns nothing
if(L==null)thenreturnendifcall PauseTimer(L)if(ej)thencall DestroyTimer(L)
set L=nullendifendfunctionfunction fj takes nothing returns nothinglocal integer i=0if(Cd<=0)thenreturnendifif(L==null)thenset L=CreateTimer()set N=Cd*2endifset P=.0
loop
set Q[i]=-1set i=i+1exitwhen i>=4endloopset Q[4]=0set Q[5]=0call TimerStart(L,40.,false,function Xi)
endfunctionfunction gj takes nothing returns nothingset L=nullset O=function Xiendfunctionfunction hj takes nothing returns booleanlocal unit u=GetFilterUnit()
local boolean b=GetWidgetLife(u)>.405 and IsUnitEnemy(u,r4)and IsUnitType(u,UNIT_TYPE_SAPPER)set u=nullreturn b
endfunctionfunction ij takes nothing returns nothinglocal integer i=0local real x
local real y
local real anlocal unit u
local unit j
loop
exitwhen i>=Wset an=GetUnitFacing(S[i])*bj_DEGTORADset x=GetUnitX(S[i])+26.*Cos(an)
set y=GetUnitY(S[i])+26.*Sin(an)
call SetUnitX(S[i],x)call SetUnitY(S[i],y)set r4=GetOwningPlayer(S[i])
call GroupEnumUnitsInRange(q4,x,y,34.,X)
set u=FirstOfGroup(q4)if(u!=null)thencall UnitDamageTarget(S[i],u,U[i],true,false,ATTACK_TYPE_MAGIC,DAMAGE_TYPE_COLD,WEAPON_TYPE_WHOKNOWS)set j=CreateUnit(GetOwningPlayer(S[i]),'e008',x,y,.0)call UnitAddAbility(j,'A043')call SetUnitAbilityLevel(j,'A043',V[i])call IssueTargetOrderById(j,$D0102,u)call UnitApplyTimedLife(j,'BTLF',1.)
set j=nullendifset T[i]=T[i]-(26.)if(T[i]<=.0 or u!=null)thenset W=W-1call KillUnit(S[i])set S[i]=S[W]set T[i]=T[W]set V[i]=V[W]set U[i]=U[W]set u=nullelse
set i=i+1endifendloopif(W<=0)then
call PauseTimer(R)endifendfunctionfunction jj takes unit u,integer kj,real mj,integer nj returns nothinglocal player p=GetOwningPlayer(u)local real an=GetUnitFacing(u)-45.local real oj=an+90.
local real x=GetUnitX(u)
local real y=GetUnitY(u)
local integer i=0loop
set S[W]=CreateUnit(p,'h068',x,y,GetRandomReal(an,oj))set T[W]=500.set U[W]=mjset V[W]=njif(W==0)then
call TimerStart(R,.03,true,function ij)endifset W=W+1set i=i+1call TriggerSleepAction(.04)
exitwhen i>=kjendloopendfunctionfunction pj takes nothing returns nothingset X=Filter(function hj)endfunctionfunction qj takes nothing returns nothingcall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Icy Environment|r has been selected. Note that a custom environment has no influence on gameplay.")set h4[0]='Ibsq'
set h4[1]='Iice'
set h4[2]='Isnw'
set h4[3]='Idki'
set h4[4]='Nsnw'
set h4[5]='Nsnr'
set h4[6]='Irbk'
set h4[7]='Nsnw'
set i4[0]='ITtw'
set j4[0]=$A
set i4[1]='ITtc'
set j4[1]=3set k4[0]='B00M'
set n4[0]=.5
set m4[0]=.0
set k4[1]='B00N'
set n4[1]=.5
set m4[1]=.0
set k4[2]='B00O'
set n4[2]=.5
set m4[2]=.0
set k4[3]='B00P'
set n4[3]=.5
set m4[3]=.0
set k4[4]='B00G'
set n4[4]=.97set m4[4]=-30.call SetTerrainFogExBJ(0,1200.,6000.,0,80.,80.,100.)
endfunctionfunction rj takes nothing returns nothingcall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Lava Environment|r has been selected. Note that a custom environment has no influence on gameplay.")
set h4[0]='Ddkr'
set h4[1]='Dgrs'
set h4[2]='Dlvc'
set h4[3]='Dlav'
set h4[4]='Drds'
set h4[5]='Ddrt'
set h4[6]='Dsqd'
set h4[7]='Dgrs'
set i4[0]='B001'
set j4[0]=8set i4[1]='B000'
set j4[1]=$A
set k4[0]='B00H'
set n4[0]=1.1set m4[0]=.0
set k4[1]='B00J'
set n4[1]=1.1set m4[1]=.0
set k4[2]='B00K'
set n4[2]=1.1set m4[2]=.0
set k4[3]='B00L'
set n4[3]=1.1set m4[3]=.0
set k4[4]='B00I'
set n4[4]=1.
set m4[4]=-70.call SetTerrainFogExBJ(0,$3E8,3000.,0,50.,.0,.0)
call SetWaterBaseColorBJ('d',.0,.0,0)endfunctionfunction sj takes nothing returns nothingcall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Icy Environment|r has been selected. Note that a custom environment has no influence on gameplay.")set h4[0]='Ibsq'
set h4[1]='Iice'
set h4[2]='Isnw'
set h4[3]='Idki'
set h4[4]='Nsnw'
set h4[5]='Nsnr'
set h4[6]='Irbk'
set h4[7]='Nsnw'
set i4[0]='ITtw'
set j4[0]=$A
set i4[1]='ITtc'
set j4[1]=3set k4[0]='B007'
set n4[0]=1.2set m4[0]=.0
set k4[1]='B008'
set n4[1]=1.2set m4[1]=.0
set k4[2]='B009'
set n4[2]=1.2set m4[2]=.0
set k4[3]='B00A'
set n4[3]=1.2set m4[3]=.0
set k4[4]='B00G'
set n4[4]=.97set m4[4]=-30.endfunctionfunction tj takes nothing returns nothingcall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Barrens Environment|r has been selected. Note that a custom environment has no influence on gameplay.")set h4[0]='Klgb'
set h4[1]='Odrt'
set h4[2]='Bdrt'
set h4[3]='Ofst'
set h4[4]='Bdrh'
set h4[5]='Bgrr'
set h4[6]='Bdsd'
set h4[7]='Bdrr'
set i4[0]='ITtw'
set j4[0]=$A
set i4[1]='ITtc'
set j4[1]=3set k4[0]='B007'
set n4[0]=1.2set m4[0]=.0
set k4[1]='B008'
set n4[1]=1.2set m4[1]=.0
set k4[2]='B009'
set n4[2]=1.2set m4[2]=.0
set k4[3]='B00A'
set n4[3]=1.2set m4[3]=.0
set k4[4]='B00G'
set n4[4]=.97set m4[4]=-30.call SetTerrainFogEx(0,1000.,8000.,.0,.686,.369,.098)call SetAmbientDaySound("BarrensDay")call SetAmbientNightSound("BarrensNight")endfunctionfunction uj takes nothing returns nothinglocal destructable vj=GetEnumDestructable()local integer i=0local real x
local real y
local real z
local location l
loop
exitwhen i>1
if GetDestructableTypeId(vj)==f4[i]thenset x=GetDestructableX(vj)set y=GetDestructableY(vj)call RemoveDestructable(vj)call CreateDestructable(i4[i],x,y,GetRandomReal(.0,360.),1,GetRandomInt(0,j4[i]-1))returnendifset i=i+1endloopset i=0loop
exitwhen i>4
if GetDestructableTypeId(vj)==g4[i]thenset x=GetDestructableX(vj)set y=GetDestructableY(vj)set l=GetDestructableLoc(vj)
set z=GetLocationZ(l)call RemoveLocation(l)set l=nullcall RemoveDestructable(vj)call CreateDestructableZ(k4[i],x,y,m4[i]+z,0,n4[i],1)returnendifset i=i+1endloopset vj=nullendfunctionfunction wj takes nothing returns nothinglocal real x=0local real y=d4*512local real zGlocal real ZGlocal integer ilocal integer jif(d4<50)thenloop
exitwhen(y>o4)set x=0loop
exitwhen(x>p4)set i=0loop
exitwhen i>3
set zG=I2R((i/ 2)*2-1)*x
set ZG=I2R(ModuloInteger(i,2)*2-1)*y
set j=0loop
exitwhen j>7
if(GetTerrainType(zG,ZG)==e4[j])then
call SetTerrainType(zG,ZG,h4[j],-1,1,0)exitwhen trueendifset j=j+1endloopset i=i+1endloopset x=x+$80endloopset y=y+$80if(ModuloReal(y,512)==0)then
set d4=d4+1call TimerStart(Y,.0,false,function wj)returnendifendloopset d4=50call TimerStart(Y,.0,false,function wj)returnelseif d4==50 thenset j=0loop
exitwhen j>6
set e4[j]=h4[j]set j=j+1endloopcall EnumDestructablesInRectAll(bj_mapInitialPlayableArea,function uj)set j=0loop
exitwhen j>1
set f4[j]=i4[j]set j=j+1endloopset j=0loop
exitwhen j>4
set g4[j]=k4[j]set j=j+1endloopcall DestroyTimer(Y)
set Y=nullendifendfunctionfunction xj takes integer yj returns nothing
if(Z)thencall DisplayTextToPlayer(Player(0),0,0,"You have already chosen an environment!")returnendifset Z=trueset Y=CreateTimer()set d4=0
set o4=GetRectMaxY(C9)set p4=GetRectMaxX(C9)set e4[0]='Vstp'
set e4[1]='Adrt'
set e4[2]='Adrg'
set e4[3]='Agrs'
set e4[4]='Agrd'
set e4[5]='Alvd'
set e4[6]='Zdtr'
set e4[7]='Avin'
set f4[0]='ATtr'
set f4[1]='ATtc'
set g4[0]='B002'
set g4[1]='B003'
set g4[2]='B004'
set g4[3]='B005'
set g4[4]='B006'
if(yj==0)thencall qj()elseif(yj==1)thencall rj()elseif(yj==2)thencall sj()elseif(yj==3)thencall tj()endifcall TimerStart(Y,.0,false,function wj)endfunctionfunction zj takes integer Aj,integer aj returns nothingset x4[GetUnitPointValueByType(Aj)]=ajendfunctionfunction Bj takes unit u,integer bj,real an,real x,real y returns nothinglocal integer Cj=GetUnitUserData(u)local real mx=GetUnitX(u)+xlocal real my=GetUnitY(u)+ylocal unit v=CreateUnit(GetOwningPlayer(u),bj,mx,my,an)call SetUnitPathing(v,false)
call SetUnitX(v,mx)call SetUnitY(v,my)call SaveUnitHandle(O9,GetHandleId(u),Cj,v)set v=nullcall SetUnitUserData(u,Cj+1)
endfunctionfunction cj takes unit u returns nothing
local integer Dj=GetUnitUserData(u)local integer Ej=GetHandleId(u)if(Dj>0)then
loop
set Dj=Dj-1call RemoveUnit(LoadUnitHandle(O9,Ej,Dj))exitwhen Dj<=0endloopendifendfunctionfunction Fj takes integer Aj,code Gj returns nothing
local integer id=GetUnitPointValueByType(Aj)
set y4[id]=CreateTrigger()call TriggerAddCondition(y4[id],Condition(Gj))endfunctionfunction Hj takes unit u returns nothing
local integer id=GetUnitPointValue(u)if(y4[id]!=null)then
set z4=u
call TriggerEvaluate(y4[id])
endifendfunctionfunction Ij takes integer Aj,real r returns nothingset A4[GetUnitPointValueByType(Aj)]=rendfunctionfunction lj takes integer Aj,code Jj returns nothing
local integer id=GetUnitPointValueByType(Aj)
set a4[id]=CreateTrigger()call TriggerAddAction(a4[id],Jj)
endfunctionfunction Kj takes unit u returns nothing
local integer id=GetUnitPointValue(u)if(a4[id]!=null)then
set B4=u
call TriggerExecute(a4[id])endifendfunctionfunction Lj takes integer Aj,integer Mj,code Gj returns nothinglocal integer id=GetUnitPointValueByType(Aj)
set b4[id]=CreateTrigger()call TriggerAddAction(b4[id],Gj)
set C4[id]=Mjendfunctionfunction Nj takes unit u,integer Mj,unit t returns nothinglocal integer id=GetUnitPointValue(u)if(b4[id]!=null and Mj==C4[id])thenset c4=u
set D4=t
call TriggerExecute(b4[id])endifendfunctionfunction Oj takes nothing returns nothinglocal integer id
set id=GetUnitPointValueByType('h008')set t4[id]=350set u4[id]=350*.09/ 100.
set v4[id]=false
endfunctionfunction Pj takes string s returns nothinglocal string Qj=I2S(G4)if(G4<$A)thenset Qj="0"+Qjendifset E4[F4]=E4[F4]+("["+I2S(H4)+":"+Qj+"] "+s+"
")if(StringLength(E4[F4])>=I4)then
set F4=F4+1endifendfunctionfunction LogClear takes nothing returns nothinglocal integer i=0loop
exitwhen not(i<=F4)set E4[i]=""
set i=i+1endloopset F4=0
endfunctionfunction Rj takes nothing returns nothinglocal integer i=0call PreloadGenClear()call PreloadGenStart()loop
exitwhen not(i<=F4)call Preload("\")
"+E4[i]+"
(\"")set i=i+1endloopcall PreloadGenEnd("Replay\\LastReplay.log")
endfunctionfunction Sj takes string Tj,string Jj,string Uj returns nothingcall Pj("DEBUG ("+Jj+" at "+Tj+"): "+Uj)
call Rj()endfunctionfunction Vj takes nothing returns nothingset G4=G4+1if(G4>59)thenset G4=0
set H4=H4+1endifendfunctionfunction Wj takes nothing returns nothingcall TimerStart(CreateTimer(),1.,true,function Vj)call Pj("Castle Fight ES game log")call Pj("Map compilation: 2012.04.15 03:35:50")call Rj()endfunctionfunction Xj takes nothing returns nothinglocal integer i=0loop
if(GetPlayerController(Player(i))==MAP_CONTROL_USER and GetPlayerSlotState(Player(i))==PLAYER_SLOT_STATE_PLAYING and(IsPlayerInForce(Player(i),ie)or IsPlayerInForce(Player(i),je)))then
set J4[i]=trueendifset i=i+1exitwhen i>$Bendloopset l4=false
endfunctionfunction Yj takes nothing returns booleanlocal integer i=0loop
if(J4[i])thenreturn false
endifset i=i+1exitwhen i>$Bendloopset l4=truereturn trueendfunctionfunction Zj takes integer dk returns nothing
if(l4)thenreturnendifif(J4[dk])thencall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,pe[dk]+" has voted for a draw!")set J4[dk]=false
if(Yj())then
call TriggerExecute(jg)endifelse
call DisplayTextToPlayer(Player(dk),.0,.0,"|cffFF0000You have already voted for a draw!|r")endifendfunctionfunction ek takes nothing returns booleanlocal unit u=GetFilterUnit()
local boolean b=GetWidgetLife(u)>.405 and IsUnitEnemy(u,r4)and IsUnitType(u,UNIT_TYPE_GROUND)and IsUnitType(u,UNIT_TYPE_SAPPER)if(b)thencall UnitDamageTarget(L4[bj_forLoopAIndex],GetEnumUnit(),N4[bj_forLoopAIndex],true,false,ATTACK_TYPE_MAGIC,DAMAGE_TYPE_FIRE,WEAPON_TYPE_WHOKNOWS)endifset u=nullreturn false
endfunctionfunction fk takes nothing returns nothinglocal real x
local real y
local real anset bj_forLoopAIndex=0set R4=not R4loop
exitwhen bj_forLoopAIndex>=Q4set an=(GetUnitFacing(L4[bj_forLoopAIndex])+O4[bj_forLoopAIndex]*GetRandomReal(.0,P4[bj_forLoopAIndex]))*bj_DEGTORAD
set x=GetUnitX(L4[bj_forLoopAIndex])+15.*Cos(an)
set y=GetUnitY(L4[bj_forLoopAIndex])+15.*Sin(an)
call SetUnitX(L4[bj_forLoopAIndex],x)call SetUnitY(L4[bj_forLoopAIndex],y)if(R4)thencall DestroyEffect(AddSpecialEffect("mdx\\sfx\\FireTrapUp.mdx",x,y))
endifset P4[bj_forLoopAIndex]=P4[bj_forLoopAIndex]-(GetRandomReal(1.,10.))if(P4[bj_forLoopAIndex]<=10.)thenset P4[bj_forLoopAIndex]=GetRandomReal(15.,85.)set O4[bj_forLoopAIndex]=IntegerTertiaryOp(GetRandomInt(0,1)==0,-1,1)endifset r4=GetOwningPlayer(L4[bj_forLoopAIndex])
call GroupEnumUnitsInRange(q4,x,y,34.,S4)set M4[bj_forLoopAIndex]=M4[bj_forLoopAIndex]-(15.)if(M4[bj_forLoopAIndex]<=0)thenset Q4=Q4-1call KillUnit(L4[bj_forLoopAIndex])set L4[bj_forLoopAIndex]=L4[Q4]set M4[bj_forLoopAIndex]=M4[Q4]set P4[bj_forLoopAIndex]=P4[Q4]set O4[bj_forLoopAIndex]=O4[Q4]set N4[bj_forLoopAIndex]=N4[Q4]else
set bj_forLoopAIndex=bj_forLoopAIndex+1endifendloopif(Q4<=0)thencall PauseTimer(K4)endifendfunctionfunction gk takes unit u,integer kj,real mj returns nothinglocal player p=GetOwningPlayer(u)local real an=GetUnitFacing(u)-45.local real oj=an+90.
local real x=GetUnitX(u)
local real y=GetUnitY(u)
local integer i=0local boolean hk=Q4==0loop
set L4[Q4]=CreateUnit(p,'h06A',x,y,GetRandomReal(an,oj))
set M4[Q4]=800.set N4[Q4]=mjset P4[Q4]=GetRandomReal(15.,80.)set O4[Q4]=0
set Q4=Q4+1set i=i+1exitwhen i>=kjendloopif(hk)thencall TimerStart(K4,.03,true,function fk)
endifendfunctionfunction ik takes nothing returns nothingset S4=Filter(function ek)endfunctionfunction jk takes integer Cj returns stringif(Cj==1)thenreturn"first"endifif(Cj==2)thenreturn"second"endifif(Cj==3)thenreturn"third"endifreturn"fourth"endfunctionfunction kk takes nothing returns nothinglocal integer mk
local player p=GetTriggerPlayer()if(not IsPlayerInForce(p,U4))thenif(T4==null)then
set T4=p
endifcall AdjustPlayerStateBJ(W4,GetTriggerPlayer(),PLAYER_STATE_RESOURCE_GOLD)call DisplayTextToPlayer(p,.0,.0,"|cffFFFF80You receive |cffFFCC00"+I2S(W4)+"|cffFFFF80 gold for being the "+jk(X4)+" player that finishes a structure!")set mk=GetPlayerId(p)set de[mk]=de[mk]+(W4)set W4=W4-(5)set X4=X4+1if(X4>4)then
call DisableTrigger(V4)else
call ForceAddPlayer(U4,p)endifendifendfunctionfunction nk takes nothing returns nothingset T4=nullcall ForceClear(U4)set W4=20set X4=1
call EnableTrigger(V4)endfunctionfunction ok takes nothing returns nothingcall TriggerAddAction(V4,function kk)call TriggerRegisterAnyUnitEventBJ(V4,EVENT_PLAYER_UNIT_CONSTRUCT_FINISH)call DisableTrigger(V4)endfunctionfunction pk takes nothing returns nothingcall DestroyEffect(AddSpecialEffect("Abilities\\Spells\\NightElf\\Barkskin\\BarkSkinTarget.mdl",.0,.0))call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Other\\HowlOfTerror\\HowlCaster.mdl",.0,.0))
call DestroyEffect(AddSpecialEffect("Units\\NightElf\\Wisp\\WispExplode.mdl",.0,.0))
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Items\\AIam\\AIamTarget.mdl",.0,.0))
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\DispelMagic\\DispelMagicTarget.mdl",.0,.0))call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Undead\\DeathCoil\\DeathCoilSpecialArt.mdl",.0,.0))call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Orc\\AncestralSpirit\\AncestralSpiritCaster.mdl",.0,.0))
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\Resurrect\\ResurrectCaster.mdl",.0,.0))call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Undead\\DeathPact\\DeathPactTarget.mdl",.0,.0))call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Undead\\ReplenishHealth\\ReplenishHealthCasterOverhead.mdl",.0,.0))call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\Naga\\NagaDeath\\NagaDeath.mdl",.0,.0))call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Orc\\FeralSpirit\\feralspiritdone.mdl",.0,.0))call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\Avatar\\AvatarCaster.mdl",.0,.0))
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Items\\TomeOfRetraining\\TomeOfRetrainingCaster.mdl",.0,.0))
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\MarkOfChaos\\MarkOfChaosTarget.mdl",.0,.0))call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\NightElf\\BattleRoar\\RoarCaster.mdl",.0,.0))call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\Polymorph\\PolyMorphTarget.mdl",.0,.0))call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\ControlMagic\\ControlMagicTarget.mdl",.0,.0))
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Items\\AIda\\AIdaCaster.mdl",.0,.0))
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\Feedback\\SpellBreakerAttack.mdl",.0,.0))
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\Avatar\\AvatarCaster.mdl",.0,.0))
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Items\\AIvi\\AIviTarget.mdl",.0,.0))
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Items\\TomeOfRetraining\\TomeOfRetrainingCaster.mdl",.0,.0))
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Demon\\DarkPortal\\DarkPortalTarget.mdl",.0,.0))
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Other\\Transmute\\PileofGold.mdl",.0,.0))call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Items\\AIil\\AIilTarget.mdl",.0,.0))
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Orc\\MirrorImage\\MirrorImageDeathCaster.mdl",.0,.0))call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\MarkOfChaos\\MarkOfChaosDone.mdl",.0,.0))
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\MassTeleport\\MassTeleportCaster.mdl",.0,.0))
call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\NightElf\\NEDeathMedium\\NEDeath.mdl",.0,.0))
call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\NightElf\\EntBirthTarget\\EntBirthTarget.mdl",.0,.0))
call DestroyEffect(AddSpecialEffect("mdx\\sfx\\sin2.mdx",.0,.0))
call DestroyEffect(AddSpecialEffect("Abilities\\Weapons\\Bolt\\BoltImpact.mdl",.0,.0))call DestroyEffect(AddSpecialEffect("mdx\\sfx\\FireTrapUp.mdx",.0,.0))call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\HolyBolt\\HolyBoltSpecialArt.mdl",.0,.0))
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Undead\\ReplenishMana\\ReplenishManaCasterOverhead.mdl",.0,.0))call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Other\\Volcano\\VolcanoDeath.mdl",.0,.0))call DestroyEffect(AddSpecialEffect("Abilities\\Weapons\\Bolt\\BoltImpact.mdl",.0,.0))call DestroyEffect(AddSpecialEffect("mdx\\sfx\\FireTrapUp.mdx",.0,.0))call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\Heal\\HealTarget.mdl",.0,.0))
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Undead\\DeathPact\\DeathPactCaster.mdl",.0,.0))call KillUnit(CreateUnit(Player($D),'e008',.0,.0,.0))call KillUnit(CreateUnit(Player($D),'h00O',.0,.0,.0))call KillUnit(CreateUnit(Player($D),'u006',.0,.0,.0))call KillUnit(CreateUnit(Player($D),'h00C',.0,.0,.0))call KillUnit(CreateUnit(Player($D),'h019',.0,.0,.0))call KillUnit(CreateUnit(Player($D),'h00E',.0,.0,.0))call KillUnit(CreateUnit(Player($D),'h017',.0,.0,.0))call KillUnit(CreateUnit(Player($D),'h089',.0,.0,.0))call KillUnit(CreateUnit(Player($D),'h00P',.0,.0,.0))call KillUnit(CreateUnit(Player($D),'h018',.0,.0,.0))call KillUnit(CreateUnit(Player($D),'h06P',.0,.0,.0))call KillUnit(CreateUnit(Player($D),'h01A',.0,.0,.0))call KillUnit(CreateUnit(Player($D),'h051',.0,.0,.0))endfunctionfunction qk takes nothing returns nothingcall pk()endfunctionfunction rk takes nothing returns booleanlocal unit u=GetFilterUnit()
local boolean b=GetWidgetLife(u)>.405 and IsUnitEnemy(u,r4)and IsUnitType(u,UNIT_TYPE_SAPPER)and u!=bj_lastLoadedUnitset u=nullreturn b
endfunctionfunction sk takes integer tk returns nothing
local real an=GetUnitFacing(Z4[tk])call SetUnitFacing(Z4[tk],an-30.)set e7[tk]=e7[tk]-1set f7[tk]=1
set d7[tk]=50.set Z4[j7]=CreateUnit(GetOwningPlayer(Z4[tk]),'h03H',GetUnitX(Z4[tk]),GetUnitY(Z4[tk]),an+30.)set d7[j7]=50.set e7[j7]=e7[tk]set f7[j7]=-1set g7[j7]=nullset h7[j7]=h7[tk]set i7[j7]=false
set j7=j7+1endfunctionfunction uk takes nothing returns nothinglocal integer i=0local real x
local real y
local real anlocal unit u
loop
exitwhen i>=j7set an=GetUnitFacing(Z4[i])*bj_DEGTORADset x=GetUnitX(Z4[i])+20.*Cos(an)set y=GetUnitY(Z4[i])+20.*Sin(an)call SetUnitX(Z4[i],x)call SetUnitY(Z4[i],y)set r4=GetOwningPlayer(Z4[i])set bj_lastLoadedUnit=g7[i]call GroupEnumUnitsInRange(q4,x,y,34.,k7)set u=FirstOfGroup(q4)if(u!=null)thencall UnitDamageTarget(Z4[i],u,h7[i],true,false,ATTACK_TYPE_MAGIC,DAMAGE_TYPE_LIGHTNING,WEAPON_TYPE_WHOKNOWS)
call DestroyEffect(AddSpecialEffect("Abilities\\Weapons\\Bolt\\BoltImpact.mdl",GetUnitX(u),GetUnitY(u)))
set g7[i]=uendifset d7[i]=d7[i]-(20.)if(d7[i]<=.0)thenif(f7[i]==0)then
if(e7[i]>0)thencall sk(i)else
set j7=j7-1call KillUnit(Z4[i])
set Z4[i]=Z4[j7]
set d7[i]=d7[j7]
set e7[i]=e7[j7]
set f7[i]=f7[j7]
set g7[i]=g7[j7]
set h7[i]=h7[j7]
set i7[i]=i7[j7]
endifelse
if(f7[i]>0 and not i7[i])thenset j7=j7-1call KillUnit(Z4[i])
set Z4[i]=Z4[j7]
set d7[i]=d7[j7]
set e7[i]=e7[j7]
set f7[i]=f7[j7]
set g7[i]=g7[j7]
set h7[i]=h7[j7]
set i7[i]=i7[j7]
else
set d7[i]=400.call SetUnitFacing(Z4[i],an*bj_RADTODEG+f7[i]*30.)set f7[i]=0endifendifelse
set i=i+1endifendloopif(j7<=0)thencall PauseTimer(Y4)endifset u=nullendfunctionfunction vk takes unit u,integer wk,integer xk,real mj returns nothinglocal player p=GetOwningPlayer(u)local real an=GetUnitFacing(u)local integer i=0local boolean hk=j7==0local real yk=(an+90.)*bj_DEGTORADlocal real zk=-50.*I2R(wk/ 2)+50.*ModuloInteger(wk+1,2)/ 2.local real x=GetUnitX(u)+30.*CosBJ(an)local real y=GetUnitY(u)+30.*SinBJ(an)local real Ak=Sin(yk)set yk=Cos(yk)loop
set Z4[j7]=CreateUnit(p,'h03H',x+zk*yk,y+zk*Ak,an)set d7[j7]=400.set e7[j7]=xkset f7[j7]=0
set g7[j7]=nullset h7[j7]=mjset i7[j7]=false
set zk=zk+(50.)set j7=j7+1set i=i+1exitwhen i>=wkendloopset i7[j7-1]=trueif(hk)thencall TimerStart(Y4,.03,true,function uk)
endifendfunctionfunction ak takes nothing returns nothingset k7=Filter(function rk)endfunctionfunction Bk takes string reason returns nothingset u7=3
endfunctionfunction MMD___time takes nothing returns realreturn TimerGetElapsed(w7)endfunctionfunction bk takes nothing returns nothinglocal integer i=0local string idloop
exitwhen i>=m7set id=SubString("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_-+= \\!@#$%^&*()/?>.<,;:'\"{}[]|`~",i,i+1)if id==StringCase(id,true)thenset id=id+"U"endifcall StoreInteger(t7,"c2i",id,i)
set i=i+1endloopendfunctionfunction Ck takes string c returns integerlocal integer ilocal string id=cif id==StringCase(id,true)thenset id=id+"U"endifset i=GetStoredInteger(t7,"c2i",id)if(i<0 or i>=m7 or SubString("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_-+= \\!@#$%^&*()/?>.<,;:'\"{}[]|`~",i,i+1)!=c)and HaveStoredInteger(t7,"c2i",id)thenset i=0loop
exitwhen i>=m7if c==SubString("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_-+= \\!@#$%^&*()/?>.<,;:'\"{}[]|`~",i,i+1)thencall Bk("c2i poisoned")call StoreInteger(t7,"c2i",id,i)
exitwhen trueendifset i=i+1endloopendifreturn i
endfunctionfunction ck takes string s,integer Dk returns integerlocal integer n=StringLength(s)local integer m=n+Dk
local integer i=0loop
exitwhen i>=nset m=m*41+Ck(SubString(s,i,i+1))set i=i+1endloopreturn m
endfunctionfunction Ek takes integer id,string Fk returns integerlocal integer oi=ni()set sh[oi]=(TimerGetElapsed(w7))+7.+GetRandomReal(0,2+.1*GetPlayerId(GetLocalPlayer()))set th[oi]=Fkset uh[oi]=ck(th[oi],id)
set vh[oi]=I2S(id)return oiendfunctionfunction Gk takes integer oi returns nothing
call FlushStoredInteger(t7,"val:"+vh[oi],th[oi])
call FlushStoredInteger(t7,"chk:"+vh[oi],vh[oi])
set th[oi]=nullset vh[oi]=nullset wh[oi]=0
endfunctionfunction Hk takes integer oi returns nothing
if oi==null then
returnelseif(rh[oi]!=-1)thenreturnendifcall Gk(oi)set rh[oi]=phset ph=oiendfunctionfunction Ik takes integer oi returns nothing
call StoreInteger(t7,"val:"+vh[oi],th[oi],uh[oi])call StoreInteger(t7,"chk:"+vh[oi],vh[oi],uh[oi])call SyncStoredInteger(t7,"val:"+vh[oi],th[oi])call SyncStoredInteger(t7,"chk:"+vh[oi],vh[oi])endfunctionfunction lk takes nothing returns booleanlocal integer i=0local integer n=0local integer rlocal integer array Jklocal boolean array Kkloop
exitwhen i>=$Cif GetPlayerController(Player(i))==MAP_CONTROL_USER and GetPlayerSlotState(Player(i))==PLAYER_SLOT_STATE_PLAYING thenif n<u7 then
set Jk[n]=iset Kk[i]=trueelse
set r=GetRandomInt(0,n)if r<u7 then
set Kk[Jk[r]]=falseset Jk[r]=iset Kk[i]=trueendifendifset n=n+1endifset i=i+1endloopreturn Kk[GetPlayerId(GetLocalPlayer())]
endfunctionfunction Lk takes string Mk returns nothinglocal integer qif not s7 thencall BJDebugMsg("MMD Emit Error: Library not initialized yet.")returnendifset q=Ek(v7,Mk)if x7==0 thenset x7=q
else
set wh[y7]=q
endifset y7=q
set v7=v7+1if lk()thencall Ik(q)endifendfunctionfunction Nk takes nothing returns nothinglocal integer qlocal integer iset q=x7
loop
exitwhen q==0 or sh[q]>=(TimerGetElapsed(w7))if not HaveStoredInteger(t7,"val:"+vh[q],th[q])thencall Bk("message skipping")call Ik(q)elseif not HaveStoredInteger(t7,"chk:"+vh[q],vh[q])thencall Bk("checksum skipping")
call Ik(q)elseif GetStoredInteger(t7,"val:"+vh[q],th[q])!=uh[q]thencall Bk("message tampering")
call Ik(q)elseif GetStoredInteger(t7,"chk:"+vh[q],vh[q])!=uh[q]thencall Bk("checksum tampering")call Ik(q)endifset x7=wh[q]
call Hk(q)set q=x7
endloopif x7==0 thenset y7=0
endifset i=0loop
exitwhen not HaveStoredInteger(t7,"chk:"+I2S(v7),I2S(v7))call Bk("message insertion")
call Lk("Blank")
set i=i+1exitwhen i>=$Aendloopendfunctionfunction Ok takes string Pk returns stringlocal integer jlocal integer i=0local string Qk=""local string cloop
exitwhen i>=StringLength(Pk)
set c=SubString(Pk,i,i+1)set j=0loop
exitwhen j>=StringLength(" \\")if c==SubString(" \\",j,j+1)then
set c="\\"+c
exitwhen trueendifset j=j+1endloopset Qk=Qk+cset i=i+1endloopreturn Qkendfunctionfunction Rk takes string Sk,player p,string op,string Pk,integer Tk returns nothinglocal integer id=GetPlayerId(p)if p==null or id<0 or id>=$C thencall BJDebugMsg("MMD Set Error: Invalid player. Must be P1 to P12.")
elseif Tk!=GetStoredInteger(t7,"types",Sk)thencall BJDebugMsg("MMD Set Error: Updated value of undefined variable or used value of incorrect type.")elseif StringLength(op)==0 thencall BJDebugMsg("MMD Set Error: Unrecognized operation type.")elseif StringLength(Sk)>50 thencall BJDebugMsg("MMD Set Error: Variable name is too long.")
elseif StringLength(Sk)==0 thencall BJDebugMsg("MMD Set Error: Variable name is empty.")else
call Lk("VarP "+I2S(id)+" "+Ok(Sk)+" "+op+" "+Pk)endifendfunctionfunction dm takes player p,integer em returns nothinglocal string fm=n7[em]local integer id=GetPlayerId(p)if p==null or id<0 or id>=$C thencall BJDebugMsg("MMD Flag Error: Invalid player. Must be P1 to P12.")elseif StringLength(fm)==0 thencall BJDebugMsg("MMD Flag Error: Unrecognized flag type.")elseif GetPlayerController(Player(id))==MAP_CONTROL_USER thencall Lk("FlagP "+I2S(id)+" "+fm)
endifendfunctionfunction gm takes string Sk,integer hm,integer im,integer jm returns nothing
local string km=o7[im]local string mm=q7[hm]local string nm=r7[jm]if km==null then
call BJDebugMsg("MMD Def Error: Unrecognized goal type.")elseif mm==null then
call BJDebugMsg("MMD Def Error: Unrecognized value type.")elseif nm==null then
call BJDebugMsg("Stats Def Error: Unrecognized suggestion type.")elseif StringLength(Sk)>32 thencall BJDebugMsg("MMD Def Error: Variable name is too long.")
elseif StringLength(Sk)==0 thencall BJDebugMsg("MMD Def Error: Variable name is empty.")elseif hm=='e' and im!='e' thencall BJDebugMsg("MMD Def Error: Strings must have goal type of none.")elseif GetStoredInteger(t7,"types",Sk)!=0 thencall BJDebugMsg("MMD Def Error: Value redefined.")else
call StoreInteger(t7,"types",Sk,hm)call Lk("DefVarP "+Ok(Sk)+" "+mm+" "+km+" "+nm)endifendfunctionfunction om takes nothing returns nothinglocal integer ilocal trigger tset s7=truecall Lk("init version "+I2S(1)+" "+I2S(1))set i=0loop
exitwhen i>=$Cif GetPlayerController(Player(i))==MAP_CONTROL_USER and GetPlayerSlotState(Player(i))==PLAYER_SLOT_STATE_PLAYING thencall Lk("init pid "+I2S(i)+" "+Ok(GetPlayerName(Player(i))))
endifset i=i+1endloopset t=CreateTrigger()call TriggerAddAction(t,function Nk)
call TriggerRegisterTimerEvent(t,.37,true)call gm("RoundsWon",'g','e','e')
call gm("RoundsLost",'g','e','e')call gm("Wins",'g','e','e')call gm("Loses",'g','e','e')
endfunctionfunction pm takes nothing returns nothinglocal trigger t=CreateTrigger()call TriggerRegisterTimerEvent(t,0,false)call TriggerAddAction(t,function om)
set o7['e']="none"set o7['f']="high"set o7['g']="low"set q7['g']="int"set q7['f']="real"set q7['e']="string"
set r7['e']="none"set r7['f']="track"set r7['g']="leaderboard"set p7['e']="+="
set p7['f']="-="
set p7['g']="="set n7['e']="drawer"
set n7['f']="loser"set n7['g']="winner"
set n7['h']="leaver"
set n7['i']="practicing"
call FlushGameCache(InitGameCache("MMD.Dat"))set t7=InitGameCache("MMD.Dat")call TimerStart(w7,$3B9AC9FF,false,null)
call bk()endfunctionfunction qm takes nothing returns nothinglocal integer i=0loop
if(B7[i]==null)thenset B7[i]=CreateUnit(z7,'h06B',IntegerTertiaryOp(i<$A,-1,1)*GetRandomReal(2048.,X7),IntegerTertiaryOp(ModuloInteger(i,$A)<5,-1,1)*(Z7-128.),270.)call SetUnitFlyHeight(B7[i],30.,85.)
call IssueTargetOrderById(B7[i],$D0003,a7[i])set i=(i/ 5+1)*5
endifset i=i+1exitwhen i>=20endloopendfunctionfunction rm takes integer sm returns unitlocal integer i=sm*5
local integer j=(sm+1)*5
local unit u
loop
if(B7[i]!=null)thenset u=B7[i]set B7[i]=nullreturn u
endifset i=i+1exitwhen i>=20endloopreturn nullendfunctionfunction NatureWispControl_StartCalling takes nothing returns nothingcall TimerStart(A7,4.,true,function qm)endfunctionfunction tm takes nothing returns nothinglocal integer i=0call PauseTimer(A7)loop
if(B7[i]!=null)thencall RemoveUnit(B7[i])set B7[i]=nullendifset i=i+1exitwhen i>=20endloopendfunctionfunction um takes nothing returns nothinglocal destructable d=GetEnumDestructable()local integer id=GetDestructableTypeId(d)if(bj_forLoopAIndex<bj_forLoopAIndexEnd and(id=='ATtc' or id=='ATtr' or id=='B001' or id=='B000' or id=='ITtw' or id=='ITtc'))thencall SetDestructableInvulnerable(d,true)
set a7[bj_forLoopAIndex]=dset bj_forLoopAIndex=bj_forLoopAIndex+1endifset d=nullendfunctionfunction vm takes nothing returns nothinglocal rect r
if(b7)thenreturnendifset b7=trueset r=Rect(-2048.,.0,-X7,-Z7)set bj_forLoopAIndex=0set bj_forLoopAIndexEnd=bj_forLoopAIndex+5call EnumDestructablesInRect(r,null,function um)
call RemoveRect(r)set r=Rect(-2048.,.0,-X7,Z7)
set bj_forLoopAIndexEnd=bj_forLoopAIndex+5call EnumDestructablesInRect(r,null,function um)
call RemoveRect(r)set r=Rect(2048.,.0,X7,-Z7)set bj_forLoopAIndexEnd=bj_forLoopAIndex+5call EnumDestructablesInRect(r,null,function um)
call RemoveRect(r)set r=Rect(2048.,.0,X7,Z7)set bj_forLoopAIndexEnd=bj_forLoopAIndex+5call EnumDestructablesInRect(r,null,function um)
call RemoveRect(r)set r=nullendfunctionfunction wm takes nothing returns nothingcall TimerStart(CreateTimer(),.0,true,function wm)endfunctionfunction xm takes nothing returns nothinglocal trigger t=CreateTrigger()call DestroyTimer(GetExpiredTimer())
if(GetHandleId(t)!=$10022B)thencall TimerStart(CreateTimer(),.0,true,function wm)else
call DestroyTrigger(t)set t=nullendifendfunctionfunction ym takes nothing returns nothingcall TimerStart(CreateTimer(),.15,false,function xm)
endfunctionfunction zm takes integer aj returns stringlocal integer i=0loop
exitwhen E7[i]==aj or i>=l7set i=i+1endloopif(i>=l7)thenreturn"Unregistred Race"
endifreturn F7[i]
endfunctionfunction Am takes integer am returns nothing
local integer i=0loop
call SetPlayerAbilityAvailable(Player(i),G7[am],I7[me[i]*l7+am]and am>K7[i]*9 and am<(K7[i]+1)*9)set i=i+1exitwhen i>=$Cendloopendfunctionfunction Bm takes integer bm,boolean fl returns nothinglocal integer i=0loop
exitwhen E7[i]==bm or i>=l7set i=i+1endloopif(i>=l7)thenreturnendifset I7[i]=fl
set I7[l7+i]=flcall Am(i)endfunctionfunction Cm takes integer bm,boolean fl,integer cm returns nothinglocal integer i=0loop
exitwhen E7[i]==bm or i>=l7set i=i+1endloopif(i>=l7)thenreturnendifset I7[l7*cm+i]=flcall Am(i)endfunctionfunction Dm takes unit u returns nothing
local integer i=0local player p=GetOwningPlayer(u)loop
call UnitAddAbility(u,G7[i])
set i=i+1exitwhen i>=l7endloopcall UnitAddAbility(u,'A0DP')call UnitAddAbility(u,'A0DQ')call UnitAddAbility(u,'A0DR')call SelectUnitForPlayerSingle(u,p)call PanCameraToForPlayer(p,GetUnitX(u),GetUnitY(u))
endfunctionfunction Em takes unit u returns unitcall Dm(u)return u
endfunctionfunction Fm takes unit u,real Gm returns integer
local integer dk=GetPlayerId(GetOwningPlayer(u))
local timer Hm=CreateTimer()
local integer Im=0call Dm(u)call TimerStart(Hm,Gm,false,null)loop
call TriggerSleepAction(.33)
exitwhen D7[dk]!=0 or TimerGetRemaining(Hm)<.33endloopcall PauseTimer(Hm)call DestroyTimer(Hm)set Hm=nullcall RemoveUnit(u)if(D7[dk]==0)thenreturn-1
endifset Im=D7[dk]set D7[dk]=0
return Imendfunctionfunction lm takes integer dk returns nothing
local integer i=0local integer Jm=K7[dk]*9local integer to=(K7[dk]+1)*9local integer zk=me[dk]*l7local player p=Player(dk)loop
call SetPlayerAbilityAvailable(p,G7[i],I7[zk+i]and i>=Jm and i<to)set i=i+1exitwhen i>=l7endloopcall SetPlayerAbilityAvailable(p,'A0DP',to<l7)call SetPlayerAbilityAvailable(p,'A0DQ',Jm>0)endfunctionfunction RaceSelector_Finally takes nothing returns nothingcall DisableTrigger(J7)endfunctionfunction Km takes nothing returns nothinglocal integer i=0loop
set K7[i]=0set D7[i]=0call lm(i)set i=i+1exitwhen i>=$Cendloopset C7=nullendfunctionfunction Lm takes nothing returns nothinglocal integer i=0loop
set I7[i]=trueset i=i+1exitwhen i>=l7*2
endloopcall Km()call EnableTrigger(J7)endfunctionfunction Mm takes nothing returns booleanlocal unit u=GetTriggerUnit()local integer dk=GetPlayerId(GetOwningPlayer(u))
local integer Nm=GetSpellAbilityId()
local integer i=0if(Nm=='A0DP')thenset K7[dk]=K7[dk]+1call lm(dk)set u=nullreturn false
elseif(Nm=='A0DQ')thenset K7[dk]=K7[dk]-1call lm(dk)set u=nullreturn false
elseif(Nm=='A0DR')thenset D7[dk]=-1if(C7!=null)then
set c7=dkcall TriggerEvaluate(C7)
endifcall RemoveUnit(u)set u=nullreturn false
endifloop
exitwhen G7[i]==Nm or i>=l7set i=i+1endloopcall RemoveUnit(u)set u=nullif(i>=l7)thenreturn false
endifset D7[dk]=E7[i]
if(GetLocalPlayer()==Player(dk))then
call StartSound(H7[i])endifif(C7!=null)then
set c7=dkcall TriggerEvaluate(C7)
endifreturn false
endfunctionfunction Om takes integer a,integer b returns nothinglocal integer i=0loop
if(I7[i])thencall Gi(a,E7[i])
endifif(I7[l7+i])then
call Gi(b,E7[i])
endifset i=i+1exitwhen i>=l7endloopendfunctionfunction Pm takes nothing returns nothingset F7[l7]="Chaos Legions"set E7[l7]='h00O'set G7[l7]='A0DD'set H7[l7]=CreateSound("Units\\Demon\\HeroPitLord\\HPitLordYesAttack2.wav",false,false,false,$A,$A,"DefaultEAXON")set l7=l7+1set F7[l7]="Elven Union"
set E7[l7]='h00P'set G7[l7]='A0DE'set H7[l7]=CreateSound("Units\\Critters\\BloodElfPeasant\\BloodElfEngineerWarcry1.wav",false,false,false,$A,$A,"DefaultEAXON")set l7=l7+1set F7[l7]="Corrupted Conglomerate"set E7[l7]='u006'set G7[l7]='A0DF'set H7[l7]=CreateSound("Units\\Demon\\Pitlord\\PitLordYesAttack1.wav",false,false,false,$A,$A,"DefaultEAXON")set l7=l7+1set F7[l7]="Human Alliance"set E7[l7]='h00C'set G7[l7]='A0DG'set H7[l7]=CreateSound("Units\\Human\\Peasant\\PeasantReady1.wav",false,false,false,$A,$A,"DefaultEAXON")set l7=l7+1set F7[l7]="Orcish Horde"set E7[l7]='h019'set G7[l7]='A0DH'set H7[l7]=CreateSound("Units\\Orc\\Peon\\PeonReady1.wav",false,false,false,$A,$A,"DefaultEAXON")set l7=l7+1set F7[l7]="Naga Faction"set E7[l7]='h00E'set G7[l7]='A0DI'set H7[l7]=CreateSound("Units\\Creeps\\Murloc\\MurlocPissed2.wav",false,false,false,$A,$A,"DefaultEAXON")set l7=l7+1set F7[l7]="Northern Realms"
set E7[l7]='h017'set G7[l7]='A0DJ'set H7[l7]=CreateSound("Units\\Creeps\\Bandit\\BanditWhat1.wav",false,false,false,$A,$A,"DefaultEAXON")set l7=l7+1set F7[l7]="Night Elfs"set E7[l7]='h089'set G7[l7]='A0DK'set H7[l7]=CreateSound("Units\\NightElf\\Runner\\RunnerWarcry1.wav",false,false,false,$A,$A,"DefaultEAXON")set l7=l7+1set F7[l7]="Undead Forces"set E7[l7]='h018'set G7[l7]='A0DL'set H7[l7]=CreateSound("Units\\Undead\\Acolyte\\AcolyteWarcry1.wav",false,false,false,$A,$A,"HeroAcksEAX")set l7=l7+1set F7[l7]="Mech Coalition"set E7[l7]='h06P'set G7[l7]='A0DM'set H7[l7]=CreateSound("Units\\Creeps\\HeroTinker\\HeroTinkerReady1.wav",false,false,false,$A,$A,"HeroAcksEAX")set l7=l7+1set F7[l7]="Nature Force"set E7[l7]='h01A'set G7[l7]='A0DN'set H7[l7]=CreateSound("Units\\NightElf\\Ent\\EntReady1.wav",false,false,false,$A,$A,"DefaultEAXON")
set l7=l7+1set F7[l7]="Elementals' Universe"set E7[l7]='h051'set G7[l7]='A0DO'set H7[l7]=CreateSound("Units\\NightElf\\Wisp\\WispPissed3.wav",false,false,false,$A,$A,"DefaultEAXON")set l7=l7+1call DisableTrigger(J7)call TriggerAddCondition(J7,Condition(function Mm))call TriggerRegisterAnyUnitEventBJ(J7,EVENT_PLAYER_UNIT_SPELL_CAST)endfunctionfunction Qm takes nothing returns nothingcall PlaySoundBJ(Hg)
if(cd>0 and T4!=null)thenif(IsPlayerInForce(T4,ie))thencall TriggerExecute(ig)else
call TriggerExecute(hg)endifreturnendifcall TriggerExecute(jg)endfunctionfunction Rm takes nothing returns nothingcall DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,10.,"1 minute before round ends!")
call TimerStart(L7,60.,false,function Qm)call PlaySoundBJ(Hg)
endfunctionfunction Sm takes nothing returns nothingcall DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,10.,"3 minutes before round ends!")call TimerStart(L7,120.,false,function Rm)call PlaySoundBJ(Hg)
endfunctionfunction Tm takes nothing returns nothingcall DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,10.,"Warnning! 5 minutes before round ends!")call TimerStart(L7,120.,false,function Sm)call PlaySoundBJ(Hg)
endfunctionfunction Um takes nothing returns nothingif(L7!=null)then
call PauseTimer(L7)endifif(cd!=0)thenif(L7==null)then
set L7=CreateTimer()
endifcall TimerStart(L7,(IAbsBJ(cd)-5)*60.,false,function Tm)
endifendfunctionfunction Vm takes nothing returns nothinglocal integer id=LoadInteger(O9,GetHandleId(GetExpiredTimer()),30)set Q7[id]=Q7[id]-1if(Q7[id]<0)then
if(GetLocalPlayer()==Player(id))then
call StartSound(Ug)endifset Q7[id]=3
call TimerDialogSetTitle(O7[id],R7[3])call TimerStart(M7[id],P7[id],false,function Vm)
call TimerStart(N7[id],P7[id]+3,false,null)returnendifif(GetLocalPlayer()==Player(id))then
call StartSound(Tg)endifcall TimerDialogSetTitle(O7[id],R7[Q7[id]])call TimerStart(M7[id],1.,false,function Vm)
endfunctionfunction Wm takes integer p,real Gm returns nothingif(M7[p]==null)thenset M7[p]=CreateTimer()set N7[p]=CreateTimer()set O7[p]=CreateTimerDialog(N7[p])call SaveInteger(O9,GetHandleId(M7[p]),30,p)
endifcall TimerDialogDisplay(O7[p],GetLocalPlayer()==Player(p))set P7[p]=Gm-3set Q7[p]=3call TimerDialogSetTitle(O7[p],R7[3])call TimerStart(M7[p],P7[p],false,function Vm)call TimerStart(N7[p],P7[p]+3,false,null)endfunctionfunction Xm takes integer p returns booleanif(P7[p]<=.0)thenreturn false
endifcall PauseTimer(M7[p])set P7[p]=.0
call PauseTimer(N7[p])call TimerDialogDisplay(O7[p],false)
return trueendfunctionfunction Ym takes boolean fm returns nothing
local integer i=0if(fm)thenloop
if(P7[i]>.0)then
call TimerDialogSetTitle(O7[i],R7[3])call TimerStart(M7[i],P7[i],false,function Vm)call TimerStart(N7[i],P7[i]+3,false,null)endifset i=i+1exitwhen i>$Bendloopreturnendifloop
if(P7[i]>.0)then
call PauseTimer(M7[i])call PauseTimer(N7[i])endifset i=i+1exitwhen i>$Bendloopendfunctionfunction Zm takes nothing returns nothingset R7[0]="!!!"set R7[1]=".!!"set R7[2]="..!"set R7[3]="..."endfunctionfunction dn takes boolean en returns locationlocal integer i=0if(not en)thenset i=6endifloop
if(not T7[i])thenset T7[i]=truereturn S7[i]
endifset i=i+1exitwhen i>$Bendloopcall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"GENERAL FAILURE AT MODULE 'SP:GMR'. PLEASE REPORT ABOUT THIS BUG!")return Location(.0,.0)endfunctionfunction fn takes location gn returns nothinglocal integer i=0loop
if(gn==S7[i])thenset T7[i]=falsereturnendifset i=i+1exitwhen i>$Bendloopendfunctionfunction hn takes nothing returns nothinglocal integer i=0loop
set S7[i]=GetPlayerStartLocationLoc(Player(i))set i=i+1exitwhen i>$Bendloopendfunctionfunction in takes nothing returns nothinglocal destructable d=GetTriggerDestructable()local timer t=CreateTimer()call TimerStart(t,30.,false,null)loop
call TriggerSleepAction(1.)exitwhen TimerGetRemaining(t)<.5
endloopcall PauseTimer(t)call DestroyTimer(t)
set t=nullcall DestructableRestoreLife(d,GetDestructableMaxLife(d),true)set d=nullendfunctionfunction jn takes nothing returns nothingcall TriggerRegisterDeathEvent(U7,GetEnumDestructable())
endfunctionfunction kn takes nothing returns booleanlocal destructable d=GetFilterDestructable()
local integer t=GetDestructableTypeId(d)
local boolean Im=t=='ATtc' or t=='ATtr' or t=='B001' or t=='B000' or t=='ITtw' or t=='ITtc'set d=nullreturn Imendfunctionfunction mn takes nothing returns nothinglocal boolexpr f
if(V7)thenreturnendifset V7=trueset f=Filter(function kn)call EnumDestructablesInRect(bj_mapInitialPlayableArea,f,function jn)call DestroyBoolExpr(f)set f=nullcall TriggerAddAction(U7,function in)endfunctionfunction nn takes nothing returns integerlocal integer u=Ii()
set Gh[u]=0return u
endfunctionfunction on takes integer oi,integer Hi returns nothinglocal integer i=0loop
exitwhen Eh[Fh[oi]+i]==Hi or i>=Gh[oi]set i=i+1endloopif(i>=Gh[oi])thenreturnendifset Gh[oi]=Gh[oi]-1set Eh[Fh[oi]+i]=Eh[Fh[oi]+Gh[oi]]endfunctionfunction pn takes integer oi returns integer
return Eh[Fh[oi]+GetRandomInt(0,Gh[oi]-1)]endfunctionfunction qn takes nothing returns nothingset d8[e8]=GetEnumUnit()
set e8=e8+1endfunctionfunction rn takes group g returns unitset e8=0
call ForGroup(g,function qn)
if(e8<=0)thenreturn nullendifreturn d8[GetRandomInt(0,e8-1)]endfunctionfunction sn takes integer x,integer y returns integerlocal integer rif(x==0 or y==0)then
return x+yendifset r=x-y*(x/ y)
loop
exitwhen r==0set x=yset y=rset r=x-y*(x/ y)
endloopreturn y
endfunctionfunction tn takes integer x,integer y returns integerreturn(x*y)/ sn(x,y)
endfunctionfunction un takes player p,string s returns nothingif(GetLocalPlayer()==p)thencall ClearTextMessages()
call DisplayTimedTextToPlayer(p,.52,-1.,2.,"|cffffcc00"+s+"|r")call StopSound(g8,false,false)call StartSound(g8)endifendfunctionfunction vn takes force f returns player
local integer i=0loop
if(IsPlayerInForce(Player(i),f))then
return Player(i)
endifset i=i+1exitwhen i>$Bendloopreturn nullendfunctionfunction wn takes force f1,force f2 returns nothinglocal integer i=0local player ploop
set p=Player(i)if(IsPlayerInForce(p,f2)and IsPlayerInForce(p,f1))thencall ForceRemovePlayer(f1,p)
endifset i=i+1exitwhen i>$Bendloopendfunctionfunction xn takes nothing returns integerlocal integer i=0local integer j=0loop
if(IsPlayerInForce(Player(i),ie)and D9[i]!=null)then
set j=j+1endifset i=i+1exitwhen i>$Bendloopreturn j
endfunctionfunction yn takes nothing returns integerlocal integer i=0local integer j=0loop
if(IsPlayerInForce(Player(i),je)and D9[i]!=null)then
set j=j+1endifset i=i+1exitwhen i>$Bendloopreturn j
endfunctionfunction zn takes boolean en returns playerlocal integer i=0set h8=trueif(not en)thenset i=7endifloop
exitwhen IsPlayerInForce(Player(i),ke)or i>$Bset i=i+1endloopif(i>$B)then
if(en)thenreturn nullendifset i=0loop
exitwhen IsPlayerInForce(Player(i),ke)or i>6
set i=i+1endloopif(i>6)thenreturn nullendifendifreturn Player(i)
endfunctionfunction An takes nothing returns nothinglocal integer i=0local integer jloop
set j=0loop
if(me[i]==me[j])then
if(ne[j]!=null and IsPlayerInForce(Player(i),ne[j]))then
call SetPlayerAllianceStateBJ(Player(i),Player(j),5)
else
call SetPlayerAllianceStateBJ(Player(i),Player(j),3)
endifelse
call SetPlayerAllianceStateBJ(Player(i),Player(j),0)
endifset j=j+1exitwhen j>$Bendloopset i=i+1exitwhen i>$Bendloopendfunctionfunction Bn takes nothing returns nothingcall An()set h8=false
endfunctionfunction bn takes nothing returns nothingset W7=GetRectMinX(bj_mapInitialPlayableArea)set X7=GetRectMaxX(bj_mapInitialPlayableArea)set Y7=GetRectMinY(bj_mapInitialPlayableArea)set Z7=GetRectMaxY(bj_mapInitialPlayableArea)endfunctionfunction Cn takes nothing returns nothinglocal unit u=GetTriggerUnit()local integer p=GetPlayerId(GetOwningPlayer(u))if((not IsUnitType(u,UNIT_TYPE_FLYING))and p<$C and GetUnitPointValue(u)!=$81 and p8!=me[p])then
if(p8!=-1)thenif(v8[p8]==w8)thencall DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,8.,Od[p8]+"|cffFFFF00 are no longer dominating!|r")set i8[p8]=1.endifset v8[p8]=v8[p8]-1endifset p8=me[p]
set v8[p8]=v8[p8]+1call SetUnitColor(t8,j8[p8])
if(v8[p8]==w8)thenset i8[p8]=1.+.15call DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,8.,Od[p8]+"|cffFFFF00 are dominating, they gain +"+I2S(R2I(.15*'d'))+"% income!|r")endifendifset u=nullendfunctionfunction cn takes nothing returns nothinglocal unit u=GetTriggerUnit()local integer p=GetPlayerId(GetOwningPlayer(u))if((not IsUnitType(u,UNIT_TYPE_FLYING))and p<$C and GetUnitPointValue(u)!=$81 and q8!=me[p])then
if(q8!=-1)thenif(v8[q8]==w8)thencall DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,8.,Od[q8]+"|cffFFFF00 are no longer dominating!|r")set i8[q8]=1.endifset v8[q8]=v8[q8]-1endifset q8=me[p]
set v8[q8]=v8[q8]+1call SetUnitColor(u8,j8[q8])
if(v8[q8]==w8)thenset i8[q8]=1.+.15call DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,8.,Od[q8]+"|cffFFFF00 are dominating, they gain +"+I2S(R2I(.15*'d'))+"% income!|r")endifendifset u=nullendfunctionfunction Dn takes nothing returns nothinglocal rect Enif(not m8)thenset En=Rect(-160.,448.,160.,1216.)set n8=CreateRegion()call RegionAddRect(n8,En)call RemoveRect(En)set En=Rect(-160.,-1216.,160.,-448.)
set o8=CreateRegion()call RegionAddRect(o8,En)call RemoveRect(En)set En=nullset r8=CreateTrigger()set s8=CreateTrigger()call TriggerAddAction(r8,function Cn)call TriggerAddAction(s8,function cn)call TriggerRegisterEnterRegion(r8,n8,null)call TriggerRegisterEnterRegion(s8,o8,null)set j8[0]=PLAYER_COLOR_REDset j8[1]=PLAYER_COLOR_GREEN
set t8=CreateUnit(Player($F),'ncp2',.0,832.,.0)set u8=CreateUnit(Player($F),'ncp2',.0,-832.,.0)
set m8=trueendifif(ed==0)thenset w8=2
else
set w8=1
if(ed==1)thencall ShowUnit(u8,false)call DisableTrigger(s8)else
call ShowUnit(t8,false)call DisableTrigger(r8)endifendifcall SetUnitColor(t8,k8)
call SetUnitColor(u8,k8)
set v8[0]=0set v8[1]=0set p8=-1set q8=-1set i8[0]=1.
set i8[1]=1.
endfunctionfunction Fn takes integer dk returns integer
local integer i=6*dk+1local integer j=6*(dk+1)
local integer c=0loop
set c=c+(A8[i])set i=i+1exitwhen i>=jendloopreturn c
endfunctionfunction Gn takes unit u returns nothing
local integer dk=GetPlayerId(GetOwningPlayer(u))
local integer Hn=a8[GetUnitPointValue(u)]set A8[dk*6+Hn]=A8[dk*6+Hn]+1endfunctionfunction In takes unit u returns nothing
local integer dk=GetPlayerId(GetOwningPlayer(u))
local integer Hn=a8[GetUnitPointValue(u)]set A8[dk*6+Hn]=A8[dk*6+Hn]-1endfunctionfunction ln takes nothing returns nothinglocal integer dk=GetPlayerId(GetOwningPlayer(c4))local integer i=GetRandomInt(0,98)if(i<33)then
call SetUnitAnimation(c4,"spell slam")call vk(c4,2+A8[dk*6+3]/ 3,2+A8[dk*6+5]/ 2,75.*IMinBJ(1+A8[dk*6+1],4))elseif(i<66)then
call jj(c4,5+A8[dk*6+4]*2,75.*IMinBJ(1+A8[dk*6+2],4),IMaxBJ(IMinBJ(A8[dk*6+5]/ 4,3),1))else
call SetUnitAnimation(c4,"spell throw")call gk(c4,IMaxBJ(IMinBJ(A8[dk*6+1]/ 2,8),2),75.*IMinBJ(1+A8[dk*6+3],4))
endifendfunctionfunction Jn takes unit c,unit t returns nothinglocal lightning Knlocal real Ln=.0
call UnitRemoveAbility(c,'A0EK')
if(GetUnitAbilityLevel(t,'A0EL')>0)thencall UnitAddAbility(c,'A0EK')call un(GetOwningPlayer(c),"Target is improved already.")returnendifif(GetUnitState(t,UNIT_STATE_MAX_MANA)<1. or(x4[GetUnitPointValue((t))])>0)thencall UnitAddAbility(c,'A0EK')call un(GetOwningPlayer(c),"Target haven't mana or it's not special building.")returnendifcall UnitAddAbility(t,'A0EL')call UnitMakeAbilityPermanent(t,true,'A0EL')
if(GetUnitAbilityLevel(t,'A0DS')>0)thencall SetUnitAbilityLevel(t,'A0EL',2)
endifcall SaveUnitHandle(O9,GetHandleId(t),26,c)set Kn=AddLightning("DRAM",true,GetUnitX(t),GetUnitY(t),GetUnitX(c),GetUnitY(c))
if(IsUnitAlly(c,GetLocalPlayer()))thenset Ln=1.endifcall SetLightningColor(Kn,1.,1.,1.,Ln)call SaveLightningHandle(O9,GetHandleId(t),25,Kn)set Kn=nullendfunctionfunction Mn takes unit u returns nothing
call UnitAddAbility(LoadUnitHandle(O9,GetHandleId(u),26),'A0EK')
call DestroyLightning(LoadLightningHandle(O9,GetHandleId(u),25))
endfunctionfunction Nn takes nothing returns nothinglocal unit c
local integer i=GetRandomInt(0,2)set r4=GetOwningPlayer(B4)call GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,y9)set bj_groupRandomCurrentPick=rn(q4)
if(bj_groupRandomCurrentPick==null)thenreturnendifset c=CreateUnit(r4,'e008',GetUnitX(bj_groupRandomCurrentPick),GetUnitY(bj_groupRandomCurrentPick),.0)if(i==0)then
call UnitAddAbility(c,x8)call IssuePointOrderById(c,$D0079,GetUnitX(bj_groupRandomCurrentPick),GetUnitY(bj_groupRandomCurrentPick))elseif(i==1)then
call UnitAddAbility(c,y8)call IssuePointOrderById(c,$D010E,GetUnitX(bj_groupRandomCurrentPick),GetUnitY(bj_groupRandomCurrentPick))else
call UnitAddAbility(c,z8)call IssuePointOrderById(c,$D026F,GetUnitX(bj_groupRandomCurrentPick),GetUnitY(bj_groupRandomCurrentPick))endifcall UnitApplyTimedLife(c,'BTLF',10.)set c=nullendfunctionfunction On takes nothing returns booleanlocal unit u=GetFilterUnit()
local boolean Im=GetWidgetLife(u)>.405 and IsUnitAlly(u,r4)and IsUnitType(u,UNIT_TYPE_SAPPER)and(b8 or GetUnitAbilityLevel(u,'A0F4')<=0)
set u=nullreturn Imendfunctionfunction Pn takes nothing returns nothinglocal real r
local integer i=0set r4=GetOwningPlayer(B4)set b8=false
call GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,B8)set bj_groupRandomCurrentPick=rn(q4)
if(bj_groupRandomCurrentPick==null)thenset b8=truecall GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,B8)set bj_groupRandomCurrentPick=rn(q4)
if(bj_groupRandomCurrentPick==null)thenreturnendifendifcall DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\HolyBolt\\HolyBoltSpecialArt.mdl",bj_groupRandomCurrentPick,"overhead"))call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Undead\\ReplenishMana\\ReplenishManaCasterOverhead.mdl",GetUnitX(B4),GetUnitY(B4)))set r=GetWidgetLife(bj_groupRandomCurrentPick)if(GetUnitState(bj_groupRandomCurrentPick,UNIT_STATE_MAX_LIFE)-r>350.)thencall SetWidgetLife(bj_groupRandomCurrentPick,r+450.)
else
set C8[0]='A0D7'
set C8[1]='A0F3'
set C8[2]='A0F1'
set c8=3
loop
exitwhen i>=c8if(GetUnitAbilityLevel(bj_groupRandomCurrentPick,C8[i])>0)thenset c8=c8-1set C8[i]=C8[c8]
else
set i=i+1endifendloopif(c8<=0)thencall SetWidgetLife(bj_groupRandomCurrentPick,r+450.)
else
set i=GetRandomInt(0,c8-1)call UnitAddAbility(bj_groupRandomCurrentPick,C8[i])
if(i==2)then
call UnitAddAbility(bj_groupRandomCurrentPick,'A03Q')endifcall UnitAddAbility(bj_groupRandomCurrentPick,'A0F4')endifendifendfunctionfunction Qn takes nothing returns booleancall Bj(z4,'h050',270.,.0,28.)call Bj(z4,'h050',90.,.0,-28.)return false
endfunctionfunction Rn takes nothing returns booleancall Bj(z4,'h04Y',270.,.0,28.)call Bj(z4,'h050',90.,.0,-28.)return false
endfunctionfunction Sn takes nothing returns booleancall Bj(z4,'h04Y',270.,.0,28.)call Bj(z4,'h04Y',90.,.0,-28.)return false
endfunctionfunction Tn takes nothing returns booleancall Bj(z4,'h04Y',270.,.0,28.)call Bj(z4,'h050',90.,.0,-28.)return false
endfunctionfunction Un takes nothing returns booleancall Bj(z4,'h04Y',270.,.0,28.)call Bj(z4,'h04Y',90.,.0,-28.)call Bj(z4,'h058',270.,.0,.0)return false
endfunctionfunction Vn takes nothing returns booleancall Bj(z4,'h04Y',270.,.0,28.)call Bj(z4,'h050',90.,.0,-28.)call Bj(z4,'h052',270.,.0,.0)return false
endfunctionfunction Wn takes nothing returns booleancall Bj(z4,'h04Y',270.,.0,28.)call Bj(z4,'h04Y',90.,.0,-28.)call Bj(z4,'h053',270.,.0,.0)return false
endfunctionfunction Xn takes nothing returns booleancall Bj(z4,'h04Y',270.,.0,28.)call Bj(z4,'h050',90.,.0,-28.)call Bj(z4,'h05O',270.,.0,.0)return false
endfunctionfunction Yn takes nothing returns booleancall Bj(z4,'h04Y',270.,.0,28.)call Bj(z4,'h04Y',90.,.0,-28.)call Bj(z4,'h057',270.,.0,.0)call Bj(z4,'h05P',270.,.0,.0)return false
endfunctionfunction Zn takes nothing returns booleancall Bj(z4,'h050',270.,.0,28.)call Bj(z4,'h050',90.,.0,-28.)return false
endfunctionfunction do takes nothing returns booleancall Bj(z4,'h04Y',270.,.0,28.)call Bj(z4,'h050',90.,.0,-28.)call Bj(z4,'h05K',90.,.0,.0)
return false
endfunctionfunction eo takes nothing returns booleancall Bj(z4,'h04Y',270.,.0,28.)call Bj(z4,'h04Y',90.,.0,-28.)call Bj(z4,'h05B',90.,.0,.0)
return false
endfunctionfunction fo takes nothing returns booleancall Bj(z4,'h04Y',270.,.0,28.)call Bj(z4,'h04Y',90.,.0,-28.)call Bj(z4,'h05Y',270.,.0,.0)call Bj(z4,'h05Q',270.,.0,.0)call Bj(z4,'h05S',270.,.0,.0)call Bj(z4,'h05W',270.,.0,.0)return false
endfunctionfunction go takes nothing returns booleancall Bj(z4,'h065',300.,.0,.0)return false
endfunctionfunction ho takes nothing returns booleancall Bj(z4,'h066',270.,.0,.0)return false
endfunctionfunction io takes nothing returns booleancall Bj(z4,'h067',270.,.0,.0)return false
endfunctionfunction jo takes nothing returns booleancall Bj(z4,'h064',270.,.0,.0)return false
endfunctionfunction ko takes nothing returns nothingcall zj('h03Y','h02X')set a8[GetUnitPointValueByType('h03Y')]=4call zj('h03X','h02W')set a8[GetUnitPointValueByType('h03X')]=4call zj('h03Z','h02Y')set a8[GetUnitPointValueByType('h03Z')]=4call zj('h040','h034')set a8[GetUnitPointValueByType('h040')]=2call zj('h041','h03N')set a8[GetUnitPointValueByType('h041')]=2call zj('h042','h03P')set a8[GetUnitPointValueByType('h042')]=3call zj('h044','h03R')set a8[GetUnitPointValueByType('h044')]=3call zj('h045','h02Z')set a8[GetUnitPointValueByType('h045')]=1call zj('h046','u00F')set a8[GetUnitPointValueByType('h046')]=1call zj('h04A','o00C')set a8[GetUnitPointValueByType('h04A')]=5call zj('h04C','o00D')set a8[GetUnitPointValueByType('h04C')]=5call zj('h04D','o00E')set a8[GetUnitPointValueByType('h04D')]=5call zj('h04E','h03V')set a8[GetUnitPointValueByType('h04E')]=1call Fj('h03X',function Qn)call Fj('h03Y',function Rn)call Fj('h03Z',function Sn)call Fj('h040',function Tn)call Fj('h041',function Un)call Fj('h042',function Vn)call Fj('h044',function Wn)call Fj('h045',function Xn)call Fj('h046',function Yn)call Fj('h04A',function Zn)call Fj('h04C',function do)call Fj('h04D',function eo)call Fj('h04E',function fo)call Fj('h05Z',function ho)call Fj('h060',function go)call Fj('h061',function io)call Fj('h063',function jo)call lj('h060',function Pn)call lj('h05Z',function Nn)call Ij('h061',700.)
endfunctionfunction mo takes nothing returns nothinglocal integer id
set id=GetUnitPointValueByType('h03X')set t4[id]=GetUnitGoldCost('h03X')set u4[id]=GetUnitGoldCost('h03X')*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h03Y')set t4[id]=GetUnitGoldCost('h03Y')set u4[id]=GetUnitGoldCost('h03Y')*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h03Z')set t4[id]=GetUnitGoldCost('h03Z')set u4[id]=GetUnitGoldCost('h03Z')*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h042')set t4[id]=GetUnitGoldCost('h042')set u4[id]=GetUnitGoldCost('h042')*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h044')set t4[id]=GetUnitGoldCost('h044')set u4[id]=GetUnitGoldCost('h044')*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h045')set t4[id]=GetUnitGoldCost('h045')set u4[id]=GetUnitGoldCost('h045')*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h046')set t4[id]=GetUnitGoldCost('h046')set u4[id]=GetUnitGoldCost('h046')*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h04A')set t4[id]=GetUnitGoldCost('h04A')set u4[id]=GetUnitGoldCost('h04A')*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h04C')set t4[id]=GetUnitGoldCost('h04C')set u4[id]=GetUnitGoldCost('h04C')*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h04D')set t4[id]=GetUnitGoldCost('h04D')set u4[id]=GetUnitGoldCost('h04D')*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h040')set t4[id]=GetUnitGoldCost('h040')set u4[id]=GetUnitGoldCost('h040')*.18/ 100.
set v4[id]=trueset w4[id]=trueset id=GetUnitPointValueByType('h041')set t4[id]=GetUnitGoldCost('h041')set u4[id]=GetUnitGoldCost('h041')*.18/ 100.
set v4[id]=trueset w4[id]=trueset id=GetUnitPointValueByType('h061')set t4[id]=GetUnitGoldCost('h061')set u4[id]=GetUnitGoldCost('h061')*.08/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h04E')set t4[id]=GetUnitGoldCost('h04E')set u4[id]=GetUnitGoldCost('h04E')*.2/ 100.set v4[id]=false
set id=GetUnitPointValueByType('h060')set t4[id]=GetUnitGoldCost('h060')set u4[id]=GetUnitGoldCost('h060')*.12/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h05Z')set t4[id]=GetUnitGoldCost('h05Z')set u4[id]=GetUnitGoldCost('h05Z')*.09/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h062')set t4[id]=GetUnitGoldCost('h062')set u4[id]=GetUnitGoldCost('h062')*.12/ 100.
set v4[id]=false
endfunctionfunction Elementals___RegisterUnitCasts takes nothing returns nothingcall Lj('h03V','A0E1',function ln)endfunctionfunction no takes nothing returns nothinglocal timer t=GetExpiredTimer()local unit u=LoadUnitHandle(O9,GetHandleId(t),22)local unit w=CreateUnit(GetOwningPlayer(u),'e008',GetUnitX(u),GetUnitY(u),.0)call UnitAddAbility(w,'A0DA')call IssuePointOrderById(w,$D01F9,GetUnitX(u),GetUnitY(u))call UnitApplyTimedLife(w,'BTLF',60.)call SaveUnitHandle(O9,GetHandleId(t),20,w)set t=nullset u=nullset w=nullendfunctionfunction oo takes unit u returns nothing
local integer i=GetRandomInt(0,99)local timer tlocal unit w
if(i<25)then
call UnitAddAbility(u,'A0D8')elseif(i<50)then
call UnitAddAbility(u,'A0D9')call UnitAddAbility(u,'A0EX')elseif(i<75)then
call UnitAddAbility(u,'A03Q')call UnitAddAbility(u,'A0EV')else
call UnitAddAbility(u,'A0EW')set t=CreateTimer()set w=CreateUnit(GetOwningPlayer(u),'e008',GetUnitX(u),GetUnitY(u),.0)call UnitAddAbility(w,'A0DA')call IssuePointOrderById(w,$D01F9,GetUnitX(u),GetUnitY(u))call UnitApplyTimedLife(w,'BTLF',60.)call SaveTimerHandle(O9,GetHandleId(u),21,t)
call SaveUnitHandle(O9,GetHandleId(t),20,w)call SaveUnitHandle(O9,GetHandleId(t),22,u)call TimerStart(t,60.,true,function no)set t=nullset w=nullendifendfunctionfunction po takes unit u returns nothing
local timer t=LoadTimerHandle(O9,GetHandleId(u),21)if(t!=null)thencall PauseTimer(t)call RemoveUnit(LoadUnitHandle(O9,GetHandleId(t),20))call FlushChildHashtable(O9,GetHandleId(t))call DestroyTimer(t)
set t=nullendifendfunctionfunction qo takes player p returns nothinglocal integer id=me[GetPlayerId(p)]set Kd[id]=Kd[id]+(1)endfunctionfunction ro takes unit u returns nothing
local integer id=me[GetPlayerId(GetOwningPlayer(u))]
set Kd[id]=Kd[id]-(1)endfunctionfunction so takes nothing returns nothinglocal unit u
call ko()call mo()call Lj('h03V','A0E1',function ln)set B8=Filter(function On)set u=CreateUnit(Player($D),'e008',.0,.0,.0)
call UnitAddAbility(u,'A0DA')call RemoveUnit(u)set u=nullendfunctionfunction uo takes nothing returns booleanlocal unit u=GetFilterUnit()
local boolean Im=GetWidgetLife(u)>.405 and IsUnitAlly(u,r4)and IsUnitType(u,UNIT_TYPE_SAPPER)and(D8 or GetUnitAbilityLevel(u,'A0F1')<=0)
set u=nullreturn Imendfunctionfunction vo takes nothing returns nothinglocal integer i=GetRandomInt(1,3)set r4=GetOwningPlayer(B4)set D8=false
call GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,E8)set bj_groupRandomCurrentPick=rn(q4)
if(bj_groupRandomCurrentPick==null)thenset D8=truecall GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,E8)set bj_groupRandomCurrentPick=rn(q4)
if(bj_groupRandomCurrentPick==null)thenreturnendifendifcall UnitAddAbility(bj_groupRandomCurrentPick,'A03B')call UnitAddAbility(bj_groupRandomCurrentPick,'A03A')call UnitAddAbility(bj_groupRandomCurrentPick,'A03D')call UnitAddAbility(bj_groupRandomCurrentPick,'A08L')if(i==1)then
call UnitAddAbility(bj_groupRandomCurrentPick,'A05I')call UnitAddAbility(bj_groupRandomCurrentPick,'A06W')elseif(i==2)then
call UnitAddAbility(bj_groupRandomCurrentPick,'A08M')call UnitAddAbility(bj_groupRandomCurrentPick,'A06Y')else
call UnitAddAbility(bj_groupRandomCurrentPick,'A08R')call UnitAddAbility(bj_groupRandomCurrentPick,'A06X')endifcall DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\ReplenishHealth\\ReplenishHealthCasterOverhead.mdl",bj_groupRandomCurrentPick,"overhead"))
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\DispelMagic\\DispelMagicTarget.mdl",GetUnitX(B4),GetUnitY(B4)))endfunctionfunction wo takes nothing returns nothinglocal unit c=CreateUnit(GetOwningPlayer(B4),'e008',GetUnitX(B4),GetUnitY(B4),.0)
call UnitAddAbility(c,'A031')call IssueImmediateOrderById(c,$D009F)call UnitApplyTimedLife(c,'BTLF',1.)
set c=B4
call TriggerSleepAction(1.)call SetUnitAnimation(c,"stand")
set c=nullendfunctionfunction xo takes nothing returns nothinglocal unit c
set r4=GetOwningPlayer(B4)call GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,y9)set bj_groupRandomConsidered=0set bj_groupRandomCurrentPick=nullcall ForGroup(q4,function GroupPickRandomUnitEnum)if(bj_groupRandomCurrentPick==null)thenreturnendifset c=CreateUnit(GetOwningPlayer(B4),'e008',GetUnitX(B4),GetUnitY(B4),.0)call UnitAddAbility(c,'A030')call UnitShareVision(bj_groupRandomCurrentPick,r4,true)call IssueTargetOrderById(c,$D02B6,bj_groupRandomCurrentPick)call UnitShareVision(bj_groupRandomCurrentPick,r4,false)
call UnitApplyTimedLife(c,'BTLF',30.)set c=B4
call TriggerSleepAction(.5)call SetUnitAnimation(c,"attack")call TriggerSleepAction(1.)call SetUnitAnimation(c,"stand")
set c=nullendfunctionfunction yo takes nothing returns nothinglocal unit c=CreateUnit(GetOwningPlayer(c4),'e008',GetUnitX(c4),GetUnitY(c4),.0)
call UnitAddAbility(c,'A06H')call IssueTargetOrderById(c,$D008A,D4)call UnitApplyTimedLife(c,'BTLF',2.)
set c=nullendfunctionfunction zo takes nothing returns nothingcall lj('h02R',function vo)call zj('h02P','o009')call zj('h02K','o007')call zj('h092','o00B')call zj('h035','o008')call zj('h036','o006')call lj('h02O',function wo)call lj('h02N',function xo)call zj('h029','o002')call zj('h02U','o004')call zj('h031','o005')call zj('h02B','o003')call zj('h02I','o001')call Ij('o000',900.)
call zj('h02H','n00V')call zj('h05E','n01O')endfunctionfunction Ao takes nothing returns nothinglocal integer id
set id=GetUnitPointValueByType('h02P')set t4[id]=$DCset u4[id]=$DC*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h02K')set t4[id]=260set u4[id]=260*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h092')set t4[id]='d'set u4[id]='d'*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h035')set t4[id]='d'set u4[id]='d'*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h036')set t4[id]='d'set u4[id]='d'*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h029')set t4[id]='n'set u4[id]='n'*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h02U')set t4[id]='d'set u4[id]='d'*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h031')set t4[id]=$F0set u4[id]=$F0*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h02B')set t4[id]=$AAset u4[id]=$AA*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h02I')set t4[id]=380set u4[id]=380*.18/ 100.
set v4[id]=trueset w4[id]=trueset id=GetUnitPointValueByType('h02H')set t4[id]=$C8set u4[id]=$C8*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h05E')set t4[id]=80set u4[id]=80*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h02R')set t4[id]=$FAset u4[id]=$FA*.12/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h02O')set t4[id]=475set u4[id]=475*.12/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('o000')set t4[id]=$AFset u4[id]=$AF*.08/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h02N')set t4[id]=270set u4[id]=270*.09/ 100.
set v4[id]=false
endfunctionfunction Orc___RegisterUnitCasts takes nothing returns nothingcall Lj('n01O','A06I',function yo)endfunctionfunction ao takes nothing returns nothingcall zo()call Ao()call Lj('n01O','A06I',function yo)set E8=Filter(function uo)endfunctionfunction SmartGroup___DEBUGstateShow takes nothing returns nothinglocal integer i=0local string s="Units at filter: "call DisplayTextToPlayer(GetLocalPlayer(),.0,.0,"Filter called, total count: "+I2S(H8))set i=0loop
set s=s+GetUnitName(G8[i])+" "set i=i+1exitwhen i>H8endloopcall DisplayTextToPlayer(GetLocalPlayer(),.0,.0,s)set i=0set s="Areas at filter: "loop
set s=s+I2S(I8[i])+" "set i=i+1exitwhen i>l8endloopcall DisplayTextToPlayer(GetLocalPlayer(),.0,.0,s)endfunctionfunction Bo takes nothing returns booleanlocal unit u=GetFilterUnit()
if(GetWidgetLife(u)>.405 and IsUnitType(u,UNIT_TYPE_SAPPER)and IsUnitAlly(u,r4)and GetUnitAbilityLevel(u,'Avul')<=0)then
set F8[H8]=u
set H8=H8+1endifset u=nullreturn false
endfunctionfunction bo takes nothing returns booleanlocal unit u=GetFilterUnit()
if(GetWidgetLife(u)>.405 and IsUnitType(u,UNIT_TYPE_SAPPER)and IsUnitEnemy(u,r4)and GetUnitAbilityLevel(u,'Avul')<=0)thenset F8[H8]=u
set H8=H8+1endifset u=nullreturn false
endfunctionfunction Co takes nothing returns nothinglocal integer i=0loop
exitwhen i>=H8set G8[i]=F8[i]set i=i+1endloopset l8=0
set I8[0]=0endfunctionfunction co takes player p,real x,real y,real r returns nothingset l8=0
set I8[0]=0set r4=p
set H8=0
call GroupEnumUnitsInRange(q4,x,y,r,K8)endfunctionfunction Do takes integer Eo returns boolean
local integer i=I8[l8]local integer j=H8local unit u
loop
exitwhen i>=jif(ti(Eo,G8[i]))then
set j=j-1set u=G8[j]set G8[j]=G8[i]set G8[i]=uelse
set i=i+1endifendloopif(i<H8)then
set l8=l8+1set I8[l8]=i
endifset u=nullcall DisplayTextToPlayer(GetLocalPlayer(),.0,.0,I2S(i)+":"+I2S(j)+":"+I2S(H8))return j==H8
endfunctionfunction SmartGroup_GetRandomUnitLastArea takes nothing returns unit
if(I8[l8]>=H8)thenreturn nullendifreturn G8[GetRandomInt(I8[l8],H8-1)]
endfunctionfunction Fo takes nothing returns unitif(I8[l8]>=H8)thenreturn nullendifreturn G8[H8-1]endfunctionfunction Go takes nothing returns nothingset J8=Filter(function Bo)set K8=Filter(function bo)endfunctionfunction Ho takes nothing returns booleanlocal unit u=GetFilterUnit()
local real r=GetWidgetLife(u)local boolean Im=r>.405 and IsUnitEnemy(u,r4)and GetUnitAbilityLevel(u,'A0CV')>0 and GetUnitAbilityLevel(u,'BHbn')<=0 and GetUnitAbilityLevel(u,'A0BG')<=0set u=nullreturn Imendfunctionfunction Io takes nothing returns booleanlocal unit u=GetFilterUnit()
local real r=GetWidgetLife(u)local boolean Im=r>.405 and IsUnitEnemy(u,r4)and IsUnitType(u,UNIT_TYPE_SAPPER)and IsUnitType(u,UNIT_TYPE_GROUND)and GetUnitAbilityLevel(u,'A08H')<=0 and GetUnitAbilityLevel(u,'A0BG')<=0 and GetUnitAbilityLevel(u,'B012')<=0 and GetUnitAbilityLevel(u,'BHbn')<=0 and((GetUnitState(u,UNIT_STATE_MAX_MANA)>100. and r<=600.)or r<=300.)set u=nullreturn Imendfunctionfunction lo takes nothing returns booleanlocal unit u=GetFilterUnit()
local boolean Im=GetWidgetLife(u)>.405 and IsUnitEnemy(u,r4)and IsUnitType(u,UNIT_TYPE_SAPPER)and IsUnitType(u,UNIT_TYPE_GROUND)and GetUnitAbilityLevel(u,'Avul')<=0 and GetUnitAbilityLevel(u,'A08H')<=0 and GetUnitAbilityLevel(u,'A0BG')<=0 and GetUnitAbilityLevel(u,'B012')<=0 and GetUnitAbilityLevel(u,'BHbn')<=0
set u=nullreturn Imendfunctionfunction Jo takes nothing returns booleanlocal unit u=GetFilterUnit()
local real r=GetWidgetLife(u)local boolean Im=r>.405 and IsUnitAlly(u,r4)and IsUnitType(u,UNIT_TYPE_STRUCTURE)and GetUnitState(u,UNIT_STATE_MAX_LIFE)-r>50.set u=nullreturn Imendfunctionfunction Ko takes nothing returns booleanlocal unit u=GetFilterUnit()
local real r=GetWidgetLife(u)local boolean Im=r>.405 and IsUnitAlly(u,r4)and IsUnitType(u,UNIT_TYPE_MECHANICAL)and GetUnitState(u,UNIT_STATE_MAX_LIFE)-r>50.set u=nullreturn Imendfunctionfunction Lo takes unit u returns nothing
local integer bj=GetUnitPointValue(u)local integer id=GetUnitUserData(u)set r4=GetOwningPlayer(u)if(bj==$81)thenif(L8[id]!=null and GetWidgetLife(L8[id])>.405 and IsUnitEnemy(L8[id],r4))thenif(GetUnitAbilityLevel(L8[id],'B012')>0 or GetUnitAbilityLevel(L8[id],'BHbn')>0)then
set L8[id]=nullelseif(not IssueTargetOrderById(u,$D000F,L8[id]))thencall IssuePointOrderById(u,$D0012,GetUnitX(L8[id]),GetUnitY(L8[id]))
endifelseif(GetUnitAbilityLevel(u,'B012')>0 or IssueImmediateOrderById(u,$D00A1))then
call GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,P8)set bj_groupRandomCurrentPick=rn(q4)
if(bj_groupRandomCurrentPick==null)thencall GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,Q8)set bj_groupRandomCurrentPick=rn(q4)
endifif(bj_groupRandomCurrentPick==null)thencall IssuePointOrderById(u,$D0012,GetUnitX(u),GetUnitY(u))else
set L8[id]=bj_groupRandomCurrentPick
call IssuePointOrderById(u,$D0012,GetUnitX(bj_groupRandomCurrentPick),GetUnitY(bj_groupRandomCurrentPick))endifelse
call IssuePointOrderByIdLoc(u,$D000F,Id[me[GetPlayerId(r4)]])endifelseif(bj==$82)thenif(L8[id]==null)then
call GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,S8)set bj_groupRandomCurrentPick=rn(q4)
if(bj_groupRandomCurrentPick==null)thencall GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,T8)set bj_groupRandomCurrentPick=rn(q4)
endifset L8[id]=u
if(bj_groupRandomCurrentPick==null)thenset N8[id]=GetUnitX(u)set O8[id]=GetUnitY(u)else
set N8[id]=GetUnitX(bj_groupRandomCurrentPick)set O8[id]=GetUnitY(bj_groupRandomCurrentPick)endifcall IssuePointOrderById(u,$D000F,N8[id],O8[id])
else
call IssuePointOrderById(u,$D000F,N8[id],O8[id])
endifendifendfunctionfunction Mo takes unit u returns nothing
local integer i=0loop
exitwhen M8[i]==falseset i=i+1endloopset M8[i]=trueset L8[i]=nullcall SetUnitUserData(u,i)if(GetUnitTypeId(u)=='n01U')then
call UnitApplyTimedLife(u,'BTLF','x')endifendfunctionfunction No takes nothing returns nothingset P8=Filter(function Ho)set Q8=Filter(function Io)set R8=Filter(function lo)set S8=Filter(function Jo)set T8=Filter(function Ko)endfunctionfunction AdvancedSmartGroup_PrepareSorting takes nothing returns nothing
call Co()endfunctionfunction Oo takes integer s1,integer s2,integer s3,integer s4 returns unitcall Co()if(Do(s1))thencall DisplayTextToPlayer(GetLocalPlayer(),.0,.0,"G:s1 returned")
return nullendifif(s2!=0)thenif(Do(s2))thencall DisplayTextToPlayer(GetLocalPlayer(),.0,.0,"G:s2 returned")
return Fo()endifendifif(s3!=0)thenif(Do(s3))thencall DisplayTextToPlayer(GetLocalPlayer(),.0,.0,"G:s3 returned")
return Fo()endifendifif(s4!=0)thencall Do(s4)endifreturn Fo()endfunctionfunction Po takes unit u returns nothing
call IssuePointOrderByIdLoc(u,$D000F,Id[me[GetPlayerId(GetOwningPlayer(u))]])endfunctionfunction Qo takes unit u returns nothing
if(IsUnitType(u,UNIT_TYPE_TAUREN))thenreturnendifif(GetUnitAbilityLevel(u,'A07M')>=1)then
call Lo(u)else
call IssuePointOrderByIdLoc(u,$D000F,Id[me[GetPlayerId(GetOwningPlayer(u))]])endifendfunctionfunction Ro takes real x,real y returns real
return SquareRoot(x*x+y*y)endfunctionfunction So takes nothing returns nothinglocal timer t=GetExpiredTimer()local integer id=LoadInteger(O9,GetHandleId(t),1)if(GetWidgetLife(U8[id])>.405 and Ro(V8[id]-GetUnitX(U8[id]),W8[id]-GetUnitY(U8[id]))>768.)thencall UnitRemoveAbility(U8[id],'A0BG')endifset Y8=Y8-1set X8[id]=X8[Y8]set V8[id]=V8[Y8]set W8[id]=W8[Y8]set U8[id]=U8[Y8]call SaveInteger(O9,GetHandleId(X8[Y8]),1,id)set X8[Y8]=t
set t=nullendfunctionfunction To takes nothing returns nothinglocal timer t=GetExpiredTimer()local integer id=LoadInteger(O9,GetHandleId(t),1)if(GetWidgetLife(U8[id])>.405)thencall SetUnitPathing(U8[id],true)
call TimerStart(t,4.,false,Z8)else
set Y8=Y8-1set X8[id]=X8[Y8]set V8[id]=V8[Y8]set W8[id]=W8[Y8]set U8[id]=U8[Y8]call SaveInteger(O9,GetHandleId(X8[Y8]),1,id)set X8[Y8]=t
endifset t=nullendfunctionfunction Uo takes nothing returns nothinglocal timer t=GetExpiredTimer()local integer id=LoadInteger(O9,GetHandleId(t),1)if(GetWidgetLife(U8[id])>.405 and Ro(V8[id]-GetUnitX(U8[id]),W8[id]-GetUnitY(U8[id]))<768.)thencall SetUnitPathing(U8[id],false)call Qo(U8[id])call TimerStart(t,.7,false,function To)else
call UnitRemoveAbility(U8[id],'A0BG')set Y8=Y8-1set X8[id]=X8[Y8]set V8[id]=V8[Y8]set W8[id]=W8[Y8]set U8[id]=U8[Y8]call SaveInteger(O9,GetHandleId(X8[Y8]),1,id)set X8[Y8]=t
endifset t=nullendfunctionfunction Vo takes unit u returns nothing
call UnitAddAbility(u,'A0BG')if(X8[Y8]==null)then
set X8[Y8]=CreateTimer()
endifset V8[Y8]=GetUnitX(u)set W8[Y8]=GetUnitY(u)set U8[Y8]=u
call SaveInteger(O9,GetHandleId(X8[Y8]),1,Y8)call TimerStart(X8[Y8],4.,false,Z8)set Y8=Y8+1endfunctionfunction Wo takes nothing returns nothingif(ud)thenset Z8=function Uoelse
set Z8=function Soendifendfunctionfunction Xo takes nothing returns nothinglocal unit Ui=GetAttacker()local unit Yoif(GetUnitAbilityLevel(Ui,'A0EZ')>0)then
set Yo=GetTriggerUnit()call UnitRemoveAbility(Ui,'A0EZ')call TriggerSleepAction(.0)if(not IssueTargetOrderById(Ui,$D0279,Yo))thencall Po(Ui)endifset Yo=nullendifset Ui=nullendfunctionfunction Zo takes nothing returns nothingcall TriggerRegisterAnyUnitEventBJ(d9,EVENT_PLAYER_UNIT_ATTACKED)call TriggerAddAction(d9,function Xo)endfunctionfunction dp takes boolean ep returns nothing
if(ep)thencall EnableTrigger(d9)else
call DisableTrigger(d9)endifendfunctionfunction fp takes integer oi,unit u returns booleanreturn GetWidgetLife(u)<100.
endfunctionfunction gp takes integer oi,unit u returns booleanreturn IsUnitType(u,UNIT_TYPE_RANGED_ATTACKER)endfunctionfunction hp takes integer oi,unit u returns booleanreturn IsUnitType(u,UNIT_TYPE_MELEE_ATTACKER)endfunctionfunction ip takes integer oi,unit u returns booleanreturn IsUnitType(u,UNIT_TYPE_FLYING)endfunctionfunction jp takes integer oi,unit u returns booleanreturn IsUnitType(u,UNIT_TYPE_GROUND)endfunctionfunction kp takes integer oi,unit u returns booleanreturn LoadInteger(i9,GetUnitTypeId(u),1)==0
endfunctionfunction np takes integer oi,unit u returns booleanreturn LoadInteger(i9,GetUnitTypeId(u),1)==1
endfunctionfunction pp takes integer oi,unit u returns booleanreturn LoadInteger(i9,GetUnitTypeId(u),1)==2
endfunctionfunction qp takes integer oi,unit u returns booleanreturn LoadInteger(i9,GetUnitTypeId(u),1)==3
endfunctionfunction rp takes integer oi,unit u returns booleanreturn LoadInteger(i9,GetUnitTypeId(u),1)==4
endfunctionfunction sp takes integer oi,unit u returns booleanreturn LoadInteger(i9,GetUnitTypeId(u),1)==5
endfunctionfunction tp takes integer oi,unit u returns booleanreturn LoadInteger(i9,GetUnitTypeId(u),1)==6
endfunctionfunction up takes integer oi,unit u returns booleanlocal integer vp=LoadInteger(i9,GetUnitTypeId(u),1)return vp==1 or vp==6endfunctionfunction UnitsAI___Enemy takes nothing returns booleanreturn IsUnitEnemy(GetFilterUnit(),e9)endfunctionfunction UnitsAI___Alive takes nothing returns booleanreturn GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7endfunctionfunction UnitsAI___Damaged takes nothing returns boolean
return GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.endfunctionfunction UnitsAI___RangedUnit takes nothing returns booleanreturn(IsUnitType(GetFilterUnit(),UNIT_TYPE_RANGED_ATTACKER))!=nullendfunctionfunction UnitsAI___MeleeUnit takes nothing returns booleanreturn(IsUnitType(GetFilterUnit(),UNIT_TYPE_MELEE_ATTACKER))!=nullendfunctionfunction UnitsAI___Air takes nothing returns boolean
return(IsUnitType(GetFilterUnit(),UNIT_TYPE_FLYING))!=nullendfunctionfunction UnitsAI___Ground takes nothing returns booleanreturn(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))!=nullendfunctionfunction UnitsAI___HeroDef takes nothing returns boolean
return LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==0endfunctionfunction UnitsAI___LightDef takes nothing returns booleanreturn LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==1endfunctionfunction UnitsAI___HeavyDef takes nothing returns booleanreturn LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==2endfunctionfunction UnitsAI___DivineDef takes nothing returns booleanreturn LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==3endfunctionfunction UnitsAI___MediumDef takes nothing returns booleanreturn LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==4endfunctionfunction UnitsAI___FortifiedDef takes nothing returns booleanreturn LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==5endfunctionfunction UnitsAI___UnarmoredDef takes nothing returns booleanreturn LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==6endfunctionfunction wp takes nothing returns booleanreturn((IsUnitType(GetFilterUnit(),UNIT_TYPE_RANGED_ATTACKER))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitEnemy(GetFilterUnit(),e9)))!=nullendfunctionfunction xp takes nothing returns booleanreturn((IsUnitType(GetFilterUnit(),UNIT_TYPE_RANGED_ATTACKER))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7))!=nullendfunctionfunction yp takes nothing returns booleanreturn((IsUnitType(GetFilterUnit(),UNIT_TYPE_MELEE_ATTACKER))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitEnemy(GetFilterUnit(),e9)))!=null
endfunctionfunction zp takes nothing returns booleanreturn((IsUnitType(GetFilterUnit(),UNIT_TYPE_MELEE_ATTACKER))and(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==3)and(IsUnitEnemy(GetFilterUnit(),e9))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7))!=nullendfunctionfunction Ap takes nothing returns booleanreturn((IsUnitType(GetFilterUnit(),UNIT_TYPE_MELEE_ATTACKER))and(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==0)and(IsUnitEnemy(GetFilterUnit(),e9))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7))!=nullendfunctionfunction ap takes nothing returns booleanreturn((IsUnitType(GetFilterUnit(),UNIT_TYPE_MELEE_ATTACKER))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitEnemy(GetFilterUnit(),e9)))!=nullendfunctionfunction Bp takes nothing returns booleanreturn(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==1)endfunctionfunction bp takes nothing returns booleanreturn((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==6)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_RANGED_ATTACKER))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9)))!=nullendfunctionfunction Cp takes nothing returns booleanreturn((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==6)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_RANGED_ATTACKER))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7))!=nullendfunctionfunction cp takes nothing returns booleanreturn((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==6)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9)))!=null
endfunctionfunction Dp takes nothing returns booleanreturn((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==6)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7))!=nullendfunctionfunction Ep takes nothing returns booleanreturn(((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==1)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==2)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==4))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_RANGED_ATTACKER))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9)))!=nullendfunctionfunction Fp takes nothing returns booleanreturn(((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==1)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==2)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==4))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_RANGED_ATTACKER))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7))!=nullendfunctionfunction UnitsAI___meleeSiege8 takes nothing returns boolean
return(((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==1)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==2)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==4))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9)))!=null
endfunctionfunction Gp takes nothing returns booleanreturn(((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==1)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==2)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==4))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7))!=nullendfunctionfunction Hp takes nothing returns booleanreturn((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==0)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7))!=nullendfunctionfunction Ip takes nothing returns booleanreturn((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==3)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7))!=nullendfunctionfunction lp takes nothing returns booleanreturn((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==4)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_RANGED_ATTACKER))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9)))!=nullendfunctionfunction Jp takes nothing returns booleanreturn((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==4)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_RANGED_ATTACKER))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7))!=nullendfunctionfunction Kp takes nothing returns booleanreturn((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==4)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9)))!=null
endfunctionfunction Lp takes nothing returns booleanreturn((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==4)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7))!=nullendfunctionfunction Mp takes nothing returns booleanreturn(((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==6)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==2))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_RANGED_ATTACKER))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9)))!=nullendfunctionfunction Np takes nothing returns booleanreturn(((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==6)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==2))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_RANGED_ATTACKER))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7))!=null
endfunctionfunction Op takes nothing returns booleanreturn(((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==6)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==2))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9)))!=nullendfunctionfunction Pp takes nothing returns booleanreturn(((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==6)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==2))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7))!=nullendfunctionfunction Qp takes nothing returns booleanreturn(((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==0)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==3)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==1))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_RANGED_ATTACKER))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9)))!=nullendfunctionfunction Rp takes nothing returns booleanreturn(((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==0)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==3)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==1))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_RANGED_ATTACKER))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7))!=nullendfunctionfunction Sp takes nothing returns booleanreturn(((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==0)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==3)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==1))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9)))!=null
endfunctionfunction Tp takes nothing returns booleanreturn(((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==0)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==3)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==1))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7))!=nullendfunctionfunction Up takes nothing returns booleanreturn((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==1)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_RANGED_ATTACKER))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9)))!=nullendfunctionfunction Vp takes nothing returns booleanreturn((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==1)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_RANGED_ATTACKER))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7))!=nullendfunctionfunction Wp takes nothing returns booleanreturn((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==1)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9)))!=null
endfunctionfunction Xp takes nothing returns booleanreturn((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==1)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7))!=nullendfunctionfunction Yp takes nothing returns booleanreturn(((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==6)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==4))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_RANGED_ATTACKER))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9)))!=nullendfunctionfunction Zp takes nothing returns booleanreturn(((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==6)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==4))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_RANGED_ATTACKER))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7))!=null
endfunctionfunction dq takes nothing returns booleanreturn(((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==6)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==4))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9)))!=nullendfunctionfunction eq takes nothing returns booleanreturn(((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==6)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==4))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7))!=nullendfunctionfunction fq takes nothing returns booleanreturn(((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==0)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==3)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==2))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_RANGED_ATTACKER))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9)))!=nullendfunctionfunction gq takes nothing returns booleanreturn(((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==0)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==3)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==2))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_RANGED_ATTACKER))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7))!=nullendfunctionfunction hq takes nothing returns booleanreturn(((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==0)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==3)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==2))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9)))!=null
endfunctionfunction iq takes nothing returns booleanreturn(((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==0)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==3)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==2))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7))!=nullendfunctionfunction jq takes nothing returns booleanreturn((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==2)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_RANGED_ATTACKER))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9)))!=nullendfunctionfunction kq takes nothing returns booleanreturn((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==2)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_RANGED_ATTACKER))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7))!=nullendfunctionfunction mq takes nothing returns booleanreturn((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==2)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9)))!=null
endfunctionfunction nq takes nothing returns booleanreturn((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==2)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7))!=nullendfunctionfunction oq takes nothing returns booleanreturn(((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==6)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==1))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_RANGED_ATTACKER))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9)))!=nullendfunctionfunction qq takes nothing returns booleanreturn(((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==6)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==1))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_RANGED_ATTACKER))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7))!=null
endfunctionfunction rq takes nothing returns booleanreturn(((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==6)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==1))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9)))!=nullendfunctionfunction sq takes nothing returns booleanreturn(((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==6)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==1))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7))!=nullendfunctionfunction tq takes nothing returns booleanreturn(((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==0)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==3)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==4))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_RANGED_ATTACKER))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9)))!=nullendfunctionfunction uq takes nothing returns booleanreturn(((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==0)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==3)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==4))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_RANGED_ATTACKER))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7))!=nullendfunctionfunction vq takes nothing returns booleanreturn(((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==0)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==3)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==4))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9)))!=null
endfunctionfunction wq takes nothing returns booleanreturn(((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==0)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==3)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==4))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7))!=nullendfunctionfunction xq takes nothing returns booleanreturn((IsUnitType(GetFilterUnit(),UNIT_TYPE_FLYING))and(IsUnitEnemy(GetFilterUnit(),e9))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7))!=nullendfunctionfunction yq takes nothing returns booleanreturn((IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(IsUnitEnemy(GetFilterUnit(),e9))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7))!=nullendfunctionfunction zq takes integer oi returns nothing
call SaveInteger(i9,'n000',0,0)call SaveInteger(i9,'h03B',0,1)call SaveInteger(i9,'h03C',0,1)call SaveInteger(i9,'n01X',0,1)call SaveInteger(i9,'n024',0,1)call SaveInteger(i9,'n01M',0,1)call SaveInteger(i9,'z002',0,2)call SaveInteger(i9,'z003',0,2)call SaveInteger(i9,'n00B',0,2)call SaveInteger(i9,'n01K',0,2)call SaveInteger(i9,'u007',0,2)call SaveInteger(i9,'n00C',0,2)call SaveInteger(i9,'n00L',0,2)call SaveInteger(i9,'n00M',0,2)call SaveInteger(i9,'n00N',0,2)call SaveInteger(i9,'n00O',0,2)call SaveInteger(i9,'n00P',0,2)call SaveInteger(i9,'n00Q',0,2)call SaveInteger(i9,'n00R',0,2)call SaveInteger(i9,'n00O',0,2)call SaveInteger(i9,'h034',0,3)call SaveInteger(i9,'h03N',0,3)call SaveInteger(i9,'n00E',0,3)call SaveInteger(i9,'hfoo',0,4)call SaveInteger(i9,'h03A',0,4)call SaveInteger(i9,'h02W',0,4)call SaveInteger(i9,'h02X',0,4)call SaveInteger(i9,'h02Y',0,4)call SaveInteger(i9,'o002',0,4)call SaveInteger(i9,'o004',0,4)call SaveInteger(i9,'o005',0,4)call SaveInteger(i9,'u002',0,4)call SaveInteger(i9,'u00B',0,4)call SaveInteger(i9,'n01I',0,4)call SaveInteger(i9,'n01H',0,4)call SaveInteger(i9,'n027',0,4)call SaveInteger(i9,'n006',0,4)call SaveInteger(i9,'n00Y',0,4)call SaveInteger(i9,'n017',0,4)call SaveInteger(i9,'n018',0,4)call SaveInteger(i9,'n016',0,4)call SaveInteger(i9,'n029',0,4)call SaveInteger(i9,'n02B',0,4)call SaveInteger(i9,'n009',0,4)call SaveInteger(i9,'n00Z',0,4)call SaveInteger(i9,'n00I',0,4)call SaveInteger(i9,'n00J',0,4)call SaveInteger(i9,'n00K',0,4)call SaveInteger(i9,'h06U',0,4)call SaveInteger(i9,'e00F',0,4)call SaveInteger(i9,'o007',0,5)call SaveInteger(i9,'n01T',0,5)call SaveInteger(i9,'h01V',0,5)call SaveInteger(i9,'h01U',0,5)call SaveInteger(i9,'h05H',0,5)call SaveInteger(i9,'n01G',0,5)call SaveInteger(i9,'n012',0,5)call SaveInteger(i9,'n013',0,5)call SaveInteger(i9,'n00T',0,5)call SaveInteger(i9,'n00U',0,5)call SaveInteger(i9,'n01N',0,5)call SaveInteger(i9,'n01W',0,5)call SaveInteger(i9,'n002',0,5)call SaveInteger(i9,'n00X',0,5)call SaveInteger(i9,'e00B',0,6)call SaveInteger(i9,'e00A',0,6)call SaveInteger(i9,'h034',1,0)call SaveInteger(i9,'h03N',1,0)call SaveInteger(i9,'h01V',1,0)call SaveInteger(i9,'h01U',1,0)call SaveInteger(i9,'h05H',1,0)call SaveInteger(i9,'n00R',1,0)call SaveInteger(i9,'o007',1,1)call SaveInteger(i9,'z002',1,1)call SaveInteger(i9,'z003',1,1)call SaveInteger(i9,'u002',1,1)call SaveInteger(i9,'u00B',1,1)call SaveInteger(i9,'n01M',1,1)call SaveInteger(i9,'n01C',1,1)call SaveInteger(i9,'e00B',1,1)call SaveInteger(i9,'e00A',1,1)call SaveInteger(i9,'n00N',1,1)call SaveInteger(i9,'hfoo',1,2)call SaveInteger(i9,'h03A',1,2)call SaveInteger(i9,'h03B',1,2)call SaveInteger(i9,'h03C',1,2)call SaveInteger(i9,'o002',1,2)call SaveInteger(i9,'o004',1,2)call SaveInteger(i9,'o005',1,2)call SaveInteger(i9,'n01I',1,2)call SaveInteger(i9,'n01H',1,2)call SaveInteger(i9,'n027',1,2)call SaveInteger(i9,'n006',1,2)call SaveInteger(i9,'n00Y',1,2)call SaveInteger(i9,'n00P',1,2)call SaveInteger(i9,'n000',1,2)call SaveInteger(i9,'n002',1,2)call SaveInteger(i9,'n00X',1,2)call SaveInteger(i9,'h06U',1,2)call SaveInteger(i9,'n024',1,3)call SaveInteger(i9,'n00M',1,3)call SaveInteger(i9,'h02W',1,4)call SaveInteger(i9,'h02X',1,4)call SaveInteger(i9,'h02Y',1,4)call SaveInteger(i9,'n01X',1,4)call SaveInteger(i9,'n01T',1,4)call SaveInteger(i9,'n00B',1,4)call SaveInteger(i9,'n01K',1,4)call SaveInteger(i9,'u007',1,4)call SaveInteger(i9,'n01G',1,4)call SaveInteger(i9,'n012',1,4)call SaveInteger(i9,'n013',1,4)call SaveInteger(i9,'n009',1,4)call SaveInteger(i9,'n00Z',1,4)call SaveInteger(i9,'n00L',1,4)call SaveInteger(i9,'n00O',1,4)call SaveInteger(i9,'e00F',1,5)call SaveInteger(i9,'n018',1,6)call SaveInteger(i9,'n016',1,6)call SaveInteger(i9,'n029',1,6)call SaveInteger(i9,'n02B',1,6)call SaveInteger(i9,'n00T',1,6)call SaveInteger(i9,'n00U',1,6)call SaveInteger(i9,'n01N',1,6)call SaveInteger(i9,'n01W',1,6)call SaveInteger(i9,'n00Q',1,6)call SaveInteger(i9,'n00I',1,6)call SaveInteger(i9,'n00J',1,6)call SaveInteger(i9,'n00K',1,6)endfunctionfunction Aq takes integer oi,unit u returns nothingcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function wp))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function xp))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function yp))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function zp))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Ap))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function ap))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifendfunctionfunction aq takes integer oi,unit u returns nothingcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function wp))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function xp))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function yp))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function zp))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Ap))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function ap))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifendfunctionfunction Bq takes integer oi,unit u returns nothingcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Bp))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function bp))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Cp))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function cp))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Dp))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Ep))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Fp))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Gp))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Hp))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Ip))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifendfunctionfunction bq takes integer oi,unit u returns nothingcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function lp))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Jp))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Kp))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Lp))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Mp))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Np))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Op))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Pp))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Qp))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Rp))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Sp))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Tp))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifendfunctionfunction Cq takes integer oi,unit u returns nothingcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Up))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Vp))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Wp))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Xp))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Yp))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Zp))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function dq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function eq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function fq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function gq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function hq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function iq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifendfunctionfunction cq takes integer oi,unit u returns nothingcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function jq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function kq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function mq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function nq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function oq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function qq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function rq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function sq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function tq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function uq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function vq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function wq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifendfunctionfunction Dq takes integer oi,unit u returns nothingcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function xq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function yq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifendfunctionfunction Eq takes integer oi,unit u returns nothinglocal integer id=LoadInteger(i9,GetUnitTypeId(u),0)if id==1 thencall Aq(oi,u)elseif id==2 thencall aq(oi,u)elseif id==3 thencall Bq(oi,u)elseif id==4 thencall bq(oi,u)elseif id==5 thencall Cq(oi,u)elseif id==6 thencall cq(oi,u)elseif id==0 thencall Dq(oi,u)endifendfunctionfunction Fq takes nothing returns booleanreturn(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(IsUnitEnemy(GetFilterUnit(),e9))endfunctionfunction Gq takes nothing returns booleanreturn(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(IsUnitEnemy(GetFilterUnit(),e9))and(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==3)endfunctionfunction Hq takes nothing returns booleanreturn(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitEnemy(GetFilterUnit(),e9))and(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==3)
endfunctionfunction Iq takes nothing returns booleanreturn((GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitEnemy(GetFilterUnit(),e9))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_RANGED_ATTACKER)))!=nullendfunctionfunction lq takes nothing returns booleanreturn((GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(IsUnitEnemy(GetFilterUnit(),e9))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND)))!=null
endfunctionfunction Jq takes nothing returns booleanreturn((GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==6)and(IsUnitEnemy(GetFilterUnit(),e9))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.))!=null
endfunctionfunction Kq takes nothing returns booleanreturn((GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==6)and(IsUnitEnemy(GetFilterUnit(),e9))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_GROUND)))!=nullendfunctionfunction Lq takes nothing returns booleanreturn((GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(IsUnitEnemy(GetFilterUnit(),e9))and(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==4)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_FLYING)))!=null
endfunctionfunction Mq takes nothing returns booleanreturn(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(IsUnitEnemy(GetFilterUnit(),e9))and(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==4)endfunctionfunction Nq takes nothing returns booleanreturn((GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitEnemy(GetFilterUnit(),e9))and(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==4)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_FLYING)))!=nullendfunctionfunction Oq takes nothing returns booleanreturn(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitEnemy(GetFilterUnit(),e9))and(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==4)
endfunctionfunction Pq takes nothing returns booleanreturn((GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitEnemy(GetFilterUnit(),e9))and((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==2)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==6))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_FLYING)))!=nullendfunctionfunction Qq takes nothing returns booleanreturn(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitEnemy(GetFilterUnit(),e9))and((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==2)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==6))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)
endfunctionfunction Rq takes nothing returns booleanreturn((GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitEnemy(GetFilterUnit(),e9))and((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==2)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==6))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_FLYING)))!=nullendfunctionfunction Sq takes nothing returns booleanreturn(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitEnemy(GetFilterUnit(),e9))and((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==2)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==6))endfunctionfunction Tq takes nothing returns booleanreturn((GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitEnemy(GetFilterUnit(),e9))and(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==1)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_FLYING)))!=null
endfunctionfunction Uq takes nothing returns booleanreturn(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitEnemy(GetFilterUnit(),e9))and(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==1)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)endfunctionfunction Vq takes nothing returns booleanreturn((GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitEnemy(GetFilterUnit(),e9))and(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==1)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_FLYING)))!=nullendfunctionfunction Wq takes nothing returns booleanreturn(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitEnemy(GetFilterUnit(),e9))and(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==1)
endfunctionfunction Xq takes nothing returns booleanreturn((GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(IsUnitEnemy(GetFilterUnit(),e9))and(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==1)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_FLYING)))!=null
endfunctionfunction Yq takes nothing returns booleanreturn(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(IsUnitEnemy(GetFilterUnit(),e9))and(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==1)endfunctionfunction Zq takes nothing returns booleanreturn((GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitEnemy(GetFilterUnit(),e9))and(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==1)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_FLYING)))!=nullendfunctionfunction dr takes nothing returns booleanreturn(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitEnemy(GetFilterUnit(),e9))and(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==1)
endfunctionfunction er takes nothing returns booleanreturn((GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitEnemy(GetFilterUnit(),e9))and((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==4)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==6))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_FLYING)))!=nullendfunctionfunction fr takes nothing returns booleanreturn(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitEnemy(GetFilterUnit(),e9))and((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==4)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==6))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)
endfunctionfunction gr takes nothing returns booleanreturn((GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitEnemy(GetFilterUnit(),e9))and((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==4)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==6))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_FLYING)))!=nullendfunctionfunction hr takes nothing returns booleanreturn(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitEnemy(GetFilterUnit(),e9))and((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==4)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==6))endfunctionfunction ir takes nothing returns booleanreturn((GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitEnemy(GetFilterUnit(),e9))and(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==2)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_FLYING)))!=null
endfunctionfunction jr takes nothing returns booleanreturn(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitEnemy(GetFilterUnit(),e9))and(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==2)and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.)endfunctionfunction kr takes nothing returns booleanreturn((GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitEnemy(GetFilterUnit(),e9))and(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==2)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_FLYING)))!=nullendfunctionfunction mr takes nothing returns booleanreturn(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitEnemy(GetFilterUnit(),e9))and(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==2)
endfunctionfunction nr takes nothing returns booleanreturn((GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitEnemy(GetFilterUnit(),e9))and(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==1)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_FLYING))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.))!=null
endfunctionfunction UnitsAI___rangedAA2 takes nothing returns booleanreturn((GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitEnemy(GetFilterUnit(),e9))and(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==1)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_FLYING)))!=nullendfunctionfunction UnitsAI___rangedAA3 takes nothing returns booleanreturn((GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitEnemy(GetFilterUnit(),e9))and((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==6)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==4))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_FLYING))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.))!=nullendfunctionfunction UnitsAI___rangedAA4 takes nothing returns booleanreturn((GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitEnemy(GetFilterUnit(),e9))and((LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==6)or(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==4))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_FLYING)))!=nullendfunctionfunction UnitsAI___rangedAA5 takes nothing returns booleanreturn((GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitEnemy(GetFilterUnit(),e9))and(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==2)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_FLYING))and(GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<100.))!=null
endfunctionfunction UnitsAI___rangedAA6 takes nothing returns booleanreturn((GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>.7)and(IsUnitEnemy(GetFilterUnit(),e9))and(LoadInteger(i9,GetUnitTypeId(GetFilterUnit()),1)==2)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_FLYING)))!=nullendfunctionfunction qr takes integer oi returns nothing
call SaveInteger(i9,'n05C',0,0)call SaveInteger(i9,'o00C',0,0)call SaveInteger(i9,'o00D',0,0)call SaveInteger(i9,'o00E',0,0)call SaveInteger(i9,'h05C',0,0)call SaveInteger(i9,'h06Q',0,0)call SaveInteger(i9,'h06R',0,0)call SaveInteger(i9,'h02Z',0,2)call SaveInteger(i9,'h030',0,2)call SaveInteger(i9,'h04I',0,2)call SaveInteger(i9,'e007',0,2)call SaveInteger(i9,'e00J',0,2)call SaveInteger(i9,'h00W',0,2)call SaveInteger(i9,'n014',0,2)call SaveInteger(i9,'h010',0,2)call SaveInteger(i9,'e00C',0,2)call SaveInteger(i9,'n001',0,2)call SaveInteger(i9,'n02A',0,2)call SaveInteger(i9,'n01R',0,2)call SaveInteger(i9,'n01P',0,2)call SaveInteger(i9,'n01Q',0,2)call SaveInteger(i9,'n00S',0,2)call SaveInteger(i9,'hmtm',0,3)call SaveInteger(i9,'o001',0,3)call SaveInteger(i9,'n01F',0,3)call SaveInteger(i9,'n01E',0,3)call SaveInteger(i9,'e005',0,3)call SaveInteger(i9,'e002',0,3)call SaveInteger(i9,'n007',0,3)call SaveInteger(i9,'n00V',0,4)call SaveInteger(i9,'n01O',0,4)call SaveInteger(i9,'h06S',0,4)call SaveInteger(i9,'h098',0,4)call SaveInteger(i9,'n00A',0,4)call SaveInteger(i9,'z000',0,4)call SaveInteger(i9,'n004',0,4)call SaveInteger(i9,'u000',0,4)call SaveInteger(i9,'h06T',0,4)call SaveInteger(i9,'hrif',0,5)call SaveInteger(i9,'h0A2',0,5)call SaveInteger(i9,'o00D',0,5)call SaveInteger(i9,'o00E',0,5)call SaveInteger(i9,'o006',0,5)call SaveInteger(i9,'o008',0,5)call SaveInteger(i9,'o00B',0,5)call SaveInteger(i9,'o009',0,5)call SaveInteger(i9,'n00D',0,5)call SaveInteger(i9,'n01L',0,5)call SaveInteger(i9,'e001',0,5)call SaveInteger(i9,'e003',0,5)call SaveInteger(i9,'e004',0,5)call SaveInteger(i9,'n022',0,5)call SaveInteger(i9,'n023',0,5)call SaveInteger(i9,'n01Y',0,5)call SaveInteger(i9,'n011',0,5)call SaveInteger(i9,'e006',0,5)call SaveInteger(i9,'e009',0,5)call SaveInteger(i9,'e00C',0,5)call SaveInteger(i9,'h016',0,6)call SaveInteger(i9,'o003',0,6)call SaveInteger(i9,'u005',0,6)call SaveInteger(i9,'u009',0,6)call SaveInteger(i9,'u00D',0,6)call SaveInteger(i9,'u001',0,6)call SaveInteger(i9,'u00A',0,6)call SaveInteger(i9,'u003',0,6)call SaveInteger(i9,'n01B',0,6)call SaveInteger(i9,'n01D',0,6)call SaveInteger(i9,'n019',0,6)call SaveInteger(i9,'n01A',0,6)call SaveInteger(i9,'e000',0,6)call SaveInteger(i9,'h07B',0,6)call SaveInteger(i9,'h00U',0,6)call SaveInteger(i9,'n015',0,6)call SaveInteger(i9,'o00A',0,6)call SaveInteger(i9,'n026',0,6)call SaveInteger(i9,'n028',0,6)call SaveInteger(i9,'n008',0,6)call SaveInteger(i9,'n00H',0,6)call SaveInteger(i9,'o006',1,1)call SaveInteger(i9,'o008',1,1)call SaveInteger(i9,'o00B',1,1)call SaveInteger(i9,'u000',1,1)call SaveInteger(i9,'u00A',1,1)call SaveInteger(i9,'u003',1,1)call SaveInteger(i9,'n00D',1,1)call SaveInteger(i9,'n01L',1,1)call SaveInteger(i9,'n019',1,1)call SaveInteger(i9,'n01A',1,1)call SaveInteger(i9,'e001',1,1)call SaveInteger(i9,'e003',1,1)call SaveInteger(i9,'e004',1,1)call SaveInteger(i9,'e000',1,1)call SaveInteger(i9,'n015',1,1)call SaveInteger(i9,'o00A',1,1)call SaveInteger(i9,'n026',1,1)call SaveInteger(i9,'n028',1,1)call SaveInteger(i9,'n00A',1,1)call SaveInteger(i9,'z000',1,1)call SaveInteger(i9,'n008',1,1)call SaveInteger(i9,'n00H',1,1)call SaveInteger(i9,'h03P',1,2)call SaveInteger(i9,'h03R',1,2)call SaveInteger(i9,'h02Z',1,2)call SaveInteger(i9,'h030',1,2)call SaveInteger(i9,'h099',1,2)call SaveInteger(i9,'h06S',1,2)call SaveInteger(i9,'h06T',1,2)call SaveInteger(i9,'h098',1,2)call SaveInteger(i9,'n01E',1,2)call SaveInteger(i9,'n01F',1,2)call SaveInteger(i9,'e005',1,2)call SaveInteger(i9,'e002',1,2)call SaveInteger(i9,'n007',1,2)call SaveInteger(i9,'n01Y',1,2)call SaveInteger(i9,'hrif',1,4)call SaveInteger(i9,'h02A',1,4)call SaveInteger(i9,'h05C',1,4)call SaveInteger(i9,'h016',1,4)call SaveInteger(i9,'o00C',1,4)call SaveInteger(i9,'o00D',1,4)call SaveInteger(i9,'o00E',1,4)call SaveInteger(i9,'o001',1,4)call SaveInteger(i9,'n00V',1,4)call SaveInteger(i9,'n01O',1,4)call SaveInteger(i9,'h04I',1,4)call SaveInteger(i9,'n01B',1,4)call SaveInteger(i9,'n01D',1,4)call SaveInteger(i9,'h00U',1,4)call SaveInteger(i9,'e006',1,4)call SaveInteger(i9,'e009',1,4)call SaveInteger(i9,'e00C',1,4)call SaveInteger(i9,'n01P',1,4)call SaveInteger(i9,'n01Q',1,4)call SaveInteger(i9,'n01R',1,4)call SaveInteger(i9,'n004',1,4)call SaveInteger(i9,'hmtm',1,6)call SaveInteger(i9,'n005',1,6)call SaveInteger(i9,'o009',1,6)call SaveInteger(i9,'o003',1,6)call SaveInteger(i9,'u005',1,6)call SaveInteger(i9,'u009',1,6)call SaveInteger(i9,'u00D',1,6)call SaveInteger(i9,'e007',1,6)call SaveInteger(i9,'e00J',1,6)call SaveInteger(i9,'h07B',1,6)call SaveInteger(i9,'h00W',1,6)call SaveInteger(i9,'n022',1,6)call SaveInteger(i9,'n023',1,6)call SaveInteger(i9,'n014',1,6)call SaveInteger(i9,'n00S',1,6)endfunctionfunction rr takes integer oi,unit u returns nothingcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Fq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Gq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Hq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Iq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifendfunctionfunction sr takes integer oi,unit u returns nothingcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function lq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Jq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Kq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifendfunctionfunction tr takes integer oi,unit u returns nothingcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Lq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Mq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Nq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Oq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Pq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Qq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Rq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Sq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Tq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Uq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Vq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Wq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifendfunctionfunction ur takes integer oi,unit u returns nothingcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Xq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Yq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function Zq))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function dr))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function er))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function fr))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function gr))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function hr))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function ir))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function jr))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function kr))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function mr))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifendfunctionfunction vr takes integer oi,unit u returns nothinglocal unit t
call co((e9),((GetUnitX(u))*1.),((GetUnitY(u))*1.),((700.)*1.))call Co()set t=Oo(r9,j9,n9,0)
if(t!=null)thencall IssueTargetOrderById(u,$D000F,t)set t=nullreturnendifcall Co()set t=Oo(r9,n9,0,0)if(t!=null)thencall IssueTargetOrderById(u,$D000F,t)set t=nullreturnendifcall Co()set t=Oo(w9,j9,n9,0)
if(t!=null)thencall IssueTargetOrderById(u,$D000F,t)set t=nullreturnendifcall Co()set t=Oo(w9,n9,0,0)if(t!=null)thencall IssueTargetOrderById(u,$D000F,t)set t=nullreturnendifcall Co()set t=Oo(t9,j9,n9,0)
if(t!=null)thencall IssueTargetOrderById(u,$D000F,t)set t=nullreturnendifcall Co()set t=Oo(t9,n9,0,0)if(t!=null)thencall IssueTargetOrderById(u,$D000F,t)set t=nullreturnendifendfunctionfunction wr takes integer oi,unit u returns nothingcall GroupEnumUnitsInRange(h9,GetUnitX(u),GetUnitY(u),700.,Condition(function nr))if FirstOfGroup(h9)!=null thencall IssueTargetOrderById(u,$D000F,FirstOfGroup(h9))
returnendifendfunctionfunction xr takes integer oi,unit u returns nothinglocal integer id=LoadInteger(i9,GetUnitTypeId(u),0)if id==1 thenelseif id==2 thencall rr(oi,u)elseif id==3 thencall sr(oi,u)elseif id==4 thencall tr(oi,u)elseif id==5 thencall ur(oi,u)elseif id==6 thencall vr(oi,u)elseif id==0 thencall wr(oi,u)endifendfunctionfunction yr takes unit u returns nothing
set e9=GetOwningPlayer(u)if IsUnitType(u,UNIT_TYPE_MELEE_ATTACKER)thencall Eq(f9,u)else
call xr(g9,u)endifcall GroupClear(h9)endfunctionfunction zr takes nothing returns nothingset h9=CreateGroup()
set f9=si()set g9=ri()call zq(f9)call qr(g9)set j9=Fi()set k9=Ei()set m9=Di()set n9=ci()set o9=Ci()set p9=Bi()set q9=Ai()set r9=zi()set s9=yi()set t9=xi()set u9=wi()set v9=ui()set w9=Ji()endfunctionfunction Ar takes unit u,real r returns nothinglocal integer ar=20+R2I((r-500.)/ 50)local real x=GetUnitX(u)
local real y=GetUnitY(u)
local integer i=0local string Br=""local real anlocal effect array e
if(GetOwningPlayer(u)==GetLocalPlayer())then
set Br="Abilities\\Spells\\NightElf\\Barkskin\\BarkSkinTarget.mdl"endifloop
exitwhen i>=arset an=2.*bj_PI*i/ arset e[i]=AddSpecialEffect("Abilities\\Spells\\NightElf\\Barkskin\\BarkSkinTarget.mdl",x+r*Cos(an),y+r*Sin(an))set i=i+1endloopcall TriggerSleepAction(6.)set i=0loop
exitwhen i>=arcall DestroyEffect(e[i])
set e[i]=nullset i=i+1endloopendfunctionfunction br takes unit u returns nothing
call IssuePointOrderByIdLoc(u,$D0012,Id[me[GetPlayerId(GetOwningPlayer(u))]+2])endfunctionfunction Cr takes nothing returns booleanlocal unit u=GetFilterUnit()
local boolean Im=GetWidgetLife(u)>.405 and IsUnitEnemy(u,r4)and IsUnitType(u,UNIT_TYPE_SAPPER)and IsUnitType(u,UNIT_TYPE_GROUND)and GetUnitAbilityLevel(u,'Avul')<=0 and GetUnitAbilityLevel(u,'A08H')<=0set u=nullreturn Imendfunctionfunction cr takes unit u,integer Dr returns nothinglocal player p=GetOwningPlayer(u)local integer dk=GetPlayerId(p)if(ad>0)then
if(he[dk]+Dr>=ad)thenset Dr=ad-he[dk]
if(Dr<=0)thenreturnendifset he[dk]=adelse
set he[dk]=he[dk]+(Dr)endifendifcall AdjustPlayerStateBJ(Dr,p,PLAYER_STATE_RESOURCE_LUMBER)set bj_lastCreatedTextTag=CreateTextTag()call SetTextTagText(bj_lastCreatedTextTag,I2S(Dr),.024)call SetTextTagPos(bj_lastCreatedTextTag,GetUnitX(u)-36.,GetUnitY(u)-16.,.0)
call SetTextTagColor(bj_lastCreatedTextTag,0,$C8,80,$FF)
call SetTextTagPermanent(bj_lastCreatedTextTag,false)call SetTextTagLifespan(bj_lastCreatedTextTag,3.)call SetTextTagFadepoint(bj_lastCreatedTextTag,1.)call SetTextTagVelocity(bj_lastCreatedTextTag,0,.06)
if(p!=GetLocalPlayer())thencall SetTextTagVisibility(bj_lastCreatedTextTag,false)else
call SetTextTagVisibility(bj_lastCreatedTextTag,true)endifendfunctionfunction Er takes unit u returns nothing
local integer i=GetUnitAbilityLevel(u,'A09L')if(i==2)then
call SetUnitAbilityLevel(u,'A09L',1)
call SetUnitState(u,UNIT_STATE_MANA,GetUnitState(u,UNIT_STATE_MANA)+100.)call UnitAddAbility(u,'A09M')call SetUnitAbilityLevel(u,'A09M',3)
call UnitRemoveAbility(u,'A09M')
call SetUnitState(u,UNIT_STATE_LIFE,GetWidgetLife(u)+200.)else
call UnitRemoveAbility(u,'A09L')
endifcall DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Items\\AIvi\\AIviTarget.mdl",u,"origin"))endfunctionfunction Fr takes unit u returns nothing
local integer i=GetUnitAbilityLevel(u,'A09C')+1if(i>=6)then
returnendifcall SetUnitAbilityLevel(u,'A09C',i)
call SetUnitAbilityLevel(u,'A09B',i)
call SetUnitAbilityLevel(u,'A00J',i)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\Avatar\\AvatarCaster.mdl",u,"origin"))endfunctionfunction Gr takes unit u returns boolean
if(GetUnitAbilityLevel(u,'A09L')>0)thencall Er(u)return trueelseif(GetUnitTypeId(u)=='n01T')then
if(GetRandomInt(0,99)<60)thencall Fr(u)return trueelse
return false
endifendifreturn GetUnitAbilityLevel(u,'A070')>0endfunctionfunction Hr takes unit u returns boolean
if(Gr(u))thencall DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\DispelMagic\\DispelMagicTarget.mdl",u,"origin"))return trueendifreturn false
endfunctionfunction Ir takes nothing returns booleanlocal unit u=GetFilterUnit()
local boolean Im=GetWidgetLife(u)>.405 and IsUnitEnemy(u,r4)and IsUnitType(u,UNIT_TYPE_SAPPER)and GetUnitAbilityLevel(u,'Avul')<=0 and GetUnitAbilityLevel(u,'A08H')<=0set u=nullreturn Imendfunctionfunction lr takes nothing returns nothingcall Lo(GetEnumUnit())endfunctionfunction Jr takes nothing returns nothingcall ForGroup(z9,function lr)endfunctionfunction Kr takes nothing returns booleanlocal unit u=GetFilterUnit()
local boolean Im=GetWidgetLife(u)>.405 and GetUnitCurrentOrder(u)==0 and IsUnitType(u,UNIT_TYPE_SAPPER)and GetUnitAbilityLevel(u,'A07I')<=0 and GetUnitAbilityLevel(u,'A07M')<=0
set u=nullreturn Imendfunctionfunction Lr takes nothing returns nothingcall Po(GetEnumUnit())endfunctionfunction Mr takes nothing returns nothingcall GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,A9)call ForGroup(q4,function Lr)endfunctionfunction Nr takes nothing returns nothinglocal boolean Pr=falselocal integer i=0loop
if(Pd[i]=='h089' or Pd[i]=='h06P')thenset Pr=trueendifset i=i+1exitwhen i>$B or Prendloopif(Pr)thencall TimerStart(a9,2.,true,function Jr)endifendfunctionfunction Functions_CheckAndStartCommon takes nothing returns nothing
call TimerStart(B9,4.,true,function Mr)endfunctionfunction Qr takes nothing returns booleanlocal unit u=GetFilterUnit()
local boolean Im=GetWidgetLife(u)>.405 and IsUnitType(u,UNIT_TYPE_PEON)set u=nullreturn Imendfunctionfunction Rr takes nothing returns nothingcall SetUnitAnimation(GetEnumUnit(),"stand")
endfunctionfunction Sr takes unit u,unit Tr returns nothing
local player p=GetOwningPlayer(Tr)local integer dk=GetPlayerId(p)local boolean Ur=GetUnitAbilityLevel(Tr,'B01K')>0if(GetUnitAbilityLevel(u,'A0DZ')>0)thencall IssueImmediateOrderById(u,$D02BB)call UnitApplyTimedLife(u,'BTLF',1.)
set u=GetSummonedUnit()if(u==null)thenreturnendifendifif(Ur)thencall UnitAddAbility(u,'A09M')call SetUnitAbilityLevel(u,'A09M',3)
call UnitRemoveAbility(u,'A09M')
call UnitAddAbility(u,'A09Q')call UnitAddAbility(u,'A09R')endifif(GetUnitAbilityLevel(Tr,'A0EL')>0 and GetRandomInt(0,99)<30)thencall UnitAddAbility(u,'A0EZ')call UnitAddAbility(u,'A0C5')endifcall Vo(u)set Rd[dk]=Rd[dk]+1if(GetUnitAbilityLevel(u,'A07M')>=1)then
call Mo(u)call GroupAddUnit(z9,u)endifendfunctionfunction Vr takes nothing returns nothinglocal unit u=GetEnumUnit()set bj_forLoopAIndex=bj_forLoopAIndex+1if(bj_forLoopAIndex<=2 and GetRandomInt(0,99)<17)thencall Sr(CreateUnit(GetOwningPlayer(u),GetUnitTypeId(bj_lastCreatedUnit),GetUnitX(bj_lastCreatedUnit),GetUnitY(bj_lastCreatedUnit),.0),bj_lastLoadedUnit)
if(GetUnitAbilityLevel(bj_lastCreatedUnit,'A09H')>0)then
call Sr(CreateUnit(GetOwningPlayer(u),GetUnitTypeId(bj_lastCreatedUnit),GetUnitX(bj_lastCreatedUnit),GetUnitY(bj_lastCreatedUnit),.0),bj_lastLoadedUnit)
endifendifset u=nullendfunctionfunction Wr takes unit u,unit Tr returns nothing
local player p=GetOwningPlayer(Tr)local integer dk=GetPlayerId(p)local boolean Ur=GetUnitAbilityLevel(Tr,'B01K')>0if(GetUnitAbilityLevel(u,'A0DZ')>0)thencall ShowUnit(u,false)call IssueImmediateOrderById(u,$D02BB)call UnitApplyTimedLife(u,'BTLF',1.)
endifif(Ur)thencall UnitAddAbility(u,'A09M')call SetUnitAbilityLevel(u,'A09M',3)
call UnitRemoveAbility(u,'A09M')
call UnitAddAbility(u,'A09Q')call UnitAddAbility(u,'A09R')endifcall Vo(u)set Rd[dk]=Rd[dk]+1if(GetUnitAbilityLevel(u,'A07M')>=1)then
call Mo(u)call GroupAddUnit(z9,u)elseif(GetUnitAbilityLevel(u,'A09H')>0)thencall Sr(CreateUnit(p,GetUnitTypeId(u),GetUnitX(u),GetUnitY(u),.0),Tr)endifif(GetUnitAbilityLevel(u,'A070')<=0)then
set bj_lastCreatedUnit=u
set bj_lastLoadedUnit=Tr
set bj_forLoopAIndex=0call ForGroup(Jd[me[dk]],function Vr)endifendfunctionfunction Xr takes nothing returns nothingset y9=Filter(function Ir)set A9=Filter(function Kr)set x9=Filter(function Cr)set b9=Filter(function Qr)endfunctionfunction Yr takes integer x,integer y,string lb returns nothinglocal integer i=0loop
if(D9[i]!=null)thenset J9=MultiboardGetItem(D9[i],y,x)call MultiboardSetItemValue(J9,lb)call MultiboardReleaseItem(J9)endifset i=i+1exitwhen i>$Bendloopif(x==1)then
set J9=MultiboardGetItem(G9,1,(y-1)*6+1)
call MultiboardSetItemValue(J9,lb)call MultiboardReleaseItem(J9)elseif(x>2 and x<5)thenset J9=MultiboardGetItem(G9,1,(y-1)*6+x-1)call MultiboardSetItemValue(J9,lb)call MultiboardReleaseItem(J9)elseif(x==5)then
set J9=MultiboardGetItem(G9,I9,$A)call MultiboardSetItemValue(J9,lb)call MultiboardReleaseItem(J9)endifendfunctionfunction Zr takes integer x,integer y,string lb returns nothingset J9=MultiboardGetItem(G9,x,y)
call MultiboardSetItemValue(J9,lb)call MultiboardReleaseItem(J9)endfunctionfunction ds takes nothing returns string
local string s=I2S(N9)if(N9<$A)thenset s="0"+sendifreturn"|cffFFFF00"+I2S(M9)+"|cffFF8000:|cffFFFF00"+s+"|r"endfunctionfunction es takes nothing returns nothingset N9=N9+1if(N9==60)thenset N9=0
set M9=M9+1endifcall Yr(5,3,ds())endfunctionfunction fs takes nothing returns booleanlocal integer pl=CountPlayersInForceBJ(ie)local integer pr=CountPlayersInForceBJ(je)local integer pq=CountPlayersInForceBJ(ke)local integer pc=pl+prlocal integer gs=IntegerTertiaryOp(Bd>0,2*Bd,-Bd)if(bd>0 and pc*bd>l7-gs)then
return false
endifif(pc>l7-gs)then
return false
endifif(pc*(bd-1)>pq)then
return false
endifif(pc>l7 and td)then
return false
endifif(Dd>0 and tn(IMaxBJ(pl,pr)*Dd,IMinBJ(pl,pr))*2>pq+pc)thenreturn false
endifreturn trueendfunctionfunction hs takes boolean fl returns nothing
set zd=flcall zr()call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00AI|r enabled. Units will choose targets by its armor type.")
endfunctionfunction is takes boolean fl returns nothing
set md=not flif(fl)thencall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Artillery|r enabled. You can build structures that attack enemy structures.")set df='n01C'set zf='A07T'set We='A01I'set vf='A0BD'set x8='A0D1'set y8='A0D0'set z8='A0E3'else
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00No Artillery|r has been chosen. You cannot build structures that attack enemy structures.")set df='n021'set zf='A08T'set We='A05H'set vf='A0BQ'set x8='A0D2'set y8='A0D3'set z8='A0E4'endifset bj_forLoopAIndex=0set bj_forLoopAIndexEnd=$Bloop
exitwhen bj_forLoopAIndex>bj_forLoopAIndexEndcall SetPlayerUnitAvailableBJ('h001',fl,Player(bj_forLoopAIndex))call SetPlayerUnitAvailableBJ('h048',fl,Player(bj_forLoopAIndex))call SetPlayerUnitAvailableBJ('h01E',fl,Player(bj_forLoopAIndex))set bj_forLoopAIndex=bj_forLoopAIndex+1endloopendfunctionfunction js takes boolean fl returns nothing
set xd=flif(not fl)thencall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00No AFK|r mode has been disabled. Command -afk enabled.")
else
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00No AFK|r has been chosen. Command -afk disabled.")endifendfunctionfunction ks takes nothing returns nothingset Cd=1
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Coin|r has been chosen. There will be a coin spawn every 40 seconds.")endfunctionfunction ms takes nothing returns nothingset Cd=$Acall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Crazy Coins|r has been chosen. Ten coins will spawn every 40 seconds.")endfunctionfunction ns takes boolean fl returns nothing
set kd=flif(not fl)thencall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Dual Race|r mode has been disabled.")else
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Dual Race|r has been chosen. Each race can be chosen more than once per team.")endifendfunctionfunction os takes boolean fl returns nothing
set td=flif(fl)thencall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Unique Races|r has been chosen. Each race can be chosen only once (even across the teams).")
if((CountPlayersInForceBJ(ie)+CountPlayersInForceBJ(je))+Bd*2>$A)thenset td=false
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Unique Races|r mode has been disabled due so many players.")
endifelse
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Unique Races|r mode has been disabled.")
endifendfunctionfunction ps takes boolean fl returns nothing
set nd=flif(fl)thencall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00No Treasure Box|r mode has been disabled.")else
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00No Treasure Box|r has been chosen. You cannot build Treasure Boxes.")endifset bj_forLoopAIndex=0set bj_forLoopAIndexEnd=$Bloop
exitwhen bj_forLoopAIndex>bj_forLoopAIndexEndcall SetPlayerUnitAvailableBJ('h008',fl,Player(bj_forLoopAIndex))set bj_forLoopAIndex=bj_forLoopAIndex+1endloopendfunctionfunction qs takes boolean fl returns nothing
set od=flif(fl)thencall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00No Bounty|r mode has been disabled.")else
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00No Bounty|r has been chosen. Neither units nor buildings will give bounty when destroyed.")endifset bj_forLoopAIndex=0set bj_forLoopAIndexEnd=$Bloop
exitwhen bj_forLoopAIndex>bj_forLoopAIndexEndcall SetPlayerFlagBJ(PLAYER_STATE_GIVES_BOUNTY,fl,Player(bj_forLoopAIndex))set bj_forLoopAIndex=bj_forLoopAIndex+1endloopendfunctionfunction rs takes boolean fl returns nothing
set pd=flif(fl)thencall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00No Specials|r mode has been disabled.")else
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00No Specials|r has been chosen. You can't build special buildings except towers and Treasure Boxes.")
endifset bj_forLoopAIndex=0set bj_forLoopAIndexEnd=$Bloop
exitwhen bj_forLoopAIndex>bj_forLoopAIndexEndcall SetPlayerUnitAvailableBJ('h01P',fl,Player(bj_forLoopAIndex))call SetPlayerUnitAvailableBJ('h056',fl,Player(bj_forLoopAIndex))call SetPlayerUnitAvailableBJ('h014',fl,Player(bj_forLoopAIndex))call SetPlayerUnitAvailableBJ('h03Q',fl,Player(bj_forLoopAIndex))call SetPlayerUnitAvailableBJ('h01O',fl,Player(bj_forLoopAIndex))call SetPlayerUnitAvailableBJ('o000',fl,Player(bj_forLoopAIndex))call SetPlayerUnitAvailableBJ('h006',fl,Player(bj_forLoopAIndex))call SetPlayerUnitAvailableBJ('n01J',fl,Player(bj_forLoopAIndex))call SetPlayerUnitAvailableBJ('h073',fl,Player(bj_forLoopAIndex))call SetPlayerUnitAvailableBJ('h05L',fl,Player(bj_forLoopAIndex))set bj_forLoopAIndex=bj_forLoopAIndex+1endloopendfunctionfunction ss takes boolean fl returns nothing
set qd=flif(fl)thencall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00No Items|r mode has been disabled.")
else
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00No Items|r has been chosen. The castle doesn't sell any items.")
endifendfunctionfunction ts takes boolean fl returns nothing
set rd=flif(fl)thencall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00No Legendaries|r mode has been disabled.")else
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00No Legendaries|r has been chosen. You don't get food to buy legendary buildings.")endifendfunctionfunction us takes boolean fl returns nothing
set sd=flif(fl)thencall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00No Rescue Strike|r mode has been disabled.")
else
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00No Rescue Strike|r has been chosen. Your worker doesn't have a Rescue Strike!")endifendfunctionfunction vs takes integer ws returns nothing
if(ws<$96)thenset ad=-1call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Lumber Limit|r mode has been disabled.")
else
set ad=wscall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Lumber Limit|r has been set to |cffFFFF00"+I2S(ad)+"|r.")endifendfunctionfunction xs takes integer ws returns nothing
set hd=IMaxBJ(IMinBJ(ws,'x'),2)call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Income Timer|r has been set to |cffFFFF00"+I2S(hd)+"|r.")endfunctionfunction ys takes integer zs returns nothing
set Ad=zsif(Ad==1)thenset kf=1000.
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00No Taxes|r has been chosen. You don't have to pay taxes on your income.")elseif(Ad==2)thenset kf=12.5call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00High Taxes|r has been chosen. Tax rate increases 10% every 12.5 income.")endifendfunctionfunction As takes boolean fl returns nothing
set ud=flif(fl)thencall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Caging|r mode has been disabled.")else
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Caging|r has been chosen. You can trap units with your buildings")endifendfunctionfunction as takes boolean fl returns nothing
set vd=flif(fl)thencall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Domination|r has been chosen. You gain extra income by controlling the lanes.")else
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"TODO::SetDOMStatus(false)")endifendfunctionfunction Bs takes integer zs returns nothing
if(zs>2)then
call DisplayTextToPlayer(Player(0),.0,.0,"|cffFF0000Wrong Autobalance variation!|r")
returnendifset fd=zsif(zs==0)thencall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Autobalance|r has been setted to |cffFFFF000|r. All units of any left player will be divided between members in team.")elseif(zs==1)thencall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Autobalance|r has been setted to |cffFFFF001|r. All depended players of any left player will be shared between members in team.")else
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Autobalance|r has been setted to |cffFFFF001|r. AI will take control of any left player.")endifendfunctionfunction bs takes integer zs returns nothing
if(zs==0)thenset Bd=-1else
set Bd=-zsendifif(not fs())then
call DisplayTextToPlayer(Player(0),.0,.0,"|cffFF0000Too many players for Random Ban Race mode!|r")set Bd=0
returnendifcall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Random Ban Race|r has been chosen. Number of bans: |cffFFFF00"+I2S(IAbsBJ(Bd))+"|r.")endfunctionfunction Cs takes integer zs returns nothing
if(zs==0)thenset Bd=1
else
set Bd=zsendifif(not fs())then
call DisplayTextToPlayer(Player(0),.0,.0,"|cffFF0000Too many players for Ban Race mode!|r")set Bd=0
returnendifcall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Ban Race|r has been chosen. Number of bans per team: |cffFFFF00"+I2S(Bd)+"|r.")endfunctionfunction cs takes integer zs returns nothing
if(zs==0)thenset Dd=1
else
set Dd=zsendifset bd=0
if(not fs())then
call DisplayTextToPlayer(Player(0),.0,.0,"|cffFF0000Too many players for Extended Multi Race mode!|r")set Dd=0
returnendifset fd=1
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Extended Multiple Players|r has been chosen. Parameter's value is: |cffFFFF00"+I2S(Dd)+"|r.")endfunctionfunction Ds takes integer zs returns nothing
if(zs<1 or zs>5)then
call DisplayTextToPlayer(Player(0),.0,.0,"|cffFF0000Wrong number of players per player! Must be between 2 and 4!|r")
returnendifset Dd=0
set bd=zsif(not fs())then
call DisplayTextToPlayer(Player(0),.0,.0,"|cffFF0000Too many players for Multi Race mode!|r")set bd=0
returnendifset fd=1
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Multiple Players|r has been chosen. Number of additional players per human player: |cffFFFF00"+I2S(zs)+"|r")
endfunctionfunction Es takes boolean fl returns nothing
set wd=flif(fl)thencall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Stop-detection|r system has been activated. Any player will be detected on bug usage.")else
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"TODO::SetSDStatus(false)")
endifendfunctionfunction Fs takes boolean fl returns nothing
set yd=flif(fl)thencall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Debuging|r is on.")else
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Debuging|r is off.")
endifendfunctionfunction Gs takes integer yj returns nothing
if(IAbsBJ(yj)>5)then
set cd=yjif(yj>0)then
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Round time limit for win|r has been activated. Round will automatically end after "+I2S(IAbsBJ(yj))+" minutes and owner of first building will win.")else
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Round time limit for draw|r has been activated. Round will automatically end after "+I2S(IAbsBJ(yj))+" minutes with draw result.")endifelse
call DisplayTextToPlayer(Player(0),.0,.0,"|cffFF0000Wrong value of minutes for round time limitation! Must be more 5!|r")endifendfunctionfunction Hs takes integer yj returns nothing
local integer p=l7if(yj==0)thenset yj=1
endifset l7=l7-yj
if(not fs())then
call DisplayTextToPlayer(Player(0),.0,.0,"|cffFF0000Not possible to disable so many races!|r")set l7=p
returnendifset Ed=yjcall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00System-races-pool|r has been changed. There are |cffFFFF00"+I2S(yj)+"|r new races have been removed.|r")
endfunctionfunction Is takes nothing returns nothinglocal integer i=0local integer jlocal player plocal unit u
loop
exitwhen i>$Bset j=1set p=Player(i)loop
set u=CreateUnitAtLoc(p,'tec0'+j,R9,.0)call ShowUnit(u,false)set j=j+1exitwhen j>3
endloopset i=i+1endloopendfunctionfunction ls takes integer i returns nothingset ge[i]=0set mf[i]=.0
set Rd[i]=-1
set Sd[i]=-1
set Td[i]=-1
set Ud[i]=-1
set Vd[i]=-1
set Wd[i]=-1
set Xd[i]=-1
set Yd[i]=-1
set Zd[i]=-1
set de[i]=-1
set ee[i]=-1
set fe[i]=-1
set he[i]=0endfunctionfunction Js takes integer i returns nothingset ge[i]=0set mf[i]=.5
set Rd[i]=0set Sd[i]=0set Td[i]=0set Ud[i]=0set Vd[i]=0set Wd[i]=0set Xd[i]=0set Yd[i]=0set Zd[i]=0set de[i]=0set ee[i]=0set fe[i]=0set he[i]='}'endfunctionfunction Ks takes integer dk returns stringlocal playercolor pc=GetPlayerColor(Player(dk))local string Imif(pc==PLAYER_COLOR_RED)then
set Im="|cffff0000"elseif(pc==PLAYER_COLOR_BLUE)thenset Im="|cff0000FF"elseif(pc==PLAYER_COLOR_CYAN)thenset Im="|cff00FFFF"elseif(pc==PLAYER_COLOR_PURPLE)thenset Im="|cff800080"elseif(pc==PLAYER_COLOR_YELLOW)thenset Im="|cffFFFF00"elseif(pc==PLAYER_COLOR_ORANGE)thenset Im="|cffFFCC00"elseif(pc==PLAYER_COLOR_GREEN)thenset Im="|cff00ff00"elseif(pc==PLAYER_COLOR_PINK)thenset Im="|cffff00ff"elseif(pc==PLAYER_COLOR_LIGHT_GRAY)thenset Im="|cffc0c0c0"elseif(pc==PLAYER_COLOR_LIGHT_BLUE)thenset Im="|cffCCFFFF"elseif(pc==PLAYER_COLOR_AQUA)thenset Im="|cff087329"elseif(pc==PLAYER_COLOR_BROWN)thenset Im="|cffC16D00"else
set Im="|CFFFFFFFF"endifset pc=nullreturn Imendfunctionfunction Ls takes integer dk returns nothing
set pe[dk]=Ks(dk)+GetPlayerName(Player(dk))+"|r"
endfunctionfunction Ms takes nothing returns nothinglocal player p=GetEnumPlayer()local integer i=GetPlayerId(p)call ForceRemovePlayer(ie,p)
call ForceRemovePlayer(je,p)
call ForceAddPlayer(ke,p)set E9[i]=nullendfunctionfunction Ns takes nothing returns nothinglocal integer i=0local integer jlocal player plocal boolean Os
loop
if(ne[i]!=null)thencall ForForce(ne[i],function Ms)
call SetPlayerName(Player(i),l9[i])endifset i=i+1exitwhen i>$Bendloopset i=0loop
if(ne[i]!=null)thenset Os=IsPlayerInForce(Player(i),ie)
set j=1loop
set p=zn(Os)
call ForceRemovePlayer(ke,p)
call ForceAddPlayer(ne[i],p)
if(Os)thencall ForceAddPlayer(ie,p)set Qd[GetPlayerId(p)]=PolarProjectionBJ(Qd[i],96.*j,.0)
else
call ForceAddPlayer(je,p)set Qd[GetPlayerId(p)]=PolarProjectionBJ(Qd[i],96.*j,180.)endifcall SetPlayerName(p,l9[i])set pe[GetPlayerId(p)]=Ks(GetPlayerId(p))+GetPlayerName(p)+"|r"set me[GetPlayerId(p)]=me[i]
set j=j+1exitwhen j>=bdendloopendifset i=i+1exitwhen i>$Bendloopendfunctionfunction Ps takes nothing returns nothinglocal integer pl=CountPlayersInForceBJ(ie)local integer pr=CountPlayersInForceBJ(je)local integer Qs=tn(IMaxBJ(pl,pr)*Dd,IMinBJ(pl,pr))local integer Rs=Qs/ pllocal integer Ss=Qs/ prlocal integer i=0local integer jlocal integer llocal player plocal boolean Os
loop
if(ne[i]!=null)thencall ForForce(ne[i],function Ms)
call SetPlayerName(Player(i),l9[i])endifset i=i+1exitwhen i>$Bendloopset i=0loop
if(ne[i]!=null)thenset Os=IsPlayerInForce(Player(i),ie)
set l=IntegerTertiaryOp(Os,Rs,Ss)set j=1loop
exitwhen j>=lset p=zn(Os)
call ForceRemovePlayer(ke,p)
call ForceAddPlayer(ne[i],p)
if(Os)thencall ForceAddPlayer(ie,p)set Qd[GetPlayerId(p)]=PolarProjectionBJ(Qd[i],96.*j,.0)
else
call ForceAddPlayer(je,p)set Qd[GetPlayerId(p)]=PolarProjectionBJ(Qd[i],96.*j,180.)endifcall SetPlayerName(p,l9[i])set pe[GetPlayerId(p)]=Ks(GetPlayerId(p))+GetPlayerName(p)+"|r"set me[GetPlayerId(p)]=me[i]
set j=j+1endloopendifset i=i+1exitwhen i>$Bendloopendfunctionfunction Ts takes nothing returns nothingif(Dd>0)then
call Ps()returnelseif(bd>0)then
call Ns()returnendifcall DisplayTimedTextToPlayer(GetLocalPlayer(),.0,.0,60.,"Unknown exception at module Main::SunAMP. Please report.")
endfunctionfunction Us takes nothing returns nothinglocal integer i=0local player p=Player($C)set C9=GetWorldBounds()set Q9=Rect(-288.,3296.,-96.,3488.)loop
set me[i]=0if(GetPlayerSlotState(Player(i))==PLAYER_SLOT_STATE_PLAYING)then
call ForceAddPlayer(ie,Player(i))call CreateFogModifierRectBJ(true,Player(i),FOG_OF_WAR_VISIBLE,Q9)set Qd[i]=dn(true)set ne[i]=CreateForce()set l9[i]=GetPlayerName(Player(i))elseif(GetPlayerSlotState(Player(i))==PLAYER_SLOT_STATE_EMPTY)thencall ForceAddPlayer(ke,Player(i))endifset me[i+6]=1if(GetPlayerSlotState(Player(i+6))==PLAYER_SLOT_STATE_PLAYING)thencall ForceAddPlayer(je,Player(i+6))call CreateFogModifierRectBJ(true,Player(i+6),FOG_OF_WAR_VISIBLE,Q9)
set Qd[i+6]=dn(false)set ne[i+6]=CreateForce()set l9[i+6]=GetPlayerName(Player(i+6))elseif(GetPlayerSlotState(Player(i+6))==PLAYER_SLOT_STATE_EMPTY)then
call ForceAddPlayer(ke,Player(i+6))endifset i=i+1exitwhen i>=6endloopset R9=Location(-192.,3392.)
set Id[0]=GetRectCenter(Fg)set Id[1]=GetRectCenter(Eg)set Id[2]=GetRectCenter(Eg)set Id[3]=GetRectCenter(Fg)set Ld[0]=Dg
set Ld[1]=cg
set Od[0]="|cffff0303Western Forces|r"set Jd[0]=CreateGroup()set Od[1]="|cff20c000Eastern Forces|r"set Jd[1]=CreateGroup()set i=0loop
call GroupAddUnit(P9,CreateUnit(p,'h00L',-192.,3392.,270.))set i=i+1exitwhen i>33endloopset p=Player($F)
call CreateUnit(p,'h00L',-192.,3392.,270.)call CreateUnit(p,'nshp',320.,1856.,270.)call SetUnitColor(CreateUnit(p,'nmrk',-256.,-2816.,270.),ConvertPlayerColor(0))call CreateUnit(p,'nder',-4735.4,3246.1,109.526)
call CreateUnit(p,'nfro',-1091.1,2532.8,224.842)
call CreateUnit(p,'nfro',-1750.8,3170.3,12.503)call CreateUnit(p,'nfro',-4208.5,-3103.9,62.844)
call CreateUnit(p,'nrac',3575.1,-3410.6,28.565)call CreateUnit(p,'nrac',215.3,-2989.1,39.991)call CreateUnit(p,'nder',-734.9,-2927.2,354.77)call CreateUnit(p,'nder',-778.4,3161.3,100.297)call CreateUnit(p,'nder',486.3,3092.6,147.507)call CreateUnit(p,'nder',2097.6,2634.9,173.293)call CreateUnit(p,'necr',2734.8,2968.,320.909)call CreateUnit(p,'necr',-601.3,1917.2,359.418)call CreateUnit(p,'necr',-2505.3,3205.6,108.405)
call CreateUnit(p,'necr',-2553.8,3097.9,314.669)
call CreateUnit(p,'nfro',4466.5,3139.7,42.463)call CreateUnit(p,'nfro',539.6,2646.5,108.054)call CreateUnit(p,'necr',-5469.2,2773.2,240.63)call CreateUnit(p,'nrac',-3882.6,3455.9,171.348)
call CreateUnit(p,'necr',-2951.9,3480.5,75.248)call CreateUnit(p,'nder',-1995.2,3031.8,320.569)
call CreateUnit(p,'nder',-4755.9,-3285.9,96.265)
call CreateUnit(p,'necr',-2813.4,-3182.2,270.799)call CreateUnit(p,'nrac',-2009.7,-3134.2,263.79)
call CreateUnit(p,'nder',5212.3,-3150.6,44.199)call CreateUnit(p,'nfro',4753.5,-3152.8,349.596)
call CreateUnit(p,'nrac',-10.6,3013.2,169.052)call CreateUnit(p,'ndwm',1689.8,-2774.7,192.19)call CreateUnit(p,'ndog',-3610.9,-3243.8,118.216)call CreateUnit(p,'ndog',1334.7,2849.5,136.344)call CreateUnit(p,'ndog',3868.8,3221.9,302.375)call CreateUnit(p,'nshe',-5537.3,3457.1,52.22)call CreateUnit(p,'nsno',824.5,3262.9,175.677)call CreateUnit(p,'nsno',202.1,-2945.4,216.679)call CreateUnit(p,'npnw',745.5,2441.4,238.74)call CreateUnit(p,'npnw',-1503.3,3397.6,70.468)call CreateUnit(p,'nhmc',-1045.4,2540.1,279.314)
call CreateUnit(p,'nskk',-1729.,3470.5,317.767)call CreateUnit(p,'nskk',-2433.4,2555.1,311.109)
call CreateUnit(p,'nskk',3859.9,-3350.3,329.995)
call CreateUnit(p,'ncrb',4721.1,-3370.7,285.192)
call CreateUnit(p,'nalb',4473.6,-3164.3,324.601)
call CreateUnit(p,'nhmc',4158.9,-3098.4,273.93)call Is()set bj_forLoopAIndex=0set bj_forLoopAIndexEnd=$Bloop
exitwhen bj_forLoopAIndex>bj_forLoopAIndexEndcall SetPlayerFlagBJ(PLAYER_STATE_GIVES_BOUNTY,true,Player(bj_forLoopAIndex))set pe[bj_forLoopAIndex]=Ks(bj_forLoopAIndex)+GetPlayerName(Player(bj_forLoopAIndex))+"|r"set Gd[bj_forLoopAIndex]=trueset bj_forLoopAIndex=bj_forLoopAIndex+1endloopcall SetMapFlag(MAP_LOCK_RESOURCE_TRADING,true)call FogMaskEnable(false)call FogEnable(false)call CreateQuestBJ(0,"Game Modes","Gamemodes are entered by the red player in the first 20 seconds of game time.
A gamemode consists of a dash followed by two characters and a number:

The first character determines the race distribution.
|cffFFFF00p :|r pick race
|cffFFFF00d :|r draft race
|cffFFFF00r :|r random race
|cffFFFF00m :|r mirror mode (random)

The second character determines how long races are kept:
|cffFFFF00g :|r The race is determined in round one and then |cffFFFF80kept for the whole game|r
|cffFFFF00r :|r The race is determined before |cffFFFF80EACH round|r

The 3rd character is a number between |cffFFFF001|r and |cffFFFF006|r determining the number of wins for overall victory

|cffFFFF00Examples:|r
-|cffFF0000r|cff00FF00r|cffFFFF002|r would start a |cffFF0000RANDOM|r race |cff00FF00EACH ROUND|r game with |cffFFFF002 wins|r for overall victory
-|cffFF0000p|cff00FF00g|cffFFFF004|r would start a |cffFF0000PICK|r race |cff00FF00ONCE FOR WHOLE GAME|r game with |cffFFFF004 wins|r for overall victory","ReplaceableTextures\\CommandButtons\\BTNPickUpItem.blp")call CreateQuestBJ(0,"Modifications","TRIGSTR_005","ReplaceableTextures\\CommandButtons\\BTNSpy.blp")call CreateQuestBJ(0,"Other Commands","TRIGSTR_006","ReplaceableTextures\\CommandButtons\\BTNAuraOfDarkness.blp")call CreateQuestBJ(2,"First Match?","|cffFFFF80This is your very first match of Castle Fight?|r

Well, no problem, this game is very easy (even if playing with real good strategy can be very difficult). Just pick a worker and start building. Listen to your teammates, you will learn fast.
Read the basic hints in this questlog and when you have played a couple of games and want even more information and tactics about this game, visit |cffFFFF80castle-fight.net.ru|r for a detailed documentation.

|cffFF0000Note that the game has more than one round, so please don't leave if your castle is about to fall. Another round may come after this one and you ruin the game by leaving after round 1.|r

Good luck and have fun!","ReplaceableTextures\\CommandButtons\\BTNSelectHeroOff.blp")call CreateQuestBJ(2,"Basic Hints","TRIGSTR_010","ReplaceableTextures\\CommandButtons\\BTNMilitia.blp")call CreateQuestBJ(2,"About","TRIGSTR_011","ReplaceableTextures\\CommandButtons\\BTNTomeOfRetraining.blp")endfunctionfunction Vs takes integer Aj,integer bj,real Ws returns nothinglocal integer at
local real Xs=Ws
local real Ys=.5*Wsif(ye[Aj]>0)then
set at=bj+4set Ae[at]=Ae[at]+(Ys)endifset at=xe[Aj]if(at==1)thenset Ae[bj+1]=Ae[bj+1]+(Xs)set Ae[bj+2]=Ae[bj+2]+(Ys)elseif(at==2)thenset Ae[bj+2]=Ae[bj+2]+(Xs)set Ae[bj+3]=Ae[bj+3]+(Ys)elseif(at==3)thenset Ae[bj+3]=Ae[bj+3]+(Xs)set Ae[bj+1]=Ae[bj+1]+(Ys)elseif(at==4)thenset Ae[bj+4]=Ae[bj+4]+(Xs)if(ye[Aj]<2)then
set Ae[bj+1]=Ae[bj+1]+(Ys)set Ae[bj+2]=Ae[bj+2]+(Ys)set Ae[bj+3]=Ae[bj+3]+(Ys)endifelseif(at==6)thenset Ae[bj+6]=Ae[bj+6]+(Xs*1.5)set Ae[bj+1]=Ae[bj+1]+(Ys)set Ae[bj+2]=Ae[bj+2]+(Ys)set Ae[bj+3]=Ae[bj+3]+(Ys)elseif(at==5)thenset Ae[bj+5]=Ae[bj+5]+(Xs)endifset Ae[bj+5]=Ae[bj+5]+(Ys)endfunctionfunction Zs takes nothing returns nothinglocal unit u=GetTriggerUnit()local integer id=GetUnitPointValue(u)local real d=t4[id]local integer r=ve[id]local integer a=id*7
local integer z=7*me[GetPlayerId(GetOwningPlayer(u))]if(r>0)thenset r=r+(z)set ue[r]=ue[r]+(d)call Vs(id,z,d*.8)endifset u=nullendfunctionfunction dt takes unit Jm,integer to returns boolean
local player p=GetOwningPlayer(Jm)call SetUnitOwner(Jm,Player($F),false)call SetUnitOwner(Jm,p,false)return IssueImmediateOrderById(Jm,to)endfunctionfunction et takes nothing returns nothingif(GetExpiredTimer()==ce[0])then
set De[0]=trueelse
set De[1]=trueendifendfunctionfunction ft takes integer dk returns boolean
if(GetUnitAbilityLevel(ae[dk],'A005')<=0)thenset Ee[me[dk]]=Player($E)call ForceRemovePlayer(Ce[me[dk]],Player(dk))else
set De[me[dk]]=false
set Ee[me[dk]]=Player(dk)call TimerStart(ce[me[dk]],10.,false,function et)return Si(ae[dk],be[me[dk]])
endifreturn false
endfunctionfunction gt takes nothing returns nothinglocal integer ht=0local integer ai
local integer bi
local real d1local real d2local real t
local integer iloop
set ai=7*ht+1set bi=7*ModuloInteger(ht+1,2)+1
set d1=ue[bi+6]-Ae[ai+6]
set d2=d1set i=1set Ie[ht*2]=6set Ie[ht*2+1]=6
loop
set t=ue[bi]-Ae[ai]if(t>d1 and ue[bi]>Ae[ai])thenset d1=t
set Ie[ht*2]=ielseif(t<d2)then
set d2=t
set Ie[ht*2+1]=i
endifset ai=ai+1set bi=bi+1set i=i+1exitwhen i>=Heendloopset ht=ht+1exitwhen ht>=2endloopendfunctionfunction jt takes nothing returns booleanlocal unit u=GetTriggerUnit()local integer ht
local player pif(IsUnitType(u,UNIT_TYPE_STRUCTURE))thenset r4=GetOwningPlayer(u)set ht=me[GetPlayerId(r4)]set be[ht]=u
call GroupEnumUnitsInRange(q4,GetUnitX(u),GetUnitY(u),1590.1,y9)
set p=vn(Ce[ht])
if(p!=null and(GetWidgetLife(u)/ GetUnitState(u,UNIT_STATE_MAX_LIFE)*100.<40.4 or CountUnitsInGroup(q4)>=16)and(De[ht]or Ee[ht]==p))then
call Sj("AI","STRIKE_ORDER_TARGET",GetPlayerName(p))
call ft(GetPlayerId(p))endifendifset u=nullreturn false
endfunctionfunction kt takes nothing returns booleanlocal unit u=GetFilterUnit()
local real r=GetWidgetLife(u)local boolean Im=r>.405 and IsUnitAlly(u,r4)and IsUnitType(u,UNIT_TYPE_STRUCTURE)and GetUnitState(u,UNIT_STATE_MAX_LIFE)-r>50.set u=nullreturn Imendfunctionfunction mt takes integer nt,integer ot,integer pt,integer qt returns integerlocal integer v=qi()
local integer i=0set Ph[Qh[v]]=nt
set Ph[Qh[v]+1]=otset Ph[Qh[v]+2]=ptset Ph[Qh[v]+3]=qtloop
if(Ph[Qh[v]+i]!=0)thenset Rh[v]=iendifset i=i+1exitwhen i>=4endloopreturn v
endfunctionfunction rt takes integer oi,unit bm returns nothing
local integer i=Rh[oi]-1
local integer st=$Alocal unit ttset r4=GetOwningPlayer(bm)loop
if(i<0)thenset bj_groupEnumTypeId=Ph[Qh[oi]]if(GetPlayerState(r4,PLAYER_STATE_RESOURCE_GOLD)>t4[GetUnitPointValueByType(bj_groupEnumTypeId)])thenset i=te[GetPlayerId(r4)]loop
call Oi(i)exitwhen IssueBuildOrderById(bm,bj_groupEnumTypeId,A,B)or st<0set st=st-1call Qi(i)endloopendifexitwhen trueelse
set bj_groupEnumTypeId=Ph[Qh[oi]+i]call GroupEnumUnitsOfPlayer(q4,r4,filterGetUnitsOfPlayerAndTypeId)set tt=FirstOfGroup(q4)if(tt==null)then
set i=i-1else
if(GetPlayerState(r4,PLAYER_STATE_RESOURCE_GOLD)>t4[GetUnitPointValueByType(Ph[Qh[oi]+i+1])])thencall dt(tt,Ph[Qh[oi]+i+1])endifset tt=nullexitwhen trueendifendifendloopendfunctionfunction ut takes integer oi,unit bm returns nothing
call rt(oi,bm)set bj_groupEnumTypeId=Ph[Qh[oi]+Rh[oi]]
call GroupEnumUnitsOfPlayer(q4,r4,filterGetUnitsOfPlayerAndTypeId)set ze[GetPlayerId(r4)]=FirstOfGroup(q4)!=nullendfunctionfunction vt takes integer oi returns integer
return ve[GetUnitPointValueByType(Ph[Qh[oi]+Rh[oi]])]endfunctionfunction wt takes integer oi,integer xt,integer yt returns nothingset Vh[Wh[oi]+xt*7+Xh[Yh[oi]+xt]]=yt
set Xh[Yh[oi]+xt]=Xh[Yh[oi]+xt]+1endfunctionfunction zt takes integer oi,unit bm returns nothing
local integer i=0local integer At=-1local integer Bt=2*me[GetPlayerId(GetOwningPlayer(bm))]loop
if(vt(Vh[Wh[oi]+Ie[Bt]*7+i])==Ie[Bt+1])thenset At=i
endifset i=i+1exitwhen i>Xh[Yh[oi]+Ie[Bt]]
endloopif(At>-1)thencall rt(Vh[Wh[oi]+Ie[Bt]*7+At],bm)else
call rt(Vh[Wh[oi]+Ie[Bt]*7+GetRandomInt(0,Xh[Yh[oi]+Ie[Bt]])],bm)endifendfunctionfunction bt takes integer oi returns nothing
local integer i=0loop
set Xh[Yh[oi]+i]=Xh[Yh[oi]+i]-1set i=i+1exitwhen i>=7endloopset ei[fi[oi]]=ei[fi[oi]]-1set ei[fi[oi]+1]=ei[fi[oi]+1]-1set ei[fi[oi]+2]=ei[fi[oi]+2]-1set ei[fi[oi]+3]=ei[fi[oi]+3]-1endfunctionfunction Ct takes integer oi,integer ct,integer yt returns nothingset Zh[di[oi]+4*ct+ei[fi[oi]+ct]]=yt
set ei[fi[oi]+ct]=ei[fi[oi]+ct]+1endfunctionfunction Dt takes integer oi,unit bm returns nothing
local integer dk=GetPlayerId(GetOwningPlayer(bm))if(rd and(not ze[dk]))thenif((not md)and ei[fi[oi]+3]>=0)thencall ut(Zh[di[oi]+4*3+GetRandomInt(0,ei[fi[oi]+3])],bm)elseif(ei[fi[oi]]>=0)thencall ut(Zh[di[oi]+4*0+GetRandomInt(0,ei[fi[oi]])],bm)else
set ze[dk]=trueendifelseif((not md)and ei[fi[oi]+1]>=0)thencall rt(Zh[di[oi]+4*1+GetRandomInt(0,ei[fi[oi]+1])],bm)elseif(ei[fi[oi]+2]>=0)thencall rt(Zh[di[oi]+4*2+GetRandomInt(0,ei[fi[oi]+2])],bm)else
call zt(oi,bm)endifendfunctionfunction Et takes integer aj returns integer
if(aj=='h00O')thenreturn Jeendifif(aj=='u006')thenreturn Keendifif(aj=='h00C')thenreturn Leendifif(aj=='h019')thenreturn Meendifif(aj=='h00E')thenreturn Neendifif(aj=='h017')thenreturn Oeendifif(aj=='h089')thenreturn Peendifif(aj=='h00P')thenreturn Qeendifif(aj=='h018')thenreturn Reendifif(aj=='h06P')thenreturn Seendifif(aj=='h01A')thenreturn Teendifif(aj=='h051')thenreturn Ueendifreturn-1
endfunctionfunction Ft takes nothing returns nothinglocal integer i=0if(Fe)thenreturnendifloop
if(Be[i]and ae[i]!=null and GetWidgetLife(ae[i])>.405)thenif(be[me[i]]==null)thenif(GetUnitCurrentOrder(ae[i])==0)thencall IssuePointOrderByIdLoc(ae[i],$D022D,Qd[i])endifelseif(GetWidgetLife(be[me[i]])>.405 and GetUnitState(be[me[i]],UNIT_STATE_MAX_LIFE)-GetWidgetLife(be[me[i]])>50.)thencall IssueTargetOrderById(ae[i],$D0038,be[me[i]])else
set r4=Player(i)
call GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,le)set bj_groupRandomConsidered=0set bj_groupRandomCurrentPick=nullcall ForGroup(q4,function GroupPickRandomUnitEnum)set be[me[i]]=bj_groupRandomCurrentPickendifendifset i=i+1exitwhen i>$Bendloopendfunctionfunction Gt takes nothing returns nothinglocal integer i=0local integer tif(Fe)thenreturnendifcall gt()loop
if(Be[i])thenset r4=Player(i)
if(ae[i]==null or GetWidgetLife(ae[i])<=.405)thencall GroupEnumUnitsOfPlayer(q4,r4,b9)set ae[i]=FirstOfGroup(q4)if(ae[i]!=null)thenset Ve[i]=Et(GetUnitTypeId(ae[i]))if(GetUnitAbilityLevel(ae[i],'A005')>0)thencall ForceAddPlayer(Ce[me[i]],r4)call Sj("AI","MainOrdererRegistratorStrikeStack",GetPlayerName(r4))endifendifelse
set t=GetPlayerState(Player(i),PLAYER_STATE_RESOURCE_LUMBER)
if(t<$7D0 or t>$BB8 or GetPlayerState(r4,PLAYER_STATE_RESOURCE_GOLD)>=$3E8)thencall zt(Ve[i],ae[i])
else
call Dt(Ve[i],ae[i])
endifendifendifset i=i+1exitwhen i>$Bendloopendfunctionfunction AILibrary_PrepareAI takes nothing returns nothingcall ExecuteFunc("Ht")endfunctionfunction AILibrary_ResetBuildPlaces takes nothing returns nothinglocal integer i=0if(not Ge)thenreturnendifloop
if(Be[i])thenif(IsPlayerInForce(Player(i),ie))thenset te[i]=ModuloInteger(i,2)+2elseif(IsPlayerInForce(Player(i),je))thenset te[i]=ModuloInteger(i,2)
endifendifset i=i+1exitwhen i>$Bendloopendfunctionfunction It takes integer dk returns nothing
local string scall ExecuteFunc("Ht")if(IsPlayerInForce(Player(dk),ie))thenset te[dk]=ModuloInteger(dk,2)+2
elseif(IsPlayerInForce(Player(dk),je))thenset te[dk]=ModuloInteger(dk,2)endifset s=Ki()call SetPlayerName(Player(dk),s)
set l9[dk]=s
call Ls(dk)set Be[dk]=truecall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,pe[dk]+" joined to game with AI savvy!")endfunctionfunction lt takes integer dk returns boolean
if(not Be[dk])thenreturn false
endifset Be[dk]=false
call ForceRemovePlayer(Ce[me[dk]],Player(dk))return trueendfunctionfunction Jt takes nothing returns nothinglocal integer i=0loop
if(qe[i])thencall DisplayTextToPlayer(Player(i),.0,.0,"|cffCA0000WARNING|r: AI took control over your units! Type -afk to disable AI.")endifset i=i+1exitwhen i>$Bendloopendfunctionfunction Kt takes integer dk returns nothing
if(qe[dk])thenset qe[dk]=false
call lt(dk)call SetPlayerName(Player(dk),l9[dk])call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,pe[dk]+"|cffCA0000 is no longer AFK!|r")set re=re-1if(re==0)thencall PauseTimer(se)call DestroyTimer(se)set se=nullendifelse
set qe[dk]=trueset Gd[dk]=truecall ExecuteFunc("Ht")if(IsPlayerInForce(Player(dk),ie))thenset te[dk]=ModuloInteger(dk,2)+2
elseif(IsPlayerInForce(Player(dk),je))thenset te[dk]=ModuloInteger(dk,2)endifcall SetPlayerName(Player(dk),"[AFK] "+l9[dk])set Be[dk]=truecall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,pe[dk]+"|cffCA0000 is AFK!|r AI took control over his units.")if(re==0)thenset se=CreateTimer()
call TimerStart(se,5.,true,function Jt)endifset re=re+1endifendfunctionfunction Lt takes nothing returns nothinglocal integer i=0local boolean b=falseloop
if(GetPlayerController(Player(i))==MAP_CONTROL_COMPUTER)then
call It(i)set b=trueendifset i=i+1exitwhen i>$Bendloopif(b)thencall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"AI functionality damaged: you are playing with computer slots.
In future use command -fill.")endifendfunctionfunction Mt takes nothing returns nothinglocal integer i=0loop
set ue[i]=0set Ae[i]=0set i=i+1exitwhen i>7*2endloopset i=0loop
set ze[i]=falseexitwhen i>$Bset i=i+1endloopcall Mi()call ForceClear(Ce[0])call ForceClear(Ce[1])call PauseTimer(ce[0])call PauseTimer(ce[1])set De[0]=trueset De[1]=trueset Ee[0]=Player($E)
set Ee[1]=Player($E)
set Fe=false
endfunctionfunction AILibrary_Sleep takes nothing returns nothingset Fe=trueendfunctionfunction Ht takes nothing returns nothinglocal integer ilocal trigger tlocal integer Nt
local integer Ot
local integer Pt
local integer Qt
local integer Rt
local integer St
local integer Tt
local integer Ut
local integer Vt
local integer Wt
local integer Xt
local integer Yt
local integer Zt
local integer du
local integer eu
local integer fu
local integer gu
local integer hu
local integer iu
local integer ju
local integer ku
local integer mu
local integer nu
local integer ou
local integer pu
local integer qu
local integer ru
local integer su
local integer tu
local integer uu
local integer vu
local integer wu
local integer xu
local integer yu
local integer zu
local integer Au
local integer au
local integer Bu
local integer bu
local integer Cu
local integer cu
local integer Du
local integer Eu
local integer Fu
local integer Gu
if(Ge)thenreturnendifcall Li()call Mi()set le=Filter(function kt)call TimerStart(CreateTimer(),2.,true,function Gt)call TimerStart(CreateTimer(),5.,true,function Ft)set t=CreateTrigger()call TriggerAddAction(t,function Zs)
call TriggerRegisterAnyUnitEventBJ(t,EVENT_PLAYER_UNIT_CONSTRUCT_FINISH)
call TriggerRegisterAnyUnitEventBJ(t,EVENT_PLAYER_UNIT_UPGRADE_FINISH)set t=CreateTrigger()call TriggerAddCondition(t,Condition(function jt))call TriggerRegisterAnyUnitEventBJ(t,EVENT_PLAYER_UNIT_ATTACKED)
set t=nullset Ce[0]=CreateForce()set Ce[1]=CreateForce()set ce[0]=CreateTimer()set ce[1]=CreateTimer()set De[0]=trueset De[1]=trueset Ee[0]=Player($E)
set Ee[1]=Player($E)
set Je=pi()set Nt=mt('h025',0,0,0)set Ot=mt('h009',0,0,0)set Pt=mt('h007',0,0,0)set Qt=mt('h01C',0,0,0)call wt(Je,2,mt('h01I','h026',0,0))call wt(Je,2,mt('h01D','h03G',0,0))call wt(Je,3,Qt)
call wt(Je,6,Nt)
call wt(Je,6,Ot)
call wt(Je,6,Pt)
call wt(Je,1,Nt)
call wt(Je,1,Qt)
call wt(Je,4,Pt)
call wt(Je,5,Ot)
set i=GetUnitPointValueByType('h025')set ve[i]=5set xe[i]=6set ye[i]=0set i=GetUnitPointValueByType('h009')set ve[i]=4set xe[i]=6set ye[i]=1set i=GetUnitPointValueByType('h007')set ve[i]=3set xe[i]=6set ye[i]=1set i=GetUnitPointValueByType('h01C')set ve[i]=1set xe[i]=6set ye[i]=1set i=GetUnitPointValueByType('h01I')set ve[i]=1set xe[i]=2set ye[i]=1set i=GetUnitPointValueByType('h026')set ve[i]=1set xe[i]=2set ye[i]=1set i=GetUnitPointValueByType('h01D')set ve[i]=2set xe[i]=2set ye[i]=0set i=GetUnitPointValueByType('h03G')set ve[i]=2set xe[i]=2set ye[i]=0call Ct(Je,0,mt('h01M','h01W','h01X',0))
call Ct(Je,3,mt('h01E',0,0,0))call Ct(Je,2,mt('h01F',0,0,0))call bt(Je)set Le=pi()set Rt=mt('h000','h039',0,0)
set St=mt('h003','h05D',0,0)
set Tt=mt('h037','h038',0,0)
set Ut=mt('h015',0,0,0)call wt(Le,1,St)
call wt(Le,2,Rt)
call wt(Le,2,St)
call wt(Le,2,Tt)
call wt(Le,3,Tt)
call wt(Le,3,Ut)
call wt(Le,4,mt('h003','h0A1',0,0))call wt(Le,5,mt('h004',0,0,0))call wt(Le,5,Ut)
call wt(Le,6,Tt)
call wt(Le,6,mt('h00K',0,0,0))set i=GetUnitPointValueByType('h000')set ve[i]=3set xe[i]=2set ye[i]=0set i=GetUnitPointValueByType('h039')set ve[i]=3set xe[i]=2set ye[i]=0set i=GetUnitPointValueByType('h003')set ve[i]=2set xe[i]=1set ye[i]=1set i=GetUnitPointValueByType('h05D')set ve[i]=2set xe[i]=1set ye[i]=0set i=GetUnitPointValueByType('h0A1')set ve[i]=2set xe[i]=1set ye[i]=2set i=GetUnitPointValueByType('h004')set ve[i]=1set xe[i]=5set ye[i]=0set i=GetUnitPointValueByType('h015')set ve[i]=4set xe[i]=3set ye[i]=1set i=GetUnitPointValueByType('h037')set ve[i]=3set xe[i]=6set ye[i]=0set i=GetUnitPointValueByType('h038')set ve[i]=3set xe[i]=6set ye[i]=0set i=GetUnitPointValueByType('h00K')set ve[i]=5set xe[i]=6set ye[i]=1call Ct(Le,0,mt('h05G',0,0,0))call Ct(Le,1,mt('h001',0,0,0))call bt(Le)set Ke=pi()set Vt=mt('h04L','h04N',0,0)
set Wt=mt('h04O','h04M',0,0)
set Xt=mt('h04Q','h04P',0,0)
set Yt=mt('h04U',0,0,0)call wt(Ke,1,mt('h04S',0,0,0))call wt(Ke,2,mt('h04V','h04W',0,0))call wt(Ke,3,Vt)
call wt(Ke,3,Wt)
call wt(Ke,3,Xt)
call wt(Ke,4,Vt)
call wt(Ke,4,Yt)
call wt(Ke,5,Xt)
call wt(Ke,5,Wt)
call wt(Ke,6,Yt)
set i=GetUnitPointValueByType('h04S')set ve[i]=2set xe[i]=1set ye[i]=0set i=GetUnitPointValueByType('h04V')set ve[i]=3set xe[i]=2set ye[i]=0set i=GetUnitPointValueByType('h04W')set ve[i]=3set xe[i]=2set ye[i]=0set i=GetUnitPointValueByType('h09Y')set ve[i]=3set xe[i]=2set ye[i]=0set i=GetUnitPointValueByType('h04L')set ve[i]=1set xe[i]=3set ye[i]=1set i=GetUnitPointValueByType('h04N')set ve[i]=1set xe[i]=3set ye[i]=1set i=GetUnitPointValueByType('h04O')set ve[i]=4set xe[i]=3set ye[i]=1set i=GetUnitPointValueByType('h04M')set ve[i]=4set xe[i]=3set ye[i]=1set i=GetUnitPointValueByType('h04Q')set ve[i]=3set xe[i]=5set ye[i]=0set i=GetUnitPointValueByType('h04P')set ve[i]=3set xe[i]=5set ye[i]=0set i=GetUnitPointValueByType('h04U')set ve[i]=2set xe[i]=6set ye[i]=1call Ct(Ke,0,mt('h04T',0,0,0))call Ct(Ke,0,mt('h04V','h04W','h09Y',0))
call Ct(Ke,2,mt('h04K',0,0,0))call Ct(Ke,2,mt('h04R',0,0,0))call bt(Ke)set Me=pi()set Zt=mt('h029','h02U','h031',0)set du=mt('h02H','h05E',0,0)
set eu=mt('h02I',0,0,0)set fu=mt('h02B',0,0,0)call wt(Me,1,mt('h02K','h092',0,0))call wt(Me,1,mt('h02K','h035',0,0))call wt(Me,1,mt('h02K','h036',0,0))call wt(Me,1,mt('h02P',0,0,0))call wt(Me,2,Zt)
call wt(Me,2,du)
call wt(Me,3,Zt)
call wt(Me,3,fu)
call wt(Me,4,du)
call wt(Me,5,eu)
call wt(Me,6,Zt)
call wt(Me,6,eu)
set i=GetUnitPointValueByType('h02K')set ve[i]=1set xe[i]=1set ye[i]=1set i=GetUnitPointValueByType('h092')set ve[i]=1set xe[i]=1set ye[i]=1set i=GetUnitPointValueByType('h035')set ve[i]=1set xe[i]=1set ye[i]=1set i=GetUnitPointValueByType('h036')set ve[i]=1set xe[i]=1set ye[i]=1set i=GetUnitPointValueByType('h02P')set ve[i]=4set xe[i]=1set ye[i]=1set i=GetUnitPointValueByType('h029')set ve[i]=3set xe[i]=2set ye[i]=0set i=GetUnitPointValueByType('h02U')set ve[i]=3set xe[i]=2set ye[i]=0set i=GetUnitPointValueByType('h031')set ve[i]=3set xe[i]=2set ye[i]=0set i=GetUnitPointValueByType('h02H')set ve[i]=2set xe[i]=2set ye[i]=1set i=GetUnitPointValueByType('h05E')set ve[i]=2set xe[i]=2set ye[i]=1set i=GetUnitPointValueByType('h02B')set ve[i]=5set xe[i]=3set ye[i]=1set i=GetUnitPointValueByType('h02I')set ve[i]=2set xe[i]=5set ye[i]=0call Ct(Me,0,mt('h02O',0,0,0))call Ct(Me,2,mt('h02R',0,0,0))call Ct(Me,2,mt('h02N',0,0,0))call bt(Me)set Ne=pi()set gu=mt('h00F','h032',0,0)
set hu=mt('h020','h021','h022',0)set iu=mt('h01B',0,0,0)set ju=mt('h01Z',0,0,0)set ku=mt('h00J',0,0,0)call wt(Ne,1,gu)
call wt(Ne,2,hu)
call wt(Ne,2,iu)
call wt(Ne,2,ku)
call wt(Ne,3,gu)
call wt(Ne,3,hu)
call wt(Ne,3,iu)
call wt(Ne,3,mt('h01Y',0,0,0))call wt(Ne,4,ku)
call wt(Ne,4,iu)
call wt(Ne,4,ju)
call wt(Ne,5,iu)
call wt(Ne,5,ju)
call wt(Ne,6,ju)
set i=GetUnitPointValueByType('h00F')set ve[i]=3set xe[i]=1set ye[i]=0set i=GetUnitPointValueByType('h032')set ve[i]=3set xe[i]=1set ye[i]=0set i=GetUnitPointValueByType('h020')set ve[i]=5set xe[i]=2set ye[i]=0set i=GetUnitPointValueByType('h021')set ve[i]=5set xe[i]=2set ye[i]=0set i=GetUnitPointValueByType('h022')set ve[i]=5set xe[i]=2set ye[i]=0set i=GetUnitPointValueByType('h01B')set ve[i]=3set xe[i]=5set ye[i]=1set i=GetUnitPointValueByType('h01Z')set ve[i]=5set xe[i]=6set ye[i]=1set i=GetUnitPointValueByType('h01Y')set ve[i]=4set xe[i]=3set ye[i]=1set i=GetUnitPointValueByType('h00J')set ve[i]=2set xe[i]=2set ye[i]=1set i=GetUnitPointValueByType('h05F')set ve[i]=2set xe[i]=6set ye[i]=1call Ct(Ne,0,mt('h00J','h05F',0,0))call Ct(Ne,0,mt('h00N',0,0,0))call Ct(Ne,2,mt('h00I',0,0,0))call Ct(Ne,2,mt('h00M',0,0,0))call bt(Ne)set Oe=pi()set mu=mt('h03S',0,0,0)set nu=mt('h03I',0,0,0)call wt(Oe,1,mt('h03U',0,0,0))call wt(Oe,1,mt('h03T','h043',0,0))call wt(Oe,2,mt('h049','h04F','h03W',0))
call wt(Oe,2,mu)
call wt(Oe,2,nu)
call wt(Oe,3,mt('h03K','h03J',0,0))call wt(Oe,3,mu)
call wt(Oe,3,nu)
call wt(Oe,4,mu)
call wt(Oe,4,nu)
call wt(Oe,5,mu)
call wt(Oe,5,nu)
call wt(Oe,6,mu)
call wt(Oe,6,nu)
set i=GetUnitPointValueByType('h03U')set ve[i]=3set xe[i]=1set ye[i]=1set i=GetUnitPointValueByType('h03T')set ve[i]=2set xe[i]=1set ye[i]=0set i=GetUnitPointValueByType('h043')set ve[i]=2set xe[i]=1set ye[i]=0set i=GetUnitPointValueByType('h049')set ve[i]=5set xe[i]=2set ye[i]=0set i=GetUnitPointValueByType('h04F')set ve[i]=5set xe[i]=2set ye[i]=0set i=GetUnitPointValueByType('h03W')set ve[i]=5set xe[i]=2set ye[i]=0set i=GetUnitPointValueByType('h03K')set ve[i]=1set xe[i]=3set ye[i]=1set i=GetUnitPointValueByType('h03J')set ve[i]=1set xe[i]=3set ye[i]=1set i=GetUnitPointValueByType('h049')set ve[i]=4set xe[i]=6set ye[i]=1set i=GetUnitPointValueByType('h04F')set ve[i]=5set xe[i]=6set ye[i]=1call Ct(Oe,0,mt('h03O',0,0,0))call Ct(Oe,1,mt('h048','h03L',0,0))call Ct(Oe,2,mt('h047',0,0,0))call bt(Oe)set Re=pi()set ou=mt('h01P','h056',0,0)
set pu=mt('h01K','h04B',0,0)
set qu=mt('h01S',0,0,0)call wt(Re,1,mt('h01N','h054',0,0))call wt(Re,1,ou)
call wt(Re,1,pu)
call wt(Re,1,qu)
call wt(Re,2,ou)
call wt(Re,2,pu)
call wt(Re,2,qu)
call wt(Re,3,pu)
call wt(Re,3,mt('h01L',0,0,0))call wt(Re,3,qu)
call wt(Re,4,ou)
call wt(Re,4,pu)
call wt(Re,5,pu)
call wt(Re,5,mt('h01T',0,0,0))call wt(Re,5,qu)
call wt(Re,6,mt('h01R','h04Z','h03M',0))
set i=GetUnitPointValueByType('h01P')set ve[i]=1set xe[i]=6set ye[i]=1set i=GetUnitPointValueByType('h056')set ve[i]=1set xe[i]=6set ye[i]=1set i=GetUnitPointValueByType('h01K')set ve[i]=5set xe[i]=3set ye[i]=1set i=GetUnitPointValueByType('h04B')set ve[i]=5set xe[i]=3set ye[i]=1set i=GetUnitPointValueByType('h055')set ve[i]=5set xe[i]=3set ye[i]=1set i=GetUnitPointValueByType('h01S')set ve[i]=4set xe[i]=2set ye[i]=1set i=GetUnitPointValueByType('h01N')set ve[i]=3set xe[i]=1set ye[i]=0set i=GetUnitPointValueByType('h054')set ve[i]=3set xe[i]=1set ye[i]=0set i=GetUnitPointValueByType('h01L')set ve[i]=6set xe[i]=3set ye[i]=1set i=GetUnitPointValueByType('h01T')set ve[i]=2set xe[i]=5set ye[i]=0set i=GetUnitPointValueByType('h01R')set ve[i]=2set xe[i]=6set ye[i]=0set i=GetUnitPointValueByType('h04Z')set ve[i]=2set xe[i]=6set ye[i]=0set i=GetUnitPointValueByType('h03M')set ve[i]=2set xe[i]=6set ye[i]=0call Ct(Re,0,mt('h01K','h04B','h055',0))
call Ct(Re,0,mt('h01Q',0,0,0))call Ct(Re,2,mt('h00A',0,0,0))call bt(Re)set Pe=pi()set ru=mt('h00S','h03D',0,0)
call wt(Pe,1,ru)
call wt(Pe,1,mt('h07M','h07L',0,0))call wt(Pe,2,ru)
call wt(Pe,3,mt('h07O','h07N',0,0))call wt(Pe,3,mt('h00B',0,0,0))call wt(Pe,4,ru)
call wt(Pe,5,ru)
call wt(Pe,5,mt('h011',0,0,0))call wt(Pe,6,mt('h088','h07D',0,0))set i=GetUnitPointValueByType('h00S')set ve[i]=1set xe[i]=1set ye[i]=1set i=GetUnitPointValueByType('h03D')set ve[i]=1set xe[i]=1set ye[i]=1set i=GetUnitPointValueByType('h03E')set ve[i]=1set xe[i]=1set ye[i]=1set i=GetUnitPointValueByType('h07M')set ve[i]=2set xe[i]=1set ye[i]=0set i=GetUnitPointValueByType('h07L')set ve[i]=2set xe[i]=1set ye[i]=0set i=GetUnitPointValueByType('h07O')set ve[i]=1set xe[i]=3set ye[i]=0set i=GetUnitPointValueByType('h07N')set ve[i]=1set xe[i]=3set ye[i]=0set i=GetUnitPointValueByType('h00B')set ve[i]=4set xe[i]=3set ye[i]=1set i=GetUnitPointValueByType('h011')set ve[i]=3set xe[i]=5set ye[i]=0set i=GetUnitPointValueByType('h088')set ve[i]=5set xe[i]=6set ye[i]=1set i=GetUnitPointValueByType('h07D')set ve[i]=5set xe[i]=6set ye[i]=1call Ct(Pe,0,mt('h00S','h03D','h03E',0))
call Ct(Pe,3,mt('h07I',0,0,0))call Ct(Pe,2,mt('h07H',0,0,0))call Ct(Pe,2,mt('h08P',0,0,0))call bt(Pe)set Qe=pi()set su=mt('h08X','h08Y',0,0)
set tu=mt('h06Y',0,0,0)set uu=mt('h00T','h03F',0,0)
set vu=mt('h09X',0,0,0)set wu=mt('h00V',0,0,0)call wt(Qe,1,su)
call wt(Qe,1,tu)
call wt(Qe,2,uu)
call wt(Qe,3,wu)
call wt(Qe,3,vu)
call wt(Qe,4,su)
call wt(Qe,4,tu)
call wt(Qe,5,mt('h070',0,0,0))call wt(Qe,5,wu)
call wt(Qe,6,su)
call wt(Qe,6,uu)
call wt(Qe,6,vu)
set i=GetUnitPointValueByType('h08X')set ve[i]=5set xe[i]=1set ye[i]=1set i=GetUnitPointValueByType('h08Y')set ve[i]=5set xe[i]=1set ye[i]=1set i=GetUnitPointValueByType('h06Y')set ve[i]=4set xe[i]=1set ye[i]=1set i=GetUnitPointValueByType('h00T')set ve[i]=3set xe[i]=2set ye[i]=0set i=GetUnitPointValueByType('h03F')set ve[i]=3set xe[i]=2set ye[i]=0set i=GetUnitPointValueByType('h00V')set ve[i]=2set xe[i]=3set ye[i]=1set i=GetUnitPointValueByType('h09X')set ve[i]=5set xe[i]=3set ye[i]=1set i=GetUnitPointValueByType('h00X')set ve[i]=5set xe[i]=6set ye[i]=1set i=GetUnitPointValueByType('h070')set ve[i]=2set xe[i]=5set ye[i]=0call Ct(Qe,0,mt('h09X','h00X',0,0))call Ct(Qe,0,mt('h059',0,0,0))call Ct(Qe,2,mt('h00Z',0,0,0))call Ct(Qe,2,mt('h005',0,0,0))call bt(Qe)set Se=pi()set xu=mt('h05X','h09I',0,0)
set yu=mt('h05X','h09B',0,0)
set zu=mt('h05X','h09J',0,0)
set Au=mt('h05T','h09P',0,0)
call wt(Se,1,mt('h05U',0,0,0))call wt(Se,1,xu)
call wt(Se,1,Au)
call wt(Se,2,yu)
call wt(Se,2,zu)
call wt(Se,2,Au)
call wt(Se,3,xu)
call wt(Se,3,yu)
call wt(Se,3,zu)
call wt(Se,3,mt('h05M',0,0,0))call wt(Se,4,mt('h05X','h09B','h09H',0))
call wt(Se,4,mt('h05J','h09L',0,0))call wt(Se,5,xu)
call wt(Se,5,yu)
call wt(Se,5,Au)
call wt(Se,6,xu)
call wt(Se,6,mt('h05V',0,0,0))call wt(Se,6,Au)
set i=GetUnitPointValueByType('h05X')set ve[i]=3set xe[i]=2set ye[i]=0set i=GetUnitPointValueByType('h09I')set ve[i]=3set xe[i]=6set ye[i]=0set i=GetUnitPointValueByType('h09B')set ve[i]=3set xe[i]=2set ye[i]=0set i=GetUnitPointValueByType('h09J')set ve[i]=3set xe[i]=2set ye[i]=0set i=GetUnitPointValueByType('h05T')set ve[i]=1set xe[i]=6set ye[i]=0set i=GetUnitPointValueByType('h09P')set ve[i]=1set xe[i]=6set ye[i]=0set i=GetUnitPointValueByType('h05U')set ve[i]=2set xe[i]=1set ye[i]=0set i=GetUnitPointValueByType('h05M')set ve[i]=5set xe[i]=3set ye[i]=0set i=GetUnitPointValueByType('h09H')set ve[i]=3set xe[i]=2set ye[i]=1set i=GetUnitPointValueByType('h05J')set ve[i]=4set xe[i]=1set ye[i]=2set i=GetUnitPointValueByType('h09L')set ve[i]=4set xe[i]=1set ye[i]=2set i=GetUnitPointValueByType('h05V')set ve[i]=2set xe[i]=6set ye[i]=0set i=GetUnitPointValueByType('h097')set ve[i]=6set xe[i]=6set ye[i]=0call Ct(Se,0,mt('h05V','h097',0,0))call Ct(Se,2,mt('h06J','h05R',0,0))call Ct(Se,2,mt('h069',0,0,0))call bt(Se)set Te=pi()set au=mt('h002','h00Q','h00R',0)set Bu=mt('h028',0,0,0)set bu=mt('h00Y','h012',0,0)
set Cu=mt('h013','h01H',0,0)
set cu=mt('h027',0,0,0)call wt(Te,1,au)
call wt(Te,1,Cu)
call wt(Te,2,mt('h023','h024',0,0))call wt(Te,2,Bu)
call wt(Te,3,bu)
call wt(Te,4,bu)
call wt(Te,4,Cu)
call wt(Te,4,Bu)
call wt(Te,5,Bu)
call wt(Te,5,cu)
call wt(Te,6,Bu)
call wt(Te,6,cu)
set i=GetUnitPointValueByType('h002')set ve[i]=5set xe[i]=1set ye[i]=0set i=GetUnitPointValueByType('h00Q')set ve[i]=5set xe[i]=1set ye[i]=0set i=GetUnitPointValueByType('h00R')set ve[i]=5set xe[i]=1set ye[i]=1set i=GetUnitPointValueByType('h028')set ve[i]=5set xe[i]=5set ye[i]=1set i=GetUnitPointValueByType('h00Y')set ve[i]=1set xe[i]=3set ye[i]=1set i=GetUnitPointValueByType('h012')set ve[i]=1set xe[i]=3set ye[i]=1set i=GetUnitPointValueByType('h013')set ve[i]=2set xe[i]=1set ye[i]=1set i=GetUnitPointValueByType('h01H')set ve[i]=2set xe[i]=1set ye[i]=1set i=GetUnitPointValueByType('h01J')set ve[i]=2set xe[i]=6set ye[i]=1set i=GetUnitPointValueByType('h027')set ve[i]=4set xe[i]=6set ye[i]=1set i=GetUnitPointValueByType('h023')set ve[i]=5set xe[i]=2set ye[i]=0set i=GetUnitPointValueByType('h024')set ve[i]=5set xe[i]=2set ye[i]=0call Ct(Te,0,mt('h013','h01H','h01J',0))
call Ct(Te,0,mt('h02D',0,0,0))call Ct(Te,2,mt('h02C',0,0,0))call Ct(Te,2,mt('h02A',0,0,0))call bt(Te)set Ue=pi()set Du=mt('h045','h046',0,0)
set Eu=mt('h040','h041',0,0)
set Fu=mt('h03X','h03Y','h03Z',0)set Gu=mt('h042','h044',0,0)
call wt(Ue,1,Du)
call wt(Ue,1,Fu)
call wt(Ue,1,Gu)
call wt(Ue,2,Fu)
call wt(Ue,3,Gu)
call wt(Ue,4,mt('h04A','h04C','h04D',0))
call wt(Ue,4,Du)
call wt(Ue,5,Eu)
call wt(Ue,6,Du)
set i=GetUnitPointValueByType('h045')set ve[i]=3set xe[i]=6set ye[i]=1set i=GetUnitPointValueByType('h046')set ve[i]=3set xe[i]=6set ye[i]=1set i=GetUnitPointValueByType('h040')set ve[i]=2set xe[i]=5set ye[i]=0set i=GetUnitPointValueByType('h041')set ve[i]=2set xe[i]=5set ye[i]=0set i=GetUnitPointValueByType('h03X')set ve[i]=1set xe[i]=2set ye[i]=1set i=GetUnitPointValueByType('h03Y')set ve[i]=1set xe[i]=2set ye[i]=1set i=GetUnitPointValueByType('h03Z')set ve[i]=1set xe[i]=2set ye[i]=1set i=GetUnitPointValueByType('h042')set ve[i]=3set xe[i]=3set ye[i]=1set i=GetUnitPointValueByType('h044')set ve[i]=3set xe[i]=3set ye[i]=1set i=GetUnitPointValueByType('h04A')set ve[i]=4set xe[i]=1set ye[i]=2set i=GetUnitPointValueByType('h04C')set ve[i]=4set xe[i]=1set ye[i]=1set i=GetUnitPointValueByType('h04D')set ve[i]=4set xe[i]=1set ye[i]=1set i=GetUnitPointValueByType('h04E')set ve[i]=3set xe[i]=3set ye[i]=1call Ct(Ue,0,mt('h045','h046','h04E',0))
call Ct(Ue,0,mt('h063',0,0,0))call Ct(Ue,2,mt('h060',0,0,0))call Ct(Ue,2,mt('h05Z',0,0,0))call bt(Ue)set Ge=trueendfunctionfunction Hu takes nothing returns nothinglocal unit c
local integer i=GetRandomInt(0,8)local real x
local real y
set r4=GetOwningPlayer(B4)call GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,y9)call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Orc\\FeralSpirit\\feralspiritdone.mdl",GetUnitX(B4),GetUnitY(B4)))set bj_groupRandomCurrentPick=rn(q4)
if(bj_groupRandomCurrentPick==null)thenreturnendifif(yd)thencall Pj("SE:CH:ST "+GetUnitName(B4)+" ->"+GetUnitName(bj_groupRandomCurrentPick))call Rj()endifcall DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Orc\\FeralSpirit\\feralspiritdone.mdl",bj_groupRandomCurrentPick,"origin"))if(Hr(bj_groupRandomCurrentPick))thenreturnendifif(i==0)then
call ExplodeUnitBJ(bj_groupRandomCurrentPick)set i=GetPlayerId(r4)set Sd[i]=Sd[i]+1elseif(i==1)then
call UnitDamageTarget(B4,bj_groupRandomCurrentPick,50000.,true,false,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_DEATH,WEAPON_TYPE_WHOKNOWS)elseif(i==2)then
call UnitDamageTarget(B4,bj_groupRandomCurrentPick,500.,true,false,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_DEATH,WEAPON_TYPE_WHOKNOWS)elseif(i==3)then
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\Avatar\\AvatarCaster.mdl",bj_groupRandomCurrentPick,"origin"))call UnitAddAbility(bj_groupRandomCurrentPick,'A06T')call UnitAddAbility(bj_groupRandomCurrentPick,'A06U')call SetUnitState(bj_groupRandomCurrentPick,UNIT_STATE_LIFE,GetUnitState(bj_groupRandomCurrentPick,UNIT_STATE_MAX_LIFE))
elseif(i==4)then
set c=CreateUnit(r4,'e008',GetUnitX(bj_groupRandomCurrentPick),GetUnitY(bj_groupRandomCurrentPick),.0)call UnitAddAbility(c,'A018')call UnitShareVision(bj_groupRandomCurrentPick,r4,true)call IssueTargetOrderById(c,$D0216,bj_groupRandomCurrentPick)call UnitShareVision(bj_groupRandomCurrentPick,r4,false)
call UnitApplyTimedLife(c,'BTLF',1.)
set c=bj_groupRandomCurrentPickcall TriggerSleepAction(1.)call Po(c)if(GetUnitTypeId(c)=='h03A')then
call TriggerSleepAction(44.5)call IssueImmediateOrderById(c,$D0057)call TriggerSleepAction(.5)call Po(c)endifset c=nullelseif(i==5)then
set c=CreateUnit(r4,'e008',GetUnitX(bj_groupRandomCurrentPick),GetUnitY(bj_groupRandomCurrentPick),.0)call UnitAddAbility(c,'A06S')call UnitShareVision(bj_groupRandomCurrentPick,r4,true)call IssueTargetOrderById(c,$D007F,bj_groupRandomCurrentPick)call UnitShareVision(bj_groupRandomCurrentPick,r4,false)
call UnitApplyTimedLife(c,'BTLF',2.)
set c=nullelseif(i==6)then
set i=GetPlayerId(r4)set Sd[i]=Sd[i]+1call ShowUnit(bj_groupRandomCurrentPick,false)set x=GetUnitX(bj_groupRandomCurrentPick)set y=GetUnitY(bj_groupRandomCurrentPick)call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Orc\\FeralSpirit\\feralspiritdone.mdl",x,y))
call Po(CreateUnit(r4,'n01S',x,y,GetUnitFacing(bj_groupRandomCurrentPick)))call RemoveUnit(bj_groupRandomCurrentPick)endifendfunctionfunction Iu takes nothing returns booleanlocal unit u=GetFilterUnit()
local boolean Im=GetWidgetLife(u)>.405 and IsUnitEnemy(u,r4)and GetUnitTypeId(u)==Xe
set u=nullreturn Imendfunctionfunction lu takes nothing returns nothinglocal unit u=GetEnumUnit()call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Items\\AIil\\AIilTarget.mdl",u,"origin"))if(GetUnitAbilityLevel(u,'A070')<=0)then
call UnitDamageTarget(B4,u,100500.,true,false,ATTACK_TYPE_CHAOS,DAMAGE_TYPE_DEATH,WEAPON_TYPE_WHOKNOWS)endifset u=nullendfunctionfunction Ju takes nothing returns nothingset r4=GetOwningPlayer(B4)call GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,y9)call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Items\\TomeOfRetraining\\TomeOfRetrainingCaster.mdl",GetUnitX(B4),GetUnitY(B4)))
set bj_groupRandomCurrentPick=rn(q4)
if(bj_groupRandomCurrentPick==null)thenreturnendifif(yd)thencall Pj("SE:CH:SE "+GetUnitName(B4)+" ->"+GetUnitName(bj_groupRandomCurrentPick))call Rj()endifset Xe=GetUnitTypeId(bj_groupRandomCurrentPick)call GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,Ye)call ForGroup(q4,function lu)endfunctionfunction Ku takes nothing returns nothinglocal real x
local real y
local unit c
set r4=GetOwningPlayer(B4)call GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,x9)set bj_groupRandomCurrentPick=rn(q4)
if(bj_groupRandomCurrentPick==null)thenreturnendifif(yd)thencall Pj("SE:CH:SV "+GetUnitName(B4)+" ->"+GetUnitName(bj_groupRandomCurrentPick))call Rj()endifset x=GetUnitX(bj_groupRandomCurrentPick)set y=GetUnitY(bj_groupRandomCurrentPick)set c=CreateUnit(r4,'e008',x,y,.0)call UnitAddAbility(c,We)call IssuePointOrderById(c,$D0208,x,y)call UnitApplyTimedLife(c,'BTLF',6.)
set c=nullendfunctionfunction Lu takes nothing returns booleanlocal unit u=GetFilterUnit()
local boolean Im=GetWidgetLife(u)>.405 and IsUnitEnemy(u,r4)and IsUnitType(u,UNIT_TYPE_STRUCTURE)and GetPlayerId(GetOwningPlayer(u))<$C and GetUnitTypeId(u)!='hcas' and GetUnitAbilityLevel(u,'A06V')<=0set u=nullreturn Imendfunctionfunction Mu takes nothing returns nothinglocal integer tset r4=GetOwningPlayer(B4)call GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,Ze)set bj_groupRandomCurrentPick=rn(q4)
if(bj_groupRandomCurrentPick==null)thenreturnendifif(yd)thencall Pj("SE:CH:SD "+GetUnitName(B4)+" ->"+GetUnitName(bj_groupRandomCurrentPick))call Rj()endifcall DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\MarkOfChaos\\MarkOfChaosTarget.mdl",GetUnitX(bj_groupRandomCurrentPick),GetUnitY(bj_groupRandomCurrentPick)))
call KillUnit(bj_groupRandomCurrentPick)
set t=me[GetPlayerId(r4)]set Nd[t]=Nd[t]+1call Yr(3,t+1,I2S(Nd[t]))endfunctionfunction Nu takes nothing returns nothinglocal unit c
if(yd)thencall Pj("SE:CH:SR "+GetUnitName(c4)+" ->[no target]")call Rj()endifcall DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\NightElf\\BattleRoar\\RoarCaster.mdl",c4,"origin"))set c=CreateUnit(GetOwningPlayer(c4),'e008',GetUnitX(c4),GetUnitY(c4),.0)call UnitAddAbility(c,'A03R')call IssueImmediateOrderById(c,$D00C4)call UnitApplyTimedLife(c,'BTLF',1.)
set c=nullendfunctionfunction Ou takes nothing returns booleancall Bj(z4,'h094',74.,38.5,28.)call Bj(z4,'h093',160.,-42.,-18.75)call Bj(z4,'h093',250.,3.75,-55.5)call Bj(z4,'h08Z',220.,43.,27.5)
return false
endfunctionfunction Pu takes nothing returns nothingcall lj('h05I',function Hu)call zj('h025','n00L')call lj('h01M',function Ju)call lj('h01W',function Ju)call lj('h01X',function Ju)call zj('h01I','n00A')call zj('h026','z000')call lj('h01F',function Ku)call lj('h01E',function Mu)call zj('h01C','n008')call zj('h01D','n009')call zj('h03G','n00Z')call Fj('h03G',function Ou)call zj('h009','n001')call zj('h007','n000')endfunctionfunction Qu takes nothing returns nothinglocal integer id
set id=GetUnitPointValueByType('h025')set t4[id]=280set u4[id]=280*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h01I')set t4[id]='x'set u4[id]='x'*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h026')set t4[id]=$E6set u4[id]=$E6*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h01C')set t4[id]=$E6set u4[id]=$E6*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h01D')set t4[id]=$A0set u4[id]=$A0*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h03G')set t4[id]=$BEset u4[id]=$BE*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h009')set t4[id]=350set u4[id]=350*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h007')set t4[id]=500set u4[id]=500*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h05I')set t4[id]=$C8set u4[id]=$C8*.09/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h01M')set t4[id]=350set u4[id]=350*.09/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h01W')set t4[id]=$AFset u4[id]=$AF*.09/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h01X')set t4[id]=$AFset u4[id]=$AF*.09/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h01F')set t4[id]=340set u4[id]=340*.09/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h01E')set t4[id]=850set u4[id]=850*.12/ 100.
set v4[id]=false
endfunctionfunction Chaos___RegisterUnitCasts takes nothing returns nothing
call Lj('n00Z','A03S',function Nu)endfunctionfunction Ru takes unit u,integer aj returns unit
local unit n
call ShowUnit(u,false)set n=CreateUnit(GetOwningPlayer(u),aj,GetUnitX(u),GetUnitY(u),GetUnitFacing(u))
call RemoveUnit(u)return n
endfunctionfunction Su takes unit u returns unitlocal integer i=GetRandomInt(0,99)if(i<5)thenset u=Ru(u,'n00M')elseif(i<$E)then
set u=Ru(u,'n00R')else
set i=GetRandomInt(0,3)if(i==0)then
set u=Ru(u,'n00Q')elseif(i==1)then
set u=Ru(u,'n00N')elseif(i==2)then
set u=Ru(u,'n00O')else
set u=Ru(u,'n00P')endifendifset i=GetRandomInt(0,99)
if(i<20)then
call UnitAddAbility(u,'A009')elseif(i<55)then
call UnitAddAbility(u,'A01F')endifset i=GetRandomInt(0,99)
if(i<18)then
call UnitAddAbility(u,'A02B')elseif(i<30)then
call UnitAddAbility(u,'A01B')elseif(i<33)then
call UnitAddAbility(u,'A00Z')elseif(i<43)then
call UnitAddAbility(u,'A07L')endifset i=GetRandomInt(0,99)
if(i<$A)then
call UnitAddAbility(u,'A00U')elseif(i<32)then
call UnitAddAbility(u,'A00T')elseif(i<35)then
call UnitAddAbility(u,'A05J')endifset i=GetRandomInt(0,99)
if(i<25)then
call UnitAddAbility(u,'A01A')endifset i=GetRandomInt(0,99)
if(i<$F)then
call UnitAddAbility(u,'A00V')elseif(i<40)then
call UnitAddAbility(u,'A00D')endifset i=GetRandomInt(0,99)
if(i<8)thencall UnitAddAbility(u,'A01U')elseif(i<16)then
call UnitAddAbility(u,'A010')elseif(i<24)then
call UnitAddAbility(u,'A01P')elseif(i<34)then
call UnitAddAbility(u,'A006')elseif(i<44)then
call UnitAddAbility(u,'A01R')elseif(i<47)then
call UnitAddAbility(u,'A012')endifreturn u
endfunctionfunction Tu takes nothing returns nothingcall Pu()call Qu()call Lj('n00Z','A03S',function Nu)set Ye=Filter(function Iu)set Ze=Filter(function Lu)endfunctionfunction Uu takes nothing returns nothinglocal integer i=0local real x
local real y
local real anset r4=GetOwningPlayer(B4)call GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,x9)set bj_groupRandomConsidered=0set bj_groupRandomCurrentPick=nullcall ForGroup(q4,function GroupPickRandomUnitEnum)if(bj_groupRandomCurrentPick==null)thenreturnendifset x=GetUnitX(bj_groupRandomCurrentPick)set y=GetUnitY(bj_groupRandomCurrentPick)loop
set an=60.*I2R(i)call UnitApplyTimedLife(CreateUnit(r4,df,x+64.*Cos(an*bj_DEGTORAD),y+64.*Sin(an*bj_DEGTORAD),360.-an),'BTLF',9.)
set i=i+1exitwhen i>=6endloopendfunctionfunction Vu takes nothing returns nothingset r4=GetOwningPlayer(B4)call GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,y9)set bj_groupRandomConsidered=0set bj_groupRandomCurrentPick=nullcall ForGroup(q4,function GroupPickRandomUnitEnum)if(bj_groupRandomCurrentPick==null)thenreturnendifcall DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\DeathPact\\DeathPactTarget.mdl",bj_groupRandomCurrentPick,"origin"))if not Hr(bj_groupRandomCurrentPick)then
call UnitDamageTarget(B4,bj_groupRandomCurrentPick,200.,true,false,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_SONIC,WEAPON_TYPE_WHOKNOWS)endifendfunctionfunction Wu takes nothing returns nothinglocal player p=GetOwningPlayer(c4)local real x=GetUnitX(c4)local real y=GetUnitY(c4)local real an=bj_RADTODEG*Atan2(GetUnitY(D4)-y,GetUnitX(D4)-x)-20.local integer i=0local unit c
loop
set c=CreateUnit(p,'e008',x,y,an)call UnitAddAbility(c,'A0AF')call IssuePointOrderById(c,$D024B,x+10.*Cos(an*bj_DEGTORAD),y+10.*Sin(an*bj_DEGTORAD))call UnitApplyTimedLife(c,'BTLF',2.)
set an=an+(10.)set i=i+1exitwhen i>3
endloopset c=nullendfunctionfunction Xu takes nothing returns booleancall Bj(z4,'h04J',191.,.0,.0)return false
endfunctionfunction Yu takes nothing returns booleancall Bj(z4,'h09Z',270.,.0,.0)return false
endfunctionfunction Zu takes nothing returns booleancall SetUnitVertexColor(z4,82,0,$87,'f')
return false
endfunctionfunction dv takes nothing returns booleancall Bj(z4,'h08I',.0,.0,.0)return false
endfunctionfunction ev takes nothing returns nothingcall Ij('n01J',800.)
call zj('h04V','n01I')call zj('h04W','n01H')call zj('h09Y','n027')call Fj('h09Y',function Yu)call zj('h04U','h04I')call Fj('h04U',function Xu)call zj('h04S','n01G')call lj('h04R',function Uu)call zj('h04Q','n01F')call zj('h04P','n01E')call zj('h04O','n01D')call zj('h04M','n01B')call Fj('h04M',function Zu)call zj('h04L','n019')call zj('h04N','n01A')call lj('h04K',function Vu)call Fj('h04K',function dv)endfunctionfunction fv takes nothing returns nothinglocal integer id
set id=GetUnitPointValueByType('h04V')set t4[id]='}'set u4[id]='}'*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h04W')set t4[id]='}'set u4[id]='}'*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h04U')set t4[id]=520set u4[id]=520*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h04S')set t4[id]=$F0set u4[id]=$F0*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h04Q')set t4[id]=300set u4[id]=300*.18/ 100.
set v4[id]=trueset w4[id]=trueset id=GetUnitPointValueByType('h04P')set t4[id]=$96set u4[id]=$96*.18/ 100.
set v4[id]=trueset w4[id]=trueset id=GetUnitPointValueByType('h04O')set t4[id]=$EBset u4[id]=$EB*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h04M')set t4[id]=$A5set u4[id]=$A5*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h04L')set t4[id]=$BEset u4[id]=$BE*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h04N')set t4[id]=$BEset u4[id]=$BE*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('n01J')set t4[id]=$C8set u4[id]=$C8*.08/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h09Y')set t4[id]=500set u4[id]=500*.2/ 100.set v4[id]=false
set id=GetUnitPointValueByType('h04T')set t4[id]=500set u4[id]=500*.12/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h04R')set t4[id]=260set u4[id]=260*.09/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h04K')set t4[id]=275set u4[id]=275*.09/ 100.
set v4[id]=false
endfunctionfunction Corrupted___RegisterUnitCasts takes nothing returns nothing
call Lj('n027','A0AE',function Wu)endfunctionfunction gv takes nothing returns nothingcall ev()call fv()call Lj('n027','A0AE',function Wu)endfunctionfunction hv takes nothing returns booleanlocal unit u=GetFilterUnit()
local boolean Im=IsUnitType(u,UNIT_TYPE_FLYING)and GetWidgetLife(u)>.405 and IsUnitEnemy(u,r4)and IsUnitType(u,UNIT_TYPE_SAPPER)and not IsUnitType(u,UNIT_TYPE_MECHANICAL)set u=nullreturn Imendfunctionfunction iv takes nothing returns nothinglocal real x
local real y
local integer i=0local unit t
local unit c
set r4=GetOwningPlayer(c4)set x=GetUnitX(c4)set y=GetUnitY(c4)call GroupEnumUnitsInRange(q4,GetUnitX(D4),GetUnitY(D4),400.,ef)
loop
set t=FirstOfGroup(q4)set i=i+1exitwhen i>4 or t==nullcall GroupRemoveUnit(q4,t)set c=CreateUnit(GetOwningPlayer(c4),'e008',x,y,.0)call UnitAddAbility(c,'A08U')call IssueTargetOrderById(c,$D007F,t)call UnitApplyTimedLife(c,'BTLF',3.)
endloopset t=nullset c=nullendfunctionfunction jv takes nothing returns nothinglocal unit c
set r4=GetOwningPlayer(B4)call GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,y9)set bj_groupRandomConsidered=0set bj_groupRandomCurrentPick=nullcall ForGroup(q4,function GroupPickRandomUnitEnum)if(bj_groupRandomCurrentPick==null or Hr(bj_groupRandomCurrentPick))then
returnendifset c=CreateUnit(r4,'e008',GetUnitX(bj_groupRandomCurrentPick),GetUnitY(bj_groupRandomCurrentPick),.0)call UnitAddAbility(c,'A018')call UnitShareVision(bj_groupRandomCurrentPick,r4,true)call IssueTargetOrderById(c,$D0216,bj_groupRandomCurrentPick)call UnitShareVision(bj_groupRandomCurrentPick,r4,false)
call UnitApplyTimedLife(c,'BTLF',1.)
set c=bj_groupRandomCurrentPickcall TriggerSleepAction(1.)call Po(c)if(GetUnitTypeId(c)=='h03A')then
call TriggerSleepAction(44.5)call IssueImmediateOrderById(c,$D0057)call TriggerSleepAction(.5)call Po(c)endifset c=nullendfunctionfunction kv takes nothing returns nothinglocal unit c=CreateUnit(GetOwningPlayer(c4),'e008',GetUnitX(c4),GetUnitY(c4),.0)
call UnitAddAbility(c,'A0A8')call IssueTargetOrderById(c,$D0215,D4)call UnitApplyTimedLife(c,'BTLF',2.)
set c=c4
call TriggerSleepAction(.8)call Po(c)set c=nullendfunctionfunction mv takes nothing returns nothinglocal unit c=CreateUnit(GetOwningPlayer(c4),'e008',GetUnitX(c4),GetUnitY(c4),.0)
call UnitAddAbility(c,'A00Y')call IssueTargetOrderById(c,$D0215,D4)call UnitApplyTimedLife(c,'BTLF',2.)
set c=c4
call TriggerSleepAction(.8)call Po(c)set c=nullendfunctionfunction nv takes nothing returns booleancall SetUnitVertexColor(z4,$FF,$FF,$FF,0)call Bj(z4,'h08Z',250.,46.,33.5)
call Bj(z4,'h090',270.,-17.,18.)
return false
endfunctionfunction ov takes nothing returns booleancall SetUnitVertexColor(z4,$FF,$FF,$FF,0)call Bj(z4,'h08Z',250.,46.,33.5)
call Bj(z4,'h091',270.,-17.,18.)
call Bj(z4,'h08Z',350.,-22.,-40.)return false
endfunctionfunction pv takes nothing returns nothingcall lj('h00Z',function jv)call Ij('h014',675.)
call zj('h09X','h07B')call zj('h00X','h00W')call zj('h00V','h00U')call zj('h00T','n006')call zj('h03F','n00Y')call zj('h08X','n022')call Fj('h08X',function nv)call zj('h08Y','n023')call Fj('h08Y',function ov)call zj('h070','e005')call zj('h06Y','n01Y')endfunctionfunction qv takes nothing returns nothinglocal integer id
set id=GetUnitPointValueByType('h09X')set t4[id]=360set u4[id]=360*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h00V')set t4[id]=275set u4[id]=275*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h00T')set t4[id]=$DCset u4[id]=$DC*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h03F')set t4[id]=$E6set u4[id]=$E6*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h08X')set t4[id]=$B4set u4[id]=$B4*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h08Y')set t4[id]=$C8set u4[id]=$C8*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h070')set t4[id]=350set u4[id]=350*.18/ 100.
set v4[id]=trueset w4[id]=trueset id=GetUnitPointValueByType('h06Y')set t4[id]=310set u4[id]=310*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h00Z')set t4[id]=$F0set u4[id]=$F0*.12/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h00X')set t4[id]=440set u4[id]=440*.2/ 100.set v4[id]=false
set id=GetUnitPointValueByType('h059')set t4[id]=650set u4[id]=650*.12/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h005')set t4[id]=$FAset u4[id]=$FA*.12/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h014')set t4[id]=$FAset u4[id]=$FA*.08/ 100.
set v4[id]=false
endfunctionfunction rv takes nothing returns nothingcall Lj('n01Y','A08V',function iv)call Lj('h07B','A0A7',function kv)call Lj('h00W','A00X',function mv)endfunctionfunction sv takes player p returns nothinglocal integer id=me[GetPlayerId(p)]set ld[id]=ld[id]+(20)endfunctionfunction tv takes unit u returns nothing
local integer id=me[GetPlayerId(GetOwningPlayer(u))]
set ld[id]=ld[id]-(20)endfunctionfunction uv takes nothing returns nothingcall pv()call qv()call rv()set ef=Filter(function hv)endfunctionfunction vv takes nothing returns nothinglocal unit u=GetEnumUnit()local unit c=CreateUnit(r4,'e008',GetUnitX(u),GetUnitY(u),.0)call UnitAddAbility(c,'A016')call IssueTargetOrderById(c,$D0085,u)call UnitApplyTimedLife(c,'BTLF',1.)
set c=nullset u=nullendfunctionfunction wv takes nothing returns nothinglocal real x=GetUnitX(B4)local real y=GetUnitY(B4)call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Other\\HowlOfTerror\\HowlCaster.mdl",x,y))set r4=GetOwningPlayer(B4)call GroupEnumUnitsInRange(q4,x,y,500.,gf)call ForGroup(q4,function vv)endfunctionfunction xv takes nothing returns nothinglocal unit u=c4call IssueTargetOrderById(u,$D0062,D4)call TriggerSleepAction(1.)call Po(u)set u=nullendfunctionfunction yv takes nothing returns booleanlocal unit u=GetFilterUnit()
local boolean Im=IsUnitAlly(u,r4)and GetWidgetLife(u)<.405 and not IsUnitType(u,UNIT_TYPE_MECHANICAL)set u=nullreturn Imendfunctionfunction zv takes nothing returns nothinglocal unit u=c4call IssueTargetOrderById(u,$D0062,D4)call UnitAddAbility(D4,'A03L')call TriggerSleepAction(1.)set r4=GetOwningPlayer(u)call GroupEnumUnitsInRange(q4,GetUnitX(u),GetUnitY(u),900.,hf)if(FirstOfGroup(q4)!=null)thencall IssueImmediateOrderById(u,$D007E)call TriggerSleepAction(1.)endifcall Po(u)set u=nullendfunctionfunction Av takes nothing returns nothinglocal unit u=CreateUnit(GetOwningPlayer(c4),'e008',GetUnitX(c4),GetUnitY(c4),.0)
call UnitAddAbility(u,'A00I')call IssueImmediateOrderById(u,$D022E)call UnitApplyTimedLife(u,'BTLF',1.)
set u=c4
call UnitRemoveAbility(u,'A00F')
call UnitAddAbility(u,'A07I')call TriggerSleepAction(.3)call br(u)call TriggerSleepAction(5.)if(GetUnitAbilityLevel(u,'A00F')<=0)then
call IssueImmediateOrderById(u,$D0019)call TriggerSleepAction(6.6)
if(GetUnitAbilityLevel(u,'A00F')<=0)then
call UnitAddAbility(u,'A00F')call UnitRemoveAbility(u,'A07I')
call UnitAddAbility(u,'A0EZ')call Po(u)endifendifset u=nullendfunctionfunction av takes nothing returns booleancall SetUnitVertexColor(z4,$FF,$FF,$FF,0)call Bj(z4,'h0A0',170.,31.25,-43.)call Bj(z4,'h0A0',80.,-38.,-40.25)call Bj(z4,'h0A0',350.,-30.25,30.)call Bj(z4,'h08Z',220.,43.,27.5)
return false
endfunctionfunction Bv takes nothing returns nothingcall zj('h000','hfoo')call zj('h039','h03A')call zj('h003','hrif')call zj('h0A1','h05C')call Fj('h0A1',function av)call zj('h05D','h0A2')call zj('h004','hmtm')call Ij('h006',950.)
call zj('h00K','n005')call Ij('h010',500.)
call lj('h010',function wv)call zj('h015','h016')call zj('h037','h03B')call zj('h038','h03C')endfunctionfunction bv takes nothing returns nothinglocal integer id
set id=GetUnitPointValueByType('h037')set t4[id]=265set u4[id]=265*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h015')set t4[id]=$FAset u4[id]=$FA*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h00K')set t4[id]=300set u4[id]=300*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h004')set t4[id]=$D2set u4[id]=$D2*.18/ 100.
set v4[id]=trueset w4[id]=trueset id=GetUnitPointValueByType('h003')set t4[id]=$8Cset u4[id]=$8C*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h000')set t4[id]='d'set u4[id]='d'*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h039')set t4[id]=$AFset u4[id]=$AF*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h0A1')set t4[id]=$A0set u4[id]=$A0*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h05D')set t4[id]=$B4set u4[id]=$B4*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h038')set t4[id]=260set u4[id]=260*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h001')set t4[id]=$C8set u4[id]=$C8*.09/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h006')set t4[id]=$96set u4[id]=$96*.08/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h010')set t4[id]=$E1set u4[id]=$E1*.12/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h05G')set t4[id]=550set u4[id]=550*.12/ 100.
set v4[id]=false
endfunctionfunction Cv takes nothing returns nothingcall Lj('h03B','A03K',function xv)call Lj('h03C','A03K',function zv)call Lj('n005','A00K',function Av)endfunctionfunction cv takes unit u returns nothing
local rect r=Ld[me[GetPlayerId(GetOwningPlayer(u))]]
call IssuePointOrderById(u,$D0010,GetRandomReal(GetRectMinX(r),GetRectMaxX(r)),GetRandomReal(GetRectMinY(r),GetRectMaxY(r)))
set r=nullendfunctionfunction Dv takes nothing returns nothingcall cv(GetEnumUnit())endfunctionfunction Ev takes nothing returns nothingcall ForGroup(ff,function Dv)endfunctionfunction Fv takes unit u returns nothing
call GroupAddUnit(Jd[me[GetPlayerId(GetOwningPlayer(u))]],u)
endfunctionfunction Gv takes unit u returns nothing
call GroupRemoveUnit(Jd[me[GetPlayerId(GetOwningPlayer(u))]],u)endfunctionfunction Hv takes nothing returns booleanlocal unit u=GetFilterUnit()
local boolean Im=GetWidgetLife(u)>.405 and IsUnitAlly(u,r4)and IsUnitType(u,UNIT_TYPE_SAPPER)set u=nullreturn Imendfunctionfunction Iv takes nothing returns nothingcall Bv()call bv()call Cv()call TimerStart(CreateTimer(),9.,true,function Ev)set hf=Filter(function yv)set gf=Filter(function Hv)endfunctionfunction lv takes integer x returns real
if(x<$A)then
return pf[x]*.25+1.endifreturn((((I2R(x-9))*.25)+5.11)*.25)+1.endfunctionfunction Jv takes integer dk returns realreturn(mf[(dk)]*10.)*lv(ge[dk])endfunctionfunction Kv takes integer dk returns integer
local real i=Jv(dk)local real j=.0local real k=.0loop
exitwhen(i<kf)or(k>=8)set i=i-kfset j=j+kf*(1.-k/ 10.)set k=k+1.endloopset j=j+i*(1.-k/ 10.)return R2I(j*i8[me[dk]])
endfunctionfunction Lv takes integer dk,unit u returns nothinglocal real l=u4[GetUnitPointValue(u)]local integer aj=GetHandleId(u)set mf[dk]=mf[dk]+(l)call SaveReal(O9,aj,$A,LoadReal(O9,aj,$A)+l)
endfunctionfunction Mv takes integer dk,unit u returns nothingset mf[dk]=mf[dk]-(LoadReal(O9,GetHandleId(u),$A))endfunctionfunction Nv takes integer dk,unit u returns nothingset mf[dk]=mf[dk]+(LoadReal(O9,GetHandleId(u),$A))endfunctionfunction Ov takes nothing returns nothingset of=of+(" "+I2S(nf[GetPlayerId(GetEnumPlayer())]))endfunctionfunction Pv takes nothing returns nothinglocal player p=GetEnumPlayer()local integer id=GetPlayerId(p)local integer ws=Kv(id)set Vd[id]=Vd[id]+(ws)call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)+ws)call SetPlayerState(p,PLAYER_STATE_GOLD_GATHERED,GetPlayerState(p,PLAYER_STATE_GOLD_GATHERED)+ws)set nf[id]=wsset qf=qf+(ws)endfunctionfunction Qv takes nothing returns nothinglocal integer i=0set qf=0
call ForForce(ie,function Pv)call Yr(4,1,I2S(qf))
set qf=0
call ForForce(je,function Pv)call Yr(4,2,I2S(qf))
loop
if(nf[i]>0)thenset of="Income: |cffFFFF00"+I2S(nf[i])if(ne[i]!=null)thencall ForForce(ne[i],function Ov)
endifcall DisplayTextToPlayer(Player(i),0,0,of)endifset i=i+1exitwhen i>$Bendloopendfunctionfunction Rv takes player p returns nothinglocal integer dk=GetPlayerId(p)local string s="Your basic income is |cffFFFF00"+I2S(R2I((mf[(dk)]*10.)))set s=s+("|r. Your Treasure Box income multiplier is |cffFFFF00"+R2SW(lv(ge[dk]),1,2))set s=s+("|r, boosting your income to |cffFFFF00"+I2S(R2I(Jv(dk))))set s=s+("|r. After paying taxes your income is |cffFFFF00"+I2S(nf[dk])+"|r.")call DisplayTextToPlayer(p,.0,.0,s)endfunctionfunction Sv takes player p returns nothinglocal integer id=GetPlayerId(p)call DisplayTimedTextToPlayer(p,.0,.0,15.,"-------- Current statistics: --------")call DisplayTimedTextToPlayer(p,.0,.0,15.,"Income: |cffFFFF00"+I2S(Kv(id))+"|r (|cffFFFF00"+I2S(Vd[id])+"|r gold in total)")
if(Cd>0)then
call DisplayTimedTextToPlayer(p,.0,.0,15.,"Coins collected: |cffFFFF00"+I2S(Yd[id])+"|r (|cffFFFF00"+I2S(Zd[id])+"|r gold in total)")endifcall DisplayTimedTextToPlayer(p,.0,.0,15.,"Units killed: |cffFFFF00"+I2S(Sd[id])+"|r (|cffFFFF00"+I2S(GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)+ee[id]+fe[id]-de[id]-Vd[id]-Zd[id]-$FA)+"|r gold in total)")call DisplayTimedTextToPlayer(p,.0,.0,15.,"Units trained: |cffFFFF00"+I2S(Rd[id])+"|r (|cffFFFF00"+I2S(Td[id])+"|r creepspawning buildings in total)")call DisplayTimedTextToPlayer(p,.0,.0,15.,"Specials built: |cffFFFF00"+I2S(Ud[id])+"|r")
call DisplayTimedTextToPlayer(p,.0,.0,15.,"Rescue Strike damage: |cffFFFF00"+I2S(Wd[id])+"|r (|cffFFFF00"+I2S(Xd[id])+"|r units killed)")call DisplayTimedTextToPlayer(p,.0,.0,15.,"----------------------------------------------------")endfunctionfunction Tv takes nothing returns integerlocal integer j=0local integer i=1loop
if(Wd[i]>Wd[j])thenset j=iendifset i=i+1exitwhen i>$Bendloopreturn j
endfunctionfunction Uv takes nothing returns integerlocal integer j=0local integer i=1loop
if(Ud[i]>Ud[j])thenset j=iendifset i=i+1exitwhen i>$Bendloopreturn Ud[j]
endfunctionfunction Vv takes nothing returns integerlocal integer j=0local integer i=0loop
if(Td[j]>Td[i])thenset i=jendifset j=j+1exitwhen j>$Bendloopreturn j
endfunctionfunction Wv takes nothing returns integerlocal integer j=0local integer i=1loop
if(Sd[i]>Sd[j])thenset j=iendifset i=i+1exitwhen i>$Bendloopreturn j
endfunctionfunction Xv takes nothing returns integerlocal integer j=0local integer i=1loop
if(Yd[i]>Yd[j])thenset j=iendifset i=i+1exitwhen i>$Bendloopreturn j
endfunctionfunction Yv takes nothing returns integerlocal integer j=0local integer v=Kv(0)local integer i=1local integer tloop
set t=Kv(i)if(t>v)thenset v=tset j=iendifset i=i+1exitwhen i>$Bendloopreturn j
endfunctionfunction Zv takes nothing returns nothinglocal string slocal string tlocal integer glocal integer ilocal player pcall DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,20.,"|cffFFFF80-----------  End of round statistics  -----------|r")call DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,20.,"Round time: "+ds())set g=Kv(Yv())set s=""
set i=0loop
if(Kv(i)==g)then
if(s=="")thenset s=pe[i]set t=I2S(Vd[i])
else
set s=s+", "+pe[i]set t=t+"|r, |cffFFFF00"+I2S(Vd[i])endifendifset i=i+1exitwhen i>$Bendloopcall DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,20.,"Highest income: "+s+" - |cffFFFF00"+I2S(g)+"|r (|cffFFFF00"+t+"|r gold in total)")if(Cd>0)then
set g=Xv()set s=""
set i=0loop
set p=Player(i)if(Yd[i]==Yd[g])then
if(s=="")thenset s=pe[i]set t=I2S(Zd[i])
else
set s=s+", "+pe[i]set t=t+"|r, |cffFFFF00"+I2S(Zd[i])endifendifset i=i+1exitwhen i>$Bendloopcall DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,20.,"Most coins collected: "+s+" - |cffFFFF00"+I2S(Yd[g])+"|r (|cffFFFF00"+t+"|r gold in total)")endifset g=Wv()set s=""
set i=0loop
set p=Player(i)if(Sd[i]==Sd[g])then
if(s=="")thenset s=pe[i]set t=I2S(GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)+ee[i]+fe[i]-de[i]-Vd[i]-Zd[i]-$FA)else
set s=s+", "+pe[i]set t=t+"|r, |cffFFFF00"+I2S(GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)+ee[i]+fe[i]-de[i]-Vd[i]-Zd[i]-$FA)
endifendifset i=i+1exitwhen i>$Bendloopset s="Most units killed: "+s+" - |cffFFFF00"+I2S(Sd[g])+"|r"if(od)thencall DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,20.,s)
else
call DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,20.,s+" (|cffFFFF00"+t+"|r gold in total)")endifset g=Td[Vv()]set s=""
set i=0loop
if(Td[i]==Td[g])then
if(s=="")thenset s=pe[i]set t=I2S(Rd[i])
else
set s=s+", "+pe[i]set t=t+"|r, |cffFFFF00"+I2S(Rd[i])endifendifset i=i+1exitwhen i>$Bendloopcall DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,20.,"Most creepspawning buildings: "+s+" - |cffFFFF00"+I2S(Td[g])+"|r (|cffFFFF00"+t+"|r units in total)")
if(pd)thenset g=Uv()set s=""
set i=0loop
if(Ud[i]==g)then
if(s=="")thenset s=pe[i]else
set s=s+", "+pe[i]endifendifset i=i+1exitwhen i>$Bendloopcall DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,20.,"Most special buildings: "+s+" - |cffFFFF00"+I2S(g)+"|r")endifset g=Tv()call DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,20.,"Most damage dealt with RS: "+pe[g]+" - |cffFFFF00"+I2S(Wd[g])+"|r (|cffFFFF00"+I2S(Xd[g])+"|r units killed)")
call DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,20.,"|cffFFFF80--------------------------------------------------------------------|r")endfunctionfunction dw takes nothing returns nothingset pf[0]=.0
set pf[1]=1.
set pf[2]=1.85set pf[3]=2.57set pf[4]=3.18set pf[5]=3.7set pf[6]=4.14set pf[7]=4.52set pf[8]=4.84set pf[9]=5.11set i8[0]=1.
set i8[1]=1.
endfunctionfunction ew takes nothing returns booleanlocal unit u=GetFilterUnit()
local boolean Im=GetWidgetLife(u)>.405 and IsUnitAlly(u,r4)and IsUnitType(u,UNIT_TYPE_SAPPER)and GetUnitAbilityLevel(u,'Avul')<=0 and GetUnitAbilityLevel(u,'A09L')<=0set u=nullreturn Imendfunctionfunction fw takes nothing returns nothinglocal unit u
set r4=GetOwningPlayer(B4)set bj_groupRandomCurrentPick=rn(q4)
if(bj_groupRandomCurrentPick==null)thenreturnendifif(yd)thencall Pj("SE:MC:SA "+GetUnitName(B4)+" ->"+GetUnitName(bj_groupRandomCurrentPick))call Rj()endifcall UnitAddAbility(bj_groupRandomCurrentPick,'A09L')set u=B4
call SetUnitAnimation(u,"death")
call TriggerSleepAction(.3)call SetUnitAnimation(u,"stand")
set u=nullendfunctionfunction gw takes nothing returns booleanlocal unit u=GetFilterUnit()
local boolean Im=GetWidgetLife(u)>.405 and IsUnitAlly(u,r4)and IsUnitType(u,UNIT_TYPE_SAPPER)and GetUnitAbilityLevel(u,'Avul')<=0set u=nullreturn Imendfunctionfunction hw takes nothing returns nothinglocal unit u
set r4=GetOwningPlayer(B4)call GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,sf)set bj_groupRandomCurrentPick=rn(q4)
if(bj_groupRandomCurrentPick==null)thencall GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,tf)set bj_groupRandomCurrentPick=rn(q4)
if(bj_groupRandomCurrentPick==null)thenreturnendifelse
call UnitAddAbility(bj_groupRandomCurrentPick,'A09L')endifif(yd)thencall Pj("SE:MC:SA2 "+GetUnitName(B4)+" ->"+GetUnitName(bj_groupRandomCurrentPick))call Rj()endifcall SetUnitAbilityLevel(bj_groupRandomCurrentPick,'A09L',2)
set u=B4
call SetUnitAnimation(u,"death")
call TriggerSleepAction(.3)call SetUnitAnimation(u,"stand")
set u=nullendfunctionfunction iw takes nothing returns nothinglocal player p=GetOwningPlayer(c4)local real x=GetUnitX(D4)local real y=GetUnitY(D4)local real sx=GetUnitX(c4)local real sy=GetUnitY(c4)local unit c=CreateUnit(p,'h09Q',sx,sy,.0)local unit t
if(yd)thencall Pj("SE:MC:SG "+GetUnitName(c4)+" ->[no target]")call Rj()endifcall IssuePointOrderById(c,$D0010,x,y)call UnitApplyTimedLife(c,'BTLF',3.)
set sx=sx-(x)set sy=sy-(y)call TriggerSleepAction(SquareRoot(sx*sx+sy*sy)/ 700.)set c=CreateUnit(p,'e008',x,y,.0)call UnitAddAbility(c,'A09E')call IssueImmediateOrderById(c,$D0080)call UnitApplyTimedLife(c,'BTLF',3.)
set r4=p
call GroupEnumUnitsInRange(q4,x,y,300.,x9)loop
set t=FirstOfGroup(q4)exitwhen t==null
call GroupRemoveUnit(q4,t)set sx=GetUnitState(t,UNIT_STATE_MANA)if(sx>.0)thenset sy=RMinBJ(sx,'d')call SetUnitState(t,UNIT_STATE_MANA,sx-sy)call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\Feedback\\SpellBreakerAttack.mdl",t,"origin"))call UnitDamageTarget(c,t,sy,true,false,ATTACK_TYPE_CHAOS,DAMAGE_TYPE_NORMAL,WEAPON_TYPE_WHOKNOWS)endifendloopset c=nullendfunctionfunction jw takes nothing returns nothinglocal player p=GetOwningPlayer(c4)local real sx=GetUnitX(c4)local real sy=GetUnitY(c4)local real r=GetRandomReal(70.,300.)
local real y=GetRandomReal(.0,360.)*bj_DEGTORADlocal real x=sx+r*Cos(y)
local unit c=CreateUnit(p,'h09M',sx,sy,.0)if(yd)thencall Pj("SE:MC:SM "+GetUnitName(c4)+" ->[no target]")call Rj()endifset y=sy+r*Sin(y)call IssuePointOrderById(c,$D0010,x,y)call UnitApplyTimedLife(c,'BTLF',3.)
call TriggerSleepAction(r/ 700.)
call CreateUnit(p,'n025',x,y,.0)
set c=nullendfunctionfunction kw takes nothing returns booleanlocal unit u=GetFilterUnit()
local boolean fl=GetWidgetLife(u)>=.405 and IsUnitType(u,UNIT_TYPE_STRUCTURE)and GetUnitTypeId(u)!='h09T' and(GetUnitAbilityLevel(u,'Bfrz')>0 or GetUnitAbilityLevel(u,'B00M')>0)and GetRandomInt(0,99)<50set u=nullreturn flendfunctionfunction mw takes nothing returns nothinglocal unit u=GetEnumUnit()call UnitRemoveAbility(u,'Bfrz')
call UnitRemoveAbility(u,'B00M')
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Orc\\MirrorImage\\MirrorImageDeathCaster.mdl",GetUnitX(u),GetUnitY(u)))set u=nullendfunctionfunction nw takes nothing returns nothinglocal unit u=GetEnumUnit()call GroupEnumUnitsInRange(q4,GetUnitX(u),GetUnitY(u),252.,uf)call ForGroup(q4,function mw)set u=nullendfunctionfunction ow takes nothing returns nothingcall ForGroup(rf,function nw)endfunctionfunction pw takes nothing returns booleancall Bj(z4,'h09V',270.,.0,.0)call Bj(z4,'h09U',90.,20.,.0)call Bj(z4,'h09U',.0,.0,-20.)call Bj(z4,'h09U',270.,-20.,.0)call Bj(z4,'h09U',180.,.0,20.)return false
endfunctionfunction qw takes nothing returns booleancall Bj(z4,'h09R',300.,3.5,65.25)call Bj(z4,'h09R',70.,-16.5,-51.)call Bj(z4,'h09N',238.,36.,53.)call Bj(z4,'h09O',314.,-38.,-39.5)return false
endfunctionfunction rw takes nothing returns booleancall Bj(z4,'h09O',279.,-45.5,24.75)call Bj(z4,'h09N',300.,31.,-32.25)return false
endfunctionfunction sw takes nothing returns booleancall Bj(z4,'h09K',238.,.0,.0)return false
endfunctionfunction tw takes nothing returns booleancall Bj(z4,'h09F',2.,36.25,41.)call Bj(z4,'h09F',2.,33.25,-33.5)call Bj(z4,'h09F',2.,-46.25,10.75)call Bj(z4,'h09A',45.,-5.25,17.)
return false
endfunctionfunction uw takes nothing returns booleancall Bj(z4,'h09D',225.,35.,-29.75)call Bj(z4,'h09D',45.,20.,22.5)call Bj(z4,'h09D',225.,-31.,26.25)call Bj(z4,'h09G',23.,-25.25,-36.)return false
endfunctionfunction vw takes nothing returns booleancall Bj(z4,'h09C',33.,36.25,36.5)call Bj(z4,'h09C',13.,21.,-47.5)
call Bj(z4,'h09C',319.,-46.25,11.75)
return false
endfunctionfunction ww takes nothing returns booleancall Bj(z4,'h09C',33.,36.25,36.5)call Bj(z4,'h09C',13.,21.,-47.5)
call Bj(z4,'h09C',319.,-46.25,11.75)
call Bj(z4,'h09E',348.,-6.5,9.)return false
endfunctionfunction xw takes nothing returns booleancall Bj(z4,'h09K',45.,.0,.0)
return false
endfunctionfunction yw takes nothing returns booleancall Bj(z4,'h096',180.,-45.75,21.75)
call Bj(z4,'h096',110.,9.,-62.5)
return false
endfunctionfunction zw takes nothing returns nothingcall Fj('h09T',function pw)call Ij('h09T',180.)
call zj('h069','n01U')call Fj('h069',function qw)call lj('h06J',function fw)call lj('h05R',function hw)call zj('h05T','z002')call zj('h09P','z003')call Fj('h09P',function rw)call zj('h05U','n01T')call zj('h05M','n01V')call zj('h05J','h06Q')call zj('h09L','h06R')call Fj('h09L',function sw)call zj('h05V','n01X')call zj('h097','n024')call Fj('h097',function yw)call zj('h05X','h06T')call zj('h09J','h06U')call Fj('h09J',function tw)call zj('h09I','h099')call Fj('h09I',function uw)call zj('h09B','h06S')call Fj('h09B',function vw)call zj('h09H','h098')call Fj('h09H',function ww)call Ij('h05L',600.)
call Fj('h05L',function xw)endfunctionfunction Aw takes nothing returns nothinglocal integer id
set id=GetUnitPointValueByType('h05T')set t4[id]=$DCset u4[id]=$DC*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h09P')set t4[id]=$8Cset u4[id]=$8C*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h05U')set t4[id]=375set u4[id]=375*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h05M')set t4[id]=$C8set u4[id]=$C8*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h05J')set t4[id]=$A0set u4[id]=$A0*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h09L')set t4[id]=$B4set u4[id]=$B4*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h05V')set t4[id]=270set u4[id]=270*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h05X')set t4[id]=$B4set u4[id]=$B4*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h09J')set t4[id]=$96set u4[id]=$96*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h09I')set t4[id]=$C8set u4[id]=$C8*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h09B')set t4[id]=$C8set u4[id]=$C8*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h09H')set t4[id]=$96set u4[id]=$96*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h09T')set t4[id]=340set u4[id]=340*.12/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h069')set t4[id]=$FAset u4[id]=$FA*.12/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h06J')set t4[id]=$BEset u4[id]=$BE*.12/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h05R')set t4[id]=$8Cset u4[id]=$8C*.12/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h097')set t4[id]=500set u4[id]=500*.2/ 100.set v4[id]=false
set id=GetUnitPointValueByType('h05L')set t4[id]=$F0set u4[id]=$F0*.08/ 100.
set v4[id]=false
endfunctionfunction aw takes nothing returns nothingcall Lj('z003','A09D',function iw)call Lj('h06U','A095',function jw)endfunctionfunction Bw takes nothing returns nothingcall zw()call Aw()call aw()set tf=Filter(function gw)set sf=Filter(function ew)set uf=Filter(function kw)call TimerStart(CreateTimer(),4.,true,function ow)endfunctionfunction bw takes nothing returns nothinglocal unit c
set r4=GetOwningPlayer(B4)call GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,y9)set bj_groupRandomConsidered=0set bj_groupRandomCurrentPick=nullcall ForGroup(q4,function GroupPickRandomUnitEnum)if(bj_groupRandomCurrentPick==null)thenreturnendifset c=CreateUnit(GetOwningPlayer(B4),'e008',GetUnitX(B4),GetUnitY(B4),.0)call UnitAddAbility(c,'A00P')call UnitShareVision(bj_groupRandomCurrentPick,r4,true)call IssueTargetOrderById(c,$D00FA,bj_groupRandomCurrentPick)call UnitShareVision(bj_groupRandomCurrentPick,r4,false)
call UnitApplyTimedLife(c,'BTLF',20.)set c=nullendfunctionfunction Cw takes nothing returns nothinglocal unit c
set r4=GetOwningPlayer(B4)call GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,y9)set bj_groupRandomConsidered=0set bj_groupRandomCurrentPick=nullcall ForGroup(q4,function GroupPickRandomUnitEnum)if(bj_groupRandomCurrentPick==null or Hr(bj_groupRandomCurrentPick))then
returnendifset c=CreateUnit(GetOwningPlayer(B4),'e008',GetUnitX(B4),GetUnitY(B4),.0)call UnitAddAbility(c,'A00N')call UnitShareVision(bj_groupRandomCurrentPick,r4,true)call IssueTargetOrderById(c,$D0265,bj_groupRandomCurrentPick)call UnitShareVision(bj_groupRandomCurrentPick,r4,false)
call UnitApplyTimedLife(c,'BTLF',1.)
set c=nullendfunctionfunction cw takes nothing returns nothinglocal unit c
set r4=GetOwningPlayer(B4)call GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,x9)set bj_groupRandomConsidered=0set bj_groupRandomCurrentPick=nullcall ForGroup(q4,function GroupPickRandomUnitEnum)if(bj_groupRandomCurrentPick==null)thenreturnendifset c=CreateUnit(r4,'e008',GetUnitX(bj_groupRandomCurrentPick),GetUnitY(bj_groupRandomCurrentPick),.0)call UnitAddAbility(c,'A00B')call IssueImmediateOrderById(c,$D0080)call UnitApplyTimedLife(c,'BTLF',1.)
set c=nullendfunctionfunction Dw takes nothing returns nothinglocal unit c=CreateUnit(GetOwningPlayer(c4),'e008',GetUnitX(c4),GetUnitY(c4),.0)
call UnitAddAbility(c,'A02T')call IssueTargetOrderById(c,$D008F,D4)call UnitApplyTimedLife(c,'BTLF',2.)
set c=c4
call TriggerSleepAction(1.)if(IssueImmediateOrderById(c,$D009E))thencall TriggerSleepAction(1.)endifcall Po(c)set c=nullendfunctionfunction Ew takes nothing returns nothingcall zj('h01Z','n00S')call lj('h00N',function bw)call lj('h00M',function Cw)call zj('h00J','n004')call zj('h05F','n01P')call zj('h01B','n007')call lj('h00I',function cw)call zj('h020','n00I')call zj('h021','n00J')call zj('h022','n00K')call Ij('h00G',700.)
call zj('h01Y','n00H')call zj('h00F','n002')call zj('h032','n00X')endfunctionfunction Fw takes nothing returns nothinglocal integer id
set id=GetUnitPointValueByType('h01Z')set t4[id]=350set u4[id]=350*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h00J')set t4[id]=$AFset u4[id]=$AF*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h01B')set t4[id]=280set u4[id]=280*.18/ 100.
set v4[id]=trueset w4[id]=trueset id=GetUnitPointValueByType('h020')set t4[id]=$AAset u4[id]=$AA*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h021')set t4[id]=$B4set u4[id]=$B4*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h022')set t4[id]=$BEset u4[id]=$BE*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h01Y')set t4[id]=$E6set u4[id]=$E6*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h00F')set t4[id]=$FAset u4[id]=$FA*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h032')set t4[id]=$C8set u4[id]=$C8*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h00N')set t4[id]=750set u4[id]=750*.09/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h00I')set t4[id]=360set u4[id]=360*.18/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h00M')set t4[id]=310set u4[id]=310*.18/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h00G')set t4[id]=$FAset u4[id]=$FA*.18/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h05F')set t4[id]=725set u4[id]=725*.2/ 100.set v4[id]=false
endfunctionfunction Naga___RegisterUnitCasts takes nothing returns nothingcall Lj('n00S','A02U',function Dw)endfunctionfunction Gw takes nothing returns nothingcall Ew()call Fw()call Lj('n00S','A02U',function Dw)endfunctionfunction Hw takes nothing returns booleanlocal unit u=GetFilterUnit()
local boolean b=GetWidgetLife(u)>.405 and IsUnitType(u,UNIT_TYPE_GROUND)and IsUnitType(u,UNIT_TYPE_SAPPER)set u=nullreturn b
endfunctionfunction Iw takes nothing returns nothinglocal player p=GetOwningPlayer(c4)local integer i=0local real x=GetUnitX(c4)local real y=GetUnitY(c4)local destructable array lwlocal real anlocal real r
local unit u
local real x2local real y2call GroupEnumUnitsInRange(q4,x,y,144.,xf)loop
set u=FirstOfGroup(q4)exitwhen u==null
call GroupRemoveUnit(q4,u)if(u!=c4)thenset r=GetRandomReal(160.,218.)set an=(GetRandomReal(135.,234.)+180.*me[GetPlayerId(GetOwningPlayer(u))])*bj_DEGTORADset x2=x+r*Cos(an)set y2=y+r*Sin(an)call SetUnitX(u,x2)call SetUnitY(u,y2)call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\MassTeleport\\MassTeleportCaster.mdl",x2,y2))
endifendloopset u=c4
loop
set an=72.*I2R(i)set lw[i]=CreateDestructable('YTct',x+120.*Cos(an*bj_DEGTORAD),y+120.*Sin(an*bj_DEGTORAD),an,1.,0)set i=i+1exitwhen i>=5endloopcall TriggerSleepAction(3.)if(GetWidgetLife(u)>.405)thenset i=0loop
if(GetWidgetLife(lw[i])>.405)thencall KillDestructable(lw[i])
set an=72.*I2R(i)set x2=x+112.*Cos(an*bj_DEGTORAD)set y2=y+112.*Sin(an*bj_DEGTORAD)call UnitApplyTimedLife(CreateUnit(p,'e00D',x2,y2,an),'B021',20.)call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\NightElf\\EntBirthTarget\\EntBirthTarget.mdl",x2,y2))
endifset i=i+1exitwhen i>=5endloopcall Po(u)else
set i=0loop
call KillDestructable(lw[i])
set i=i+1exitwhen i>=5endloopendifcall TriggerSleepAction(3.)set i=0loop
call RemoveDestructable(lw[i])set lw[i]=nullset i=i+1exitwhen i>=5endloopset u=nullendfunctionfunction Jw takes nothing returns nothinglocal unit c=CreateUnit(GetOwningPlayer(c4),'e008',GetUnitX(c4),GetUnitY(c4),.0)
call UnitAddAbility(c,'A0AW')call IssueTargetOrderById(c,$D00C0,D4)call UnitApplyTimedLife(c,'BTLF',2.)
set c=c4
call TriggerSleepAction(.8)call Po(c)set c=nullendfunctionfunction Kw takes nothing returns nothinglocal unit c=CreateUnit(GetOwningPlayer(c4),'e008',GetUnitX(c4),GetUnitY(c4),.0)
call UnitAddAbility(c,'A0AW')call IssueTargetOrderById(c,$D00C0,D4)call UnitApplyTimedLife(c,'BTLF',2.)
set c=c4
call TriggerSleepAction(.8)call Po(c)set c=nullendfunctionfunction Lw takes nothing returns nothinglocal unit u=c4call IssueImmediateOrderById(u,$D0228)call TriggerSleepAction(.6)call Po(u)set u=nullendfunctionfunction Mw takes nothing returns booleanlocal unit u=GetFilterUnit()
local real r=GetWidgetLife(u)local boolean Im=r>.405 and IsUnitAlly(u,r4)and IsUnitType(u,UNIT_TYPE_SAPPER)and GetUnitAbilityLevel(u,'A08C')<=0 and GetUnitAbilityLevel(u,'Bhea')<=0 and GetUnitState(u,UNIT_STATE_MAX_LIFE)-r>200.set u=nullreturn Imendfunctionfunction Nw takes nothing returns nothinglocal unit u=c4call UnitAddAbility(D4,'AId2')call DestroyEffect(AddSpecialEffectTarget("mdx\\sfx\\sin2.mdx",D4,"overhead"))call TriggerSleepAction(.6)call Po(u)set u=nullendfunctionfunction Ow takes nothing returns nothinglocal unit u=c4call UnitAddAbility(D4,'AId3')call DestroyEffect(AddSpecialEffectTarget("mdx\\sfx\\sin2.mdx",D4,"overhead"))call TriggerSleepAction(.6)if(IssueImmediateOrderById(u,$D009E))thencall TriggerSleepAction(1.)endifcall Po(u)set u=nullendfunctionfunction Pw takes nothing returns nothinglocal unit u=c4call TriggerSleepAction(3.)call IssueImmediateOrderById(u,$D00F4)call TriggerSleepAction(3.)call IssueImmediateOrderById(u,$D027A)call Po(u)set u=nullendfunctionfunction Qw takes unit w returns nothing
local unit u
local group g=CreateGroup()set r4=GetOwningPlayer(w)call GroupEnumUnitsInRange(g,GetUnitX(w),GetUnitY(w),400.,y9)loop
set u=FirstOfGroup(g)exitwhen u==null
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\NightElf\\Blink\\BlinkCaster.mdl",u,"head"))call SetUnitState(u,UNIT_STATE_MANA,GetUnitState(u,UNIT_STATE_MANA)-100.)call GroupRemoveUnit(g,u)endloopcall DestroyGroup(g)
set g=nullset u=CreateUnit(r4,'e008',GetUnitX(w),GetUnitY(w),.0)call UnitAddAbility(u,'A0ES')call UnitApplyTimedLife(u,'BTLF',8.)
set u=nullendfunctionfunction Rw takes nothing returns nothinglocal player p=GetOwningPlayer(B4)local integer sm=2*me[GetPlayerId(p)]local integer i=0local integer j=0local unit u
loop
set u=rm(sm+j)call UnitRemoveAbility(u,'Awha')
call SetUnitOwner(u,p,false)
call UnitAddType(u,UNIT_TYPE_SAPPER)
call Po(u)call UnitApplyTimedLife(u,'BTLF',42.)set j=j+1if(j>1)thenset j=0endifset i=i+1call TriggerSleepAction(.3)exitwhen i>=6endloopset u=nullendfunctionfunction Sw takes nothing returns nothinglocal unit c
set r4=GetOwningPlayer(B4)call GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,y9)set bj_groupRandomConsidered=0set bj_groupRandomCurrentPick=nullcall ForGroup(q4,function GroupPickRandomUnitEnum)if(bj_groupRandomCurrentPick==null or Hr(bj_groupRandomCurrentPick))then
returnendifset c=CreateUnit(r4,'e008',GetUnitX(bj_groupRandomCurrentPick),GetUnitY(bj_groupRandomCurrentPick),.0)call UnitAddAbility(c,'A0BL')call UnitShareVision(bj_groupRandomCurrentPick,r4,true)call IssueTargetOrderById(c,$D0206,bj_groupRandomCurrentPick)call UnitShareVision(bj_groupRandomCurrentPick,r4,false)
call UnitApplyTimedLife(c,'BTLF',1.)
set c=nullendfunctionfunction Tw takes nothing returns nothinglocal unit c
set r4=GetOwningPlayer(B4)call GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,y9)set bj_groupRandomConsidered=0set bj_groupRandomCurrentPick=nullcall ForGroup(q4,function GroupPickRandomUnitEnum)if(bj_groupRandomCurrentPick==null)thenreturnendifset c=CreateUnit(r4,'e008',GetUnitX(bj_groupRandomCurrentPick),GetUnitY(bj_groupRandomCurrentPick),.0)call UnitAddAbility(c,vf)call IssuePointOrderById(c,$D0275,GetUnitX(bj_groupRandomCurrentPick),GetUnitY(bj_groupRandomCurrentPick))call UnitApplyTimedLife(c,'BTLF',5.)
set c=nullendfunctionfunction Uw takes nothing returns booleancall Bj(z4,'h02J',270.,.0,.0)return false
endfunctionfunction Vw takes nothing returns booleancall Bj(z4,'h02J',270.,.0,.0)call Bj(z4,'h02E',270.,.0,.0)return false
endfunctionfunction Ww takes nothing returns booleancall Bj(z4,'h02J',270.,.0,.0)call Bj(z4,'h02E',270.,.0,.0)call Bj(z4,'h02F',270.,-25.,-25.)return false
endfunctionfunction Xw takes nothing returns booleancall Bj(z4,'h02J',270.,.0,.0)call Bj(z4,'h02E',270.,.0,.0)call Bj(z4,'h02F',270.,-35.,-40.)call Bj(z4,'h02G',211.,-35.,35.)
return false
endfunctionfunction Yw takes nothing returns booleancall Bj(z4,'h02Q',270.,-35.,30.)
return false
endfunctionfunction Zw takes nothing returns booleancall Bj(z4,'h02L',270.,.0,.0)call Bj(z4,'h02M',270.,25,20.)return false
endfunctionfunction dx takes nothing returns booleancall Bj(z4,'h02T',49.,-40.,20.)return false
endfunctionfunction ex takes nothing returns nothingcall zj('n02C','n00T')call Fj('n02C',function Uw)call zj('h002','n00U')call Fj('h002',function Vw)call zj('h00Q','n01N')call Fj('h00Q',function Ww)call zj('h00R','n01W')call Fj('h00R',function Xw)call zj('h00Y','n026')call zj('h012','n028')call Fj('h012',function Yw)call zj('h013','e006')call zj('h01H','e009')call zj('h01J','e00C')call zj('h023','n029')call zj('h024','n02B')call Fj('h024',function Zw)call zj('h027','n02A')call zj('h028','e00F')call Fj('h028',function dx)call Ij('n02D',700.)
call lj('h02D',function Rw)call lj('h02C',function Sw)call lj('h02A',function Tw)endfunctionfunction fx takes nothing returns nothinglocal integer id
set id=GetUnitPointValueByType('h002')set t4[id]=$AAset u4[id]=$AA*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h00Q')set t4[id]=$C8set u4[id]=$C8*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h00R')set t4[id]=$FAset u4[id]=$FA*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h00Y')set t4[id]=$C8set u4[id]=$C8*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h012')set t4[id]=$C8set u4[id]=$C8*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h013')set t4[id]=$DCset u4[id]=$DC*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h01H')set t4[id]=$DCset u4[id]=$DC*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h023')set t4[id]=260set u4[id]=260*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h024')set t4[id]=260set u4[id]=260*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h027')set t4[id]=310set u4[id]=310*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h028')set t4[id]=510set u4[id]=510*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('n02D')set t4[id]=$D2set u4[id]=$D2*.08/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h01J')set t4[id]=400set u4[id]=400*.2/ 100.set v4[id]=false
set id=GetUnitPointValueByType('h02A')set t4[id]=350set u4[id]=350*.12/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h02C')set t4[id]=$FAset u4[id]=$FA*.09/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h02D')set t4[id]=600set u4[id]=600*.12/ 100.
set v4[id]=false
endfunctionfunction gx takes nothing returns nothingcall Lj('n026','A0C0',function Jw)call Lj('n028','A0C1',function Kw)call Lj('e006','A004',function Nw)call Lj('e009','A0BT',function Ow)call Lj('e00C','A0BX',function Iw)call Lj('n01W','A0AV',function Pw)call Lj('e00F','A0BJ',function Lw)endfunctionfunction hx takes unit u returns nothing
local real x=GetUnitX(u)
local real y=GetUnitY(u)
local real an=GetUnitFacing(u)*bj_DEGTORADlocal destructable d=CreateDestructable('VTlt',x+32.*Cos(an),y+32.*Sin(an),GetRandomReal(0,360),GetRandomReal(.5,.8),0)call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\NightElf\\NEDeathMedium\\NEDeath.mdl",GetDestructableX(d),GetDestructableY(d)))call IssueTargetOrderById(u,$D021F,d)call TriggerSleepAction(1.6)
call Po(u)call TriggerSleepAction(2.)call RemoveDestructable(d)set d=nullendfunctionfunction ix takes unit u returns nothing
call UnitRemoveAbility(u,'A0C4')
call SetUnitMoveSpeed(u,370.)call br(u)call TriggerSleepAction(5.)call SetUnitMoveSpeed(u,270.)call UnitRemoveBuffs(u,true,true)call IssueImmediateOrderById(u,$D0019)call UnitAddAbility(u,'Asla')call UnitAddAbility(u,'A0C7')call UnitAddAbility(u,'A0C8')call TriggerSleepAction(10.)
call UnitRemoveAbility(u,'Asla')
call UnitRemoveAbility(u,'A0C7')
call Po(u)endfunctionfunction jx takes unit u returns nothing
call UnitRemoveAbility(u,'A0C4')
call SetUnitMoveSpeed(u,370.)call br(u)call TriggerSleepAction(5.)call SetUnitMoveSpeed(u,270.)call UnitRemoveBuffs(u,true,true)call IssueImmediateOrderById(u,$D0019)call UnitAddAbility(u,'Asla')call UnitAddAbility(u,'A0C6')call TriggerSleepAction(10.)
call UnitRemoveAbility(u,'Asla')
call UnitRemoveAbility(u,'A0C6')
call Po(u)endfunctionfunction kx takes nothing returns nothingcall ex()call fx()call gx()set yf=Filter(function Mw)set xf=Filter(function Hw)set wf=AddWeatherEffect(bj_mapInitialPlayableArea,'FDgh')call EnableWeatherEffect(wf,false)endfunctionfunction nx takes nothing returns booleanlocal unit u=GetFilterUnit()
local boolean Im=GetWidgetLife(u)>.405 and IsUnitAlly(u,r4)and IsUnitType(u,UNIT_TYPE_SAPPER)and GetUnitAbilityLevel(u,'A08C')<=0set u=nullreturn Imendfunctionfunction ox takes nothing returns nothingset r4=GetOwningPlayer(B4)call GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,af)call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\Polymorph\\PolyMorphTarget.mdl",GetUnitX(B4),GetUnitY(B4)))set bj_groupRandomConsidered=0set bj_groupRandomCurrentPick=nullcall ForGroup(q4,function GroupPickRandomUnitEnum)if(bj_groupRandomCurrentPick==null)thenreturnendifcall DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\ControlMagic\\ControlMagicTarget.mdl",bj_groupRandomCurrentPick,"overhead"))call UnitAddAbility(bj_groupRandomCurrentPick,'A08C')call UnitAddAbility(bj_groupRandomCurrentPick,'A08D')call UnitAddAbility(bj_groupRandomCurrentPick,'A08F')endfunctionfunction px takes nothing returns nothinglocal unit u=GetTriggerUnit()local player plocal integer id
local real x
local real y
if(IsUnitType(u,UNIT_TYPE_STRUCTURE)or(not IsUnitType(GetTriggerUnit(),UNIT_TYPE_SAPPER))or GetUnitAbilityLevel(u,'A08H')>0)then
set u=nullreturnendifset p=GetOwningPlayer(u)
set id=me[GetPlayerId(p)]if(Bf[id]>0)then
set x=GetUnitX(u)set y=GetUnitY(u)call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Items\\AIda\\AIdaCaster.mdl",x,y))set u=CreateUnit(p,'e008',x,y,.0)call UnitAddAbility(u,'A08A')call IssueImmediateOrderById(u,$D012D)call UnitApplyTimedLife(u,'BTLF',1.)
set Bf[id]=Bf[id]-1if(Bf[0]<=0 and Bf[1]<=0)thencall DisableTrigger(bf)endifendifset u=nullendfunctionfunction qx takes nothing returns nothinglocal integer id=me[GetPlayerId(GetOwningPlayer(B4))]set Bf[id]=Bf[id]+1call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Items\\TomeOfRetraining\\TomeOfRetrainingCaster.mdl",GetUnitX(B4),GetUnitY(B4)))
if(not IsTriggerEnabled(bf))then
call EnableTrigger(bf)endifendfunctionfunction rx takes nothing returns nothinglocal effect elocal fogmodifier flocal real x
local real y
local boolean fl
local unit c
set r4=GetOwningPlayer(B4)call GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,y9)set bj_groupRandomConsidered=0set bj_groupRandomCurrentPick=nullcall ForGroup(q4,function GroupPickRandomUnitEnum)if(bj_groupRandomCurrentPick==null)thenreturnendifset e=AddSpecialEffect("Abilities\\Spells\\NightElf\\Starfall\\StarfallCaster.mdl",GetUnitX(B4),GetUnitY(B4))set x=GetUnitX(bj_groupRandomCurrentPick)set y=GetUnitY(bj_groupRandomCurrentPick)set fl=not U9if(fl)thenset f=CreateFogModifierRadius(r4,FOG_OF_WAR_VISIBLE,x,y,1100.,true,false)call FogModifierStart(f)
endifset c=CreateUnit(r4,'e008',x,y,.0)call UnitAddAbility(c,zf)call IssueImmediateOrderById(c,$D00D7)call UnitApplyTimedLife(c,'BTLF',11.)set c=nullcall TriggerSleepAction(8.)if(fl)thencall DestroyFogModifier(f)set f=nullendifcall DestroyEffect(e)set e=nullendfunctionfunction ux takes nothing returns nothinglocal unit c=CreateUnit(GetOwningPlayer(c4),'e008',GetUnitX(D4),GetUnitY(D4),.0)
call UnitAddAbility(c,'A07A')call IssueTargetOrderById(c,$D00CB,D4)call UnitApplyTimedLife(c,'BTLF',6.)
set c=nullendfunctionfunction vx takes nothing returns booleanlocal unit u=GetFilterUnit()
local boolean Im=GetWidgetLife(u)>.405 and IsUnitEnemy(u,r4)and IsUnitType(u,UNIT_TYPE_SAPPER)and IsUnitType(u,UNIT_TYPE_GROUND)and GetUnitAbilityLevel(u,'Avul')<=0 and GetUnitAbilityLevel(u,'A08H')<=0if(Im and GetUnitAbilityLevel(u,'BEer')<=0 and GetUnitAbilityLevel(u,'B00M')<=0)then
call GroupAddUnit(Af,u)set u=nullreturn false
endifset u=nullreturn Imendfunctionfunction wx takes nothing returns nothinglocal real x
local real y
local unit t
local unit c
set r4=GetOwningPlayer(c4)set x=GetUnitX(D4)set y=GetUnitY(D4)set bj_forLoopAIndex=3call GroupClear(Af)call GroupEnumUnitsInRange(q4,x,y,300.,Cf)loop
set t=FirstOfGroup(Af)exitwhen bj_forLoopAIndex<=0 or t==nullset bj_forLoopAIndex=bj_forLoopAIndex-1call GroupRemoveUnit(Af,t)set c=CreateUnit(r4,'e008',x,y,.0)call UnitAddAbility(c,'A07Q')call UnitShareVision(t,r4,true)call IssueTargetOrderById(c,$D00CB,t)call UnitShareVision(t,r4,false)
call UnitApplyTimedLife(c,'BTLF',11.)endloopif(bj_forLoopAIndex>0)thenloop
set t=FirstOfGroup(q4)exitwhen bj_forLoopAIndex<=0 or t==nullset bj_forLoopAIndex=bj_forLoopAIndex-1call GroupRemoveUnit(q4,t)set c=CreateUnit(r4,'e008',x,y,.0)call UnitAddAbility(c,'A07Q')call UnitShareVision(t,r4,true)call IssueTargetOrderById(c,$D00CB,t)call UnitShareVision(t,r4,false)
call UnitApplyTimedLife(c,'BTLF',11.)endloopendifset t=nullset c=nullendfunctionfunction xx takes nothing returns nothinglocal unit u=c4call TriggerSleepAction(1.2)
call Po(u)set u=nullendfunctionfunction yx takes nothing returns booleancall Bj(z4,'h08L',32.,12.,-11.5)
return false
endfunctionfunction zx takes nothing returns booleancall Bj(z4,'h08D',116.,-3.,-10.5)call Bj(z4,'h08N',323.,20.,5.75)
return false
endfunctionfunction Ax takes nothing returns booleancall Bj(z4,'h08A',.0,.0,.0)return false
endfunctionfunction ax takes nothing returns booleancall Bj(z4,'h08K',.0,.0,.0)return false
endfunctionfunction Bx takes nothing returns booleancall Bj(z4,'h08K',.0,.0,.0)call Bj(z4,'h08S',.0,.0,.0)return false
endfunctionfunction bx takes nothing returns booleancall Bj(z4,'h08N',226.,37.75,-41.5)return false
endfunctionfunction Cx takes nothing returns booleancall Bj(z4,'h08O',318,43.5,-41.75)call Bj(z4,'h08N',$E2,-38.25,40.25)return false
endfunctionfunction cx takes nothing returns booleancall Bj(z4,'h08K',.0,15.,.0)
call Bj(z4,'h08R',.0,.0,.0)return false
endfunctionfunction Dx takes nothing returns booleancall Bj(z4,'h08M',.0,.0,.0)call Bj(z4,'h08Q',.0,.0,.0)return false
endfunctionfunction Ex takes nothing returns nothingcall lj('h07H',function ox)call Fj('h07H',function yx)call lj('h08P',function qx)call Fj('h08P',function zx)call Ij('h073',850.)
call lj('h07I',function rx)call Fj('h07I',function Ax)call zj('h088','e007')call Fj('h088',function ax)call zj('h07D','e00J')call Fj('h07D',function Bx)call zj('h07M','n01Z')call Fj('h07M',function bx)call zj('h07L','n020')call Fj('h07L',function Cx)call zj('h07O','e00B')call Fj('h07O',function cx)call zj('h07N','e00A')call Fj('h07N',function Dx)call zj('h011','e002')call zj('h00S','e001')call zj('h03D','e003')call zj('h03E','e004')call zj('h00B','e000')endfunctionfunction Fx takes nothing returns nothinglocal integer id
set id=GetUnitPointValueByType('h088')set t4[id]=$BEset u4[id]=$BE*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h07D')set t4[id]=$D2set u4[id]=$D2*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h07M')set t4[id]=$C8set u4[id]=$C8*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h07L')set t4[id]=$AFset u4[id]=$AF*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h07O')set t4[id]=$E6set u4[id]=$E6*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h07N')set t4[id]=$F0set u4[id]=$F0*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h011')set t4[id]=285set u4[id]=285*.18/ 100.
set v4[id]=trueset w4[id]=trueset id=GetUnitPointValueByType('h00S')set t4[id]=$96set u4[id]=$96*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h03D')set t4[id]=$C8set u4[id]=$C8*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h03E')set t4[id]=400set u4[id]=400*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h00B')set t4[id]=260set u4[id]=260*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h07H')set t4[id]=$DCset u4[id]=$DC*.12/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h08P')set t4[id]=$E1set u4[id]=$E1*.12/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h073')set t4[id]=$D2set u4[id]=$D2*.08/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h07I')set t4[id]=650set u4[id]=650*.09/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h03E')set t4[id]=400set u4[id]=400*.2/ 100.set v4[id]=false
endfunctionfunction Gx takes nothing returns nothingcall Lj('e007','A07P',function ux)call Lj('e00J','A07R',function wx)call Lj('e000','A0CG',function xx)endfunctionfunction Hx takes nothing returns nothingcall Ex()call Fx()call Gx()set af=Filter(function nx)set Cf=Filter(function vx)call TriggerAddAction(bf,function px)call TriggerRegisterAnyUnitEventBJ(bf,EVENT_PLAYER_UNIT_ATTACKED)call DisableTrigger(bf)endfunctionfunction Ix takes nothing returns booleanlocal unit u=GetFilterUnit()
local boolean Im=GetWidgetLife(u)>.405 and IsUnitEnemy(u,r4)and IsUnitType(u,UNIT_TYPE_SAPPER)and IsUnitType(u,UNIT_TYPE_FLYING)
set u=nullreturn Imendfunctionfunction lx takes nothing returns nothinglocal unit c
set r4=GetOwningPlayer(B4)call GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,cf)set bj_groupRandomConsidered=0set bj_groupRandomCurrentPick=nullcall ForGroup(q4,function GroupPickRandomUnitEnum)if(bj_groupRandomCurrentPick==null or Hr(bj_groupRandomCurrentPick))then
returnendifset c=CreateUnit(r4,'e008',GetUnitX(B4),GetUnitY(B4),.0)
call UnitAddAbility(c,'A0AK')call UnitShareVision(bj_groupRandomCurrentPick,r4,true)call IssueTargetOrderById(c,$D007F,bj_groupRandomCurrentPick)call UnitShareVision(bj_groupRandomCurrentPick,r4,false)
call UnitApplyTimedLife(c,'BTLF',10.)set c=nullendfunctionfunction Jx takes nothing returns booleanlocal unit u=GetFilterUnit()
local boolean Im=GetWidgetLife(u)>.405 and IsUnitEnemy(u,r4)and IsUnitType(u,UNIT_TYPE_STRUCTURE)and GetPlayerId(GetOwningPlayer(u))<$C and GetUnitTypeId(u)!='hcas'
set u=nullreturn Imendfunctionfunction Kx takes nothing returns nothinglocal real x
local real y
local unit c
local fogmodifier fset r4=GetOwningPlayer(B4)call GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,Df)set bj_groupRandomConsidered=0set bj_groupRandomCurrentPick=nullcall ForGroup(q4,function GroupPickRandomUnitEnum)if(bj_groupRandomCurrentPick==null)thenreturnendifset x=GetUnitX(B4)set y=GetUnitY(B4)call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\Naga\\NagaDeath\\NagaDeath.mdl",x,y))
set c=CreateUnit(r4,'h04G',x,y,.0)call UnitApplyTimedLife(c,'BTLF',20.)if(U9)thencall IssueTargetOrderById(c,$D000F,bj_groupRandomCurrentPick)else
set f=CreateFogModifierRadius(r4,FOG_OF_WAR_VISIBLE,GetUnitX(bj_groupRandomCurrentPick),GetUnitY(bj_groupRandomCurrentPick),128.,true,false)
call FogModifierStart(f)
call IssueTargetOrderById(c,$D000F,bj_groupRandomCurrentPick)call TriggerSleepAction(.1)call DestroyFogModifier(f)set f=nullendifset c=nullendfunctionfunction Lx takes nothing returns nothinglocal real x
local real y
local unit c
local fogmodifier fset r4=GetOwningPlayer(B4)call GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,Df)set bj_groupRandomConsidered=0set bj_groupRandomCurrentPick=nullcall ForGroup(q4,function GroupPickRandomUnitEnum)if(bj_groupRandomCurrentPick==null)thenreturnendifset x=GetUnitX(B4)set y=GetUnitY(B4)call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\Naga\\NagaDeath\\NagaDeath.mdl",x,y))
set c=CreateUnit(r4,'h04H',x,y,.0)call UnitApplyTimedLife(c,'BTLF',20.)if(U9)thencall IssueTargetOrderById(c,$D000F,bj_groupRandomCurrentPick)else
set f=CreateFogModifierRadius(r4,FOG_OF_WAR_VISIBLE,GetUnitX(bj_groupRandomCurrentPick),GetUnitY(bj_groupRandomCurrentPick),128.,true,false)
call FogModifierStart(f)
call IssueTargetOrderById(c,$D000F,bj_groupRandomCurrentPick)call TriggerSleepAction(.1)call DestroyFogModifier(f)set f=nullendifset c=nullendfunctionfunction Mx takes nothing returns nothinglocal integer i=0local real x
local real y
local real anlocal unit u
local unit c
local integer tloop
exitwhen i>=Gfset u=Ff[i]set an=GetUnitFacing(u)set x=GetUnitX(u)+10.*Cos(an*bj_DEGTORAD)if(x>=lf or x<=If or GetWidgetLife(u)<.405)thencall RemoveUnit(u)set Gf=Gf-1set Ff[i]=Ff[Gf]
else
set y=GetUnitY(u)+10.*Sin(an*bj_DEGTORAD)if(y>=Kf or y<=Jf)thenset y=GetUnitY(u)+30.*Sin((360.-an)*bj_DEGTORAD)
call SetUnitFacing(u,360.-an)endifcall SetUnitX(u,x)call SetUnitY(u,y)set t=GetUnitUserData(u)+1if(t>50)then
set t=0set r4=GetOwningPlayer(u)call GroupEnumUnitsInRange(q4,x,y,700.,y9)set bj_groupRandomConsidered=0set bj_groupRandomCurrentPick=nullcall ForGroup(q4,function GroupPickRandomUnitEnum)if(bj_groupRandomCurrentPick!=null)thenif(IsUnitType(bj_groupRandomCurrentPick,UNIT_TYPE_FLYING))thenset c=CreateUnit(GetOwningPlayer(B4),'e008',GetUnitX(bj_groupRandomCurrentPick),GetUnitY(bj_groupRandomCurrentPick),.0)call UnitAddAbility(c,'A082')call UnitShareVision(bj_groupRandomCurrentPick,r4,true)call IssueTargetOrderById(c,$D007F,bj_groupRandomCurrentPick)call UnitShareVision(bj_groupRandomCurrentPick,r4,false)
call UnitApplyTimedLife(c,'BTLF',2.)
else
set c=CreateUnit(GetOwningPlayer(B4),'e008',GetUnitX(bj_groupRandomCurrentPick),GetUnitY(bj_groupRandomCurrentPick),.0)call UnitAddAbility(c,'A083')call UnitShareVision(bj_groupRandomCurrentPick,r4,true)call IssueTargetOrderById(c,$D007F,bj_groupRandomCurrentPick)call UnitShareVision(bj_groupRandomCurrentPick,r4,false)
call UnitApplyTimedLife(c,'BTLF',2.)
set c=CreateUnit(GetOwningPlayer(B4),'e008',GetUnitX(bj_groupRandomCurrentPick),GetUnitY(bj_groupRandomCurrentPick),.0)call UnitAddAbility(c,'A04H')call UnitShareVision(bj_groupRandomCurrentPick,r4,true)call IssueTargetOrderById(c,$D00CB,bj_groupRandomCurrentPick)call UnitShareVision(bj_groupRandomCurrentPick,r4,false)
call UnitApplyTimedLife(c,'BTLF',16.)endifendifendifcall SetUnitUserData(u,t)set i=i+1endifendloopif(Gf==0)thencall PauseTimer(Ef)endifset u=nullset c=nullendfunctionfunction Nx takes nothing returns nothinglocal unit u=B4local real x=GetUnitX(u)
local real y=GetUnitY(u)
local player p=GetOwningPlayer(u)local real an=me[GetPlayerId(p)]*180.local integer i=0local unit c
call SetUnitAnimation(u,"death")
call TriggerSleepAction(1.5)
call TimerStart(Ef,.04,true,function Mx)
loop
set c=CreateUnit(p,'h08U',x,y,ModuloReal(an+GetRandomReal(-55.,55.)+360.,360.))if(md)thencall UnitRemoveAbility(c,'A080')
call UnitAddAbility(c,'A084')endifset Ff[Gf]=c
set Gf=Gf+1set i=i+1exitwhen i>2
endloopset c=nullcall EnableWeatherEffect(Hf,true)call TriggerSleepAction(3.7)
call SetUnitAnimation(u,"stand")
call TriggerSleepAction(2.6)
call EnableWeatherEffect(Hf,false)set u=nullendfunctionfunction Ox takes nothing returns booleancall SetUnitVertexColor(z4,0,$A6,$FF,'s')return false
endfunctionfunction Px takes nothing returns nothinglocal unit c=CreateUnit(GetOwningPlayer(c4),'e008',GetUnitX(c4),GetUnitY(c4),.0)
call UnitAddAbility(c,'A05D')call IssueImmediateOrderById(c,$D009F)call UnitApplyTimedLife(c,'BTLF',1.)
set c=nullendfunctionfunction Qx takes nothing returns nothinglocal unit c=CreateUnit(GetOwningPlayer(c4),'e008',GetUnitX(c4),GetUnitY(c4),.0)
call UnitAddAbility(c,'A043')call IssueTargetOrderById(c,$D0102,D4)call UnitApplyTimedLife(c,'BTLF',1.)
set c=nullendfunctionfunction Rx takes nothing returns nothinglocal unit c=CreateUnit(GetOwningPlayer(c4),'e008',GetUnitX(c4),GetUnitY(c4),.0)
call UnitAddAbility(c,'A05B')call IssueImmediateOrderById(c,$D026C)call UnitApplyTimedLife(c,'BTLF',1.)
set c=nullendfunctionfunction Sx takes nothing returns nothingcall lj('h047',function lx)call lj('h048',function Kx)call lj('h03L',function Lx)call lj('h03O',function Nx)call zj('h049','n017')call zj('h04F','n018')call zj('h03W','n016')call zj('h03T','n012')call zj('h043','n013')call zj('h03S','n014')call Fj('h03S',function Ox)call zj('h03K','n015')call zj('h03J','o00A')call Ij('h03Q',750.)
call zj('h03U','n011')call zj('h03I','n010')endfunctionfunction Tx takes nothing returns nothinglocal integer id
set id=GetUnitPointValueByType('h049')set t4[id]='s'set u4[id]='s'*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h04F')set t4[id]='}'set u4[id]='}'*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h03W')set t4[id]=$FAset u4[id]=$FA*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h03T')set t4[id]=275set u4[id]=275*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h043')set t4[id]=$E1set u4[id]=$E1*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h03S')set t4[id]=400set u4[id]=400*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h03K')set t4[id]=$AFset u4[id]=$AF*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h03J')set t4[id]=$96set u4[id]=$96*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h03U')set t4[id]=$A0set u4[id]=$A0*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h03I')set t4[id]=280set u4[id]=280*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h047')set t4[id]=$BEset u4[id]=$BE*.12/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h03Q')set t4[id]=$E6set u4[id]=$E6*.08/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h048')set t4[id]=$D2set u4[id]=$D2*.09/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h03L')set t4[id]=290set u4[id]=290*.09/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h03O')set t4[id]=600set u4[id]=600*.09/ 100.
set v4[id]=false
endfunctionfunction Ux takes nothing returns nothingcall Lj('n016','A05E',function Px)call Lj('n013','A05C',function Rx)call Lj('n014','A044',function Qx)endfunctionfunction Vx takes nothing returns nothingcall Sx()call Tx()call Ux()set cf=Filter(function Ix)set Df=Filter(function Jx)set If=GetRectMinX(bj_mapInitialPlayableArea)set lf=GetRectMaxX(bj_mapInitialPlayableArea)set Jf=GetRectMinY(bj_mapInitialPlayableArea)set Kf=GetRectMaxY(bj_mapInitialPlayableArea)set Hf=AddWeatherEffect(bj_mapInitialPlayableArea,'SNhs')call EnableWeatherEffect(Hf,false)endfunctionfunction Wx takes nothing returns booleanlocal unit u=GetFilterUnit()
local boolean Im=GetWidgetLife(u)<.405 and IsUnitType(u,UNIT_TYPE_SAPPER)and not IsUnitType(u,UNIT_TYPE_UNDEAD)set u=nullreturn Imendfunctionfunction Xx takes nothing returns nothinglocal real x
local real y
call GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,Lf)set bj_groupRandomConsidered=0set bj_groupRandomCurrentPick=nullcall ForGroup(q4,function GroupPickRandomUnitEnum)if(bj_groupRandomCurrentPick==null)thenreturnendifset x=GetUnitX(bj_groupRandomCurrentPick)set y=GetUnitY(bj_groupRandomCurrentPick)call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Items\\AIam\\AIamTarget.mdl",x,y))if(GetRandomInt(0,99)<$A)thencall Po(CreateUnit(GetOwningPlayer(B4),Mf[3],x,y,.0))else
call Po(CreateUnit(GetOwningPlayer(B4),Mf[GetRandomInt(0,2)],x,y,.0))endifcall RemoveUnit(bj_groupRandomCurrentPick)endfunctionfunction Yx takes nothing returns nothinglocal real x
local real y
call GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,Lf)set bj_groupRandomConsidered=0set bj_groupRandomCurrentPick=nullcall ForGroup(q4,function GroupPickRandomUnitEnum)if(bj_groupRandomCurrentPick==null)thenreturnendifset x=GetUnitX(bj_groupRandomCurrentPick)set y=GetUnitY(bj_groupRandomCurrentPick)call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Items\\AIam\\AIamTarget.mdl",x,y))if(GetRandomInt(0,99)<$A)thencall Po(CreateUnit(GetOwningPlayer(B4),Mf[7],x,y,.0))else
call Po(CreateUnit(GetOwningPlayer(B4),Mf[GetRandomInt(1,6)],x,y,.0))endifcall RemoveUnit(bj_groupRandomCurrentPick)endfunctionfunction Zx takes nothing returns nothinglocal unit u
set r4=GetOwningPlayer(B4)call GroupEnumUnitsInRect(q4,bj_mapInitialPlayableArea,y9)set bj_groupRandomConsidered=0set bj_groupRandomCurrentPick=nullcall ForGroup(q4,function GroupPickRandomUnitEnum)if(bj_groupRandomCurrentPick==null)thenreturnendifif not Hr(bj_groupRandomCurrentPick)then
call UnitDamageTarget(B4,bj_groupRandomCurrentPick,50000.,true,false,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_DEATH,WEAPON_TYPE_WHOKNOWS)endifcall DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Undead\\DeathCoil\\DeathCoilSpecialArt.mdl",GetUnitX(bj_groupRandomCurrentPick),GetUnitY(bj_groupRandomCurrentPick)))set u=B4
call SetUnitAnimation(u,"work")call TriggerSleepAction(1.)call SetUnitAnimation(u,"stand")
set u=nullendfunctionfunction dy takes nothing returns nothingcall zj('h01K','u005')call zj('h04B','u009')call zj('h055','u00D')call Ij('h01O',800.)
call zj('h01T','n00E')call lj('h01P',function Xx)call lj('h056',function Yx)call zj('h01N','h01U')call zj('h054','h05H')call zj('h01L','u001')call zj('h01S','u000')call lj('h00A',function Zx)call zj('h01R','n00B')call zj('h04Z','n01K')call zj('h03M','u007')endfunctionfunction ey takes nothing returns nothinglocal integer id
set id=GetUnitPointValueByType('h01K')set t4[id]=$D2set u4[id]=$D2*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h04B')set t4[id]=$AAset u4[id]=$AA*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h01T')set t4[id]=370set u4[id]=370*.18/ 100.
set v4[id]=trueset w4[id]=trueset id=GetUnitPointValueByType('h01P')set t4[id]=$A0set u4[id]=$A0*.12/ 100.
set v4[id]=trueset id=GetUnitPointValueByType('h056')set t4[id]=$8Cset u4[id]=$8C*.12/ 100.
set v4[id]=trueset id=GetUnitPointValueByType('h01N')set t4[id]=$E6set u4[id]=$E6*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h054')set t4[id]=265set u4[id]=265*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h01L')set t4[id]=290set u4[id]=290*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h01S')set t4[id]=500set u4[id]=500*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h01R')set t4[id]='x'set u4[id]='x'*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h04Z')set t4[id]='d'set u4[id]='d'*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h03M')set t4[id]=$CDset u4[id]=$CD*.2/ 100.set v4[id]=trueset id=GetUnitPointValueByType('h01O')set t4[id]=$C8set u4[id]=$C8*.08/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h055')set t4[id]=370set u4[id]=370*.2/ 100.set v4[id]=false
set id=GetUnitPointValueByType('h00A')set t4[id]=360set u4[id]=360*.09/ 100.
set v4[id]=false
set id=GetUnitPointValueByType('h01Q')set t4[id]=650set u4[id]=650*.09/ 100.
set v4[id]=false
endfunctionfunction fy takes nothing returns nothingendfunctionfunction gy takes nothing returns nothinglocal unit u=GetSummonedUnit()local integer aj=GetUnitTypeId(u)if(aj=='u004')thencall Po(ReplaceUnitBJ(u,Mf[GetRandomInt(0,2)],2))elseif(aj=='u008')thencall Po(ReplaceUnitBJ(u,Mf[GetRandomInt(0,6)],2))elseif(aj=='u00E')thenset aj=GetRandomInt(0,7)
if(aj==0)thenset aj=7
else
set aj=GetRandomInt(3,6)
endifcall Po(ReplaceUnitBJ(u,Mf[aj],2))call UnitAddAbility(bj_lastReplacedUnit,'A088')call UnitAddAbility(bj_lastReplacedUnit,'A089')endifset u=nullendfunctionfunction hy takes unit k,unit d,integer bj returns nothinglocal real x=GetUnitX(d)
local real y=GetUnitY(d)
call CreateUnit(GetOwningPlayer(k),bj,x,y,.0)call RemoveUnit(d)call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Items\\AIam\\AIamTarget.mdl",x,y))endfunctionfunction iy takes nothing returns nothinglocal trigger tcall dy()call ey()call fy()set Lf=Filter(function Wx)set Mf[0]='u002'
set Mf[1]='n00D'
set Mf[2]='u00A'
set Mf[3]='n00C'
set Mf[4]='u00B'
set Mf[5]='n01L'
set Mf[6]='u003'
set Mf[7]='n01M'
set t=CreateTrigger()call TriggerRegisterAnyUnitEventBJ(t,EVENT_PLAYER_UNIT_SUMMON)call TriggerAddAction(t,function gy)
endfunctionfunction jy takes unit u,real x,real y returns nothinglocal unit c=CreateUnit(GetOwningPlayer(u),'e008',x,y,.0)call UnitAddAbility(c,'A086')call IssuePointOrderById(c,$D00FD,x,y)call UnitApplyTimedLife(c,'BTLF',6.)
set c=nullendfunctionfunction ky takes unit u,unit v returns nothinglocal integer i=GetRandomInt(0,99)if(i<$F and GetUnitAbilityLevel(v,'A070')<=0 and not IsUnitType(v,UNIT_TYPE_MECHANICAL))then
if(GetWidgetLife(v)<.405)thenreturnendifcall SetUnitState(u,UNIT_STATE_LIFE,GetUnitState(u,UNIT_STATE_LIFE)+GetUnitState(v,UNIT_STATE_LIFE)/ 2.)
call UnitDamageTarget(u,v,10000.,true,false,ATTACK_TYPE_CHAOS,DAMAGE_TYPE_DEATH,WEAPON_TYPE_WHOKNOWS)call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Orc\\AncestralSpirit\\AncestralSpiritCaster.mdl",v,"chest"))elseif(i<25)then
call jy(u,GetUnitX(v),GetUnitY(v))endifendfunctionfunction ny takes unit u,unit v returns nothinglocal unit c
if(GetRandomInt(0,99)<$F)thenset c=CreateUnit(GetOwningPlayer(u),'e008',GetUnitX(u),GetUnitY(u),.0)call UnitAddAbility(c,'A09T')call IssueTargetOrderById(c,$D0097,v)call UnitApplyTimedLife(c,'BTLF',4.)
set c=nullendifendfunctionfunction oy takes unit u,unit v returns nothinglocal unit c
if(GetRandomInt(0,99)<40)thenset c=CreateUnit(GetOwningPlayer(u),'e008',GetUnitX(u),GetUnitY(u),.0)call UnitAddAbility(c,'A0DC')call IssueTargetOrderById(c,$D011C,v)call UnitApplyTimedLife(c,'BTLF',4.)
set c=nullendifendfunctionfunction py takes unit v returns nothing
local integer i=GetUnitAbilityLevel(v,'A0C9')if(i<=0)then
call UnitAddAbility(v,'A0C9')elseif(i<3)thencall SetUnitAbilityLevel(v,'A0C9',i+1)endifendfunctionfunction qy takes unit v returns nothing
local unit u
if(GetRandomInt(0,99)<$F)thenset u=CreateUnit(GetOwningPlayer(v),'e008',GetUnitX(v),GetUnitY(v),.0)call UnitAddAbility(u,'A0B7')call IssueTargetOrderById(u,$D0062,v)call UnitApplyTimedLife(u,'BTLF',2.)
set u=CreateUnit(GetOwningPlayer(v),'e008',GetUnitX(v),GetUnitY(v),.0)call UnitAddAbility(u,'A0B5')call IssueTargetOrderById(u,$D0085,v)call UnitApplyTimedLife(u,'BTLF',2.)
set u=nullendifendfunctionfunction ry takes unit v returns nothing
local unit u
if(GetRandomInt(0,99)<20)thenset u=CreateUnit(GetOwningPlayer(v),'e008',GetUnitX(v),GetUnitY(v),.0)call UnitAddAbility(u,'A0B8')call IssueTargetOrderById(u,$D0062,v)call UnitApplyTimedLife(u,'BTLF',2.)
set u=CreateUnit(GetOwningPlayer(v),'e008',GetUnitX(v),GetUnitY(v),.0)call UnitAddAbility(u,'A0B6')call IssueTargetOrderById(u,$D0085,v)call UnitApplyTimedLife(u,'BTLF',2.)
set u=nullendifendfunctionfunction uy takes unit u returns nothing
if(GetRandomInt(0,99)<$F)thencall UnitRemoveBuffsEx(u,true,false,true,false,false,false,false)call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\MarkOfChaos\\MarkOfChaosDone.mdl",u,"overhead"))endifendfunctionfunction vy takes unit u returns nothing
if(GetRandomInt(0,99)<20)thencall UnitRemoveBuffsEx(u,true,false,true,false,false,false,false)call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\MarkOfChaos\\MarkOfChaosDone.mdl",u,"overhead"))endifendfunctionfunction wy takes nothing returns nothinglocal unit u=GetEnumUnit()call UnitRemoveBuffsEx(u,true,false,true,false,false,false,false)call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\MarkOfChaos\\MarkOfChaosDone.mdl",u,"overhead"))set u=nullendfunctionfunction xy takes unit u,unit t returns nothingset r4=GetOwningPlayer(u)if(GetRandomInt(0,99)<25)thencall GroupEnumUnitsInRange(q4,GetUnitX(t),GetUnitY(t),100.,y9)call ForGroup(q4,function wy)endifendfunctionfunction yy takes unit s,unit u returns nothinglocal integer zy=GetUnitLevel(u)
local unit c
if(IsUnitType(s,UNIT_TYPE_MELEE_ATTACKER)and GetRandomInt(0,99)<=$F*zy)thenset c=CreateUnit(GetOwningPlayer(u),'e008',GetUnitX(u),GetUnitY(u),.0)call UnitAddAbility(c,'A0D5')call SetUnitAbilityLevel(c,'A0D5',zy)call IssueTargetOrderById(c,$D007F,s)call UnitApplyTimedLife(c,'BTLF',4.)
set c=nullendifendfunctionfunction Ay takes unit u returns nothing
if(GetRandomInt(0,99)<20)thencall IssueImmediateOrderById(u,$D009B)endifendfunctionfunction ay takes unit u,real d returns nothinglocal real mp=GetUnitState(u,UNIT_STATE_MANA)+dif(mp>=680.)then
call UnitRemoveAbility(u,'A0C5')
call SetUnitMoveSpeed(u,450.)call UnitAddAbility(u,'A0EN')call IssueImmediateOrderById(u,$D0049)else
call SetUnitState(u,UNIT_STATE_MANA,mp)endifendfunctionfunction By takes unit u returns nothing
local real r=GetWidgetLife(u)if(r<128. and r>.405)thencall DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\DeathPact\\DeathPactCaster.mdl",u,"origin"))call SetWidgetLife(u,5000.)call UnitRemoveAbility(u,'A0EZ')
endifendfunctionfunction by takes nothing returns booleanlocal unit u=GetFilterUnit()
local boolean Im=GetWidgetLife(u)>.405 and IsUnitEnemy(u,r4)and IsUnitType(u,UNIT_TYPE_SAPPER)and GetUnitAbilityLevel(u,'Avul')<=0 and((Of and IsUnitType(u,UNIT_TYPE_GROUND))or(Pf and IsUnitType(u,UNIT_TYPE_FLYING)))
set u=nullreturn Imendfunctionfunction Cy takes unit Ui,real cy,real x,real y,boolean Dy,boolean Ey returns nothinglocal player p=GetOwningPlayer(Ui)local unit u=CreateUnit(p,'e008',x,y,.0)
local unit j
set r4=p
set Of=Dyset Pf=Eycall GroupEnumUnitsInRange(q4,x,y,250.,Qf)loop
set j=FirstOfGroup(q4)exitwhen j==null
call GroupRemoveUnit(q4,j)call UnitDamageTarget(u,j,cy,true,false,ATTACK_TYPE_CHAOS,DAMAGE_TYPE_UNKNOWN,WEAPON_TYPE_WHOKNOWS)endloopcall UnitApplyTimedLife(u,'BTLF',1.)
set u=nullendfunctionfunction Fy takes nothing returns booleanlocal unit s=GetEventDamageSource()local unit u=GetTriggerUnit()local integer Gy
if(GetUnitAbilityLevel(s,'A03Q')>0)thenif(GetUnitAbilityLevel(s,'A0F1')>0)thencall Cy(s,.5*GetEventDamage(),GetUnitX(u),GetUnitY(u),IsUnitType(s,UNIT_TYPE_ATTACKS_GROUND),IsUnitType(s,UNIT_TYPE_ATTACKS_FLYING))
endifset Gy=GetUnitTypeId(s)if(Gy=='u00D')thencall ky(s,u)
elseif(Gy=='h05L')thencall ny(s,u)
elseif(Gy=='h061')thencall oy(s,u)
elseif(Gy=='n02A')thencall py(u)elseif(Gy=='n02B')thencall UnitRemoveAbility(s,'A0C8')
elseif(Gy=='e006')thencall uy(u)elseif(Gy=='e009')thencall vy(u)elseif(Gy=='e00C')thencall xy(s,u)
elseif(GetUnitAbilityLevel(s,'A0DW')>0)thencall DisableTrigger(Nf)call UnitDamageTarget(s,u,50.*GetUnitLevel(s)*GetWidgetLife(s)/ GetUnitState(s,UNIT_STATE_MAX_LIFE),true,false,ATTACK_TYPE_SIEGE,DAMAGE_TYPE_DEMOLITION,WEAPON_TYPE_WHOKNOWS)call EnableTrigger(Nf)elseif(Gy=='h02Y')thencall Ay(s)endifendifif(GetWidgetLife(u)>.405 and GetUnitAbilityLevel(u,'A0C5')>0)thenset Gy=GetUnitTypeId(u)if(Gy=='n029')thencall qy(u)if(GetUnitAbilityLevel(u,'A0C4')>0 and GetWidgetLife(u)<255.)thencall jx(u)else
call UnitRemoveAbility(u,'Asla')
call UnitRemoveAbility(u,'A0C6')
endifelseif(Gy=='n02B')thencall ry(u)if(GetUnitAbilityLevel(u,'A0C4')>0 and GetWidgetLife(u)<255.)thencall ix(u)else
call UnitRemoveAbility(u,'Asla')
call UnitRemoveAbility(u,'A0C7')
endifelseif(GetUnitAbilityLevel(u,'A0DX')>0)thencall yy(s,u)
elseif(GetUnitAbilityLevel(u,'A0EZ')>0)thencall By(u)elseif(Gy=='o00E')thencall ay(u,GetEventDamage())endifendifif(zd)thencall yr(u)endifset u=nullset s=nullreturn false
endfunctionfunction Hy takes nothing returns nothingif(Nf!=null)then
call TriggerClearActions(Nf)
call DestroyTrigger(Nf)endifset Nf=CreateTrigger()call TriggerAddAction(Nf,function Fy)set Qf=Filter(function by)endfunctionfunction Iy takes nothing returns nothinglocal integer i=0loop
if(D9[i]!=null)thenif(GetLocalPlayer()==Player(i))thencall MultiboardDisplay(D9[i],true)endifelse
if(GetLocalPlayer()==Player(i))thencall MultiboardDisplay(G9,true)endifendifset i=i+1exitwhen i>$Bendloopendfunctionfunction ly takes nothing returns nothinglocal integer i=0local integer x=0local multiboarditem Jylocal player ploop
if(E9[i]!=null)thenset p=Player(i)set Jy=MultiboardGetItem(E9[i],F9[i],3)call MultiboardSetItemValue(Jy,I2S(GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)))call MultiboardReleaseItem(Jy)set Jy=MultiboardGetItem(E9[i],F9[i],4)call MultiboardSetItemValue(Jy,I2S(GetPlayerState(p,PLAYER_STATE_RESOURCE_LUMBER)))call MultiboardReleaseItem(Jy)set Jy=MultiboardGetItem(E9[i],F9[i],5)call MultiboardSetItemValue(Jy,I2S(GetPlayerState(p,PLAYER_STATE_RESOURCE_FOOD_USED))+"/"+I2S(GetPlayerState(p,PLAYER_STATE_RESOURCE_FOOD_CAP)))
call MultiboardReleaseItem(Jy)endifif(H9[i]>0)thenset p=Player(i)if(IsPlayerInForce(p,ie))thenset x=0else
set x=6endifset Jy=MultiboardGetItem(G9,H9[i],x+2)call MultiboardSetItemValue(Jy,I2S(GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)))call MultiboardReleaseItem(Jy)set Jy=MultiboardGetItem(G9,H9[i],x+3)call MultiboardSetItemValue(Jy,I2S(GetPlayerState(p,PLAYER_STATE_RESOURCE_LUMBER)))call MultiboardReleaseItem(Jy)set Jy=MultiboardGetItem(G9,H9[i],x+4)call MultiboardSetItemValue(Jy,I2S(nf[i]))call MultiboardReleaseItem(Jy)endifset i=i+1exitwhen i>$Bendloopset Jy=nullendfunctionfunction Ky takes integer dk,string Ly returns nothinglocal integer i=0local integer j=0local multiboarditem Jycall MultiboardSetRowCount(D9[dk],CountPlayersInForceBJ(ne[dk])+6)set Jy=MultiboardGetItem(D9[dk],4,0)
call MultiboardSetItemStyle(Jy,false,false)call MultiboardReleaseItem(Jy)set Jy=MultiboardGetItem(D9[dk],4,1)
call MultiboardSetItemStyle(Jy,false,false)call MultiboardReleaseItem(Jy)set Jy=MultiboardGetItem(D9[dk],4,2)
call MultiboardSetItemStyle(Jy,false,false)call MultiboardReleaseItem(Jy)set Jy=MultiboardGetItem(D9[dk],4,3)
call MultiboardSetItemStyle(Jy,false,false)call MultiboardReleaseItem(Jy)set Jy=MultiboardGetItem(D9[dk],4,4)
call MultiboardSetItemStyle(Jy,false,false)call MultiboardReleaseItem(Jy)set Jy=MultiboardGetItem(D9[dk],4,5)
call MultiboardSetItemStyle(Jy,false,false)call MultiboardReleaseItem(Jy)set Jy=MultiboardGetItem(D9[dk],5,0)
call MultiboardSetItemStyle(Jy,false,false)call MultiboardReleaseItem(Jy)set Jy=MultiboardGetItem(D9[dk],5,1)
call MultiboardSetItemStyle(Jy,true,false)call MultiboardSetItemValue(Jy,Ly)call MultiboardSetItemWidth(Jy,.1)call MultiboardReleaseItem(Jy)set Jy=MultiboardGetItem(D9[dk],5,2)
call MultiboardSetItemStyle(Jy,false,false)call MultiboardReleaseItem(Jy)set Jy=MultiboardGetItem(D9[dk],5,3)
call MultiboardSetItemStyle(Jy,false,false)call MultiboardReleaseItem(Jy)set Jy=MultiboardGetItem(D9[dk],5,4)
call MultiboardSetItemStyle(Jy,false,false)call MultiboardReleaseItem(Jy)set Jy=MultiboardGetItem(D9[dk],5,5)
call MultiboardSetItemStyle(Jy,false,false)call MultiboardReleaseItem(Jy)loop
if(IsPlayerInForce(Player(i),ne[dk]))thenset Jy=MultiboardGetItem(D9[dk],j+6,0)call MultiboardSetItemStyle(Jy,true,false)call MultiboardSetItemValue(Jy,pe[i])call MultiboardSetItemWidth(Jy,.09)call MultiboardReleaseItem(Jy)set Jy=MultiboardGetItem(D9[dk],j+6,1)call MultiboardSetItemStyle(Jy,false,false)call MultiboardSetItemWidth(Jy,.0001)call MultiboardReleaseItem(Jy)set Jy=MultiboardGetItem(D9[dk],j+6,2)call MultiboardSetItemStyle(Jy,false,false)call MultiboardSetItemWidth(Jy,.0001)call MultiboardReleaseItem(Jy)set Jy=MultiboardGetItem(D9[dk],j+6,3)call MultiboardSetItemStyle(Jy,true,true)call MultiboardSetItemIcon(Jy,"UI\\Feedback\\Resources\\ResourceGold.blp")call MultiboardSetItemWidth(Jy,.035)
call MultiboardReleaseItem(Jy)set Jy=MultiboardGetItem(D9[dk],j+6,4)call MultiboardSetItemStyle(Jy,true,true)call MultiboardSetItemIcon(Jy,"UI\\Feedback\\Resources\\ResourceLumber.blp")
call MultiboardSetItemWidth(Jy,.035)
call MultiboardReleaseItem(Jy)set Jy=MultiboardGetItem(D9[dk],j+6,5)call MultiboardSetItemStyle(Jy,true,true)call MultiboardSetItemIcon(Jy,"UI\\Feedback\\Resources\\ResourceManaStone.blp")call MultiboardSetItemWidth(Jy,.03)call MultiboardReleaseItem(Jy)set E9[i]=D9[dk]
set F9[i]=j+6set j=j+1endifset i=i+1exitwhen i>$Bendloopset Jy=nullendfunctionfunction My takes nothing returns nothinglocal integer i=IMaxBJ(CountPlayersInForceBJ(ie),CountPlayersInForceBJ(je))local integer j=0local multiboarditem Jycall MultiboardSetTitleText(G9,Rf)call MultiboardSetRowCount(G9,6+i)set I9=4+icall MultiboardSetColumnCount(G9,$B)
call MultiboardSetItemStyleBJ(G9,0,0,true,false)
call MultiboardSetItemWidthBJ(G9,1,0,8.)
call MultiboardSetItemWidthBJ(G9,6,0,1.)
call MultiboardSetItemWidthBJ(G9,7,0,8.)
set Jy=MultiboardGetItem(G9,I9+1,0)call MultiboardSetItemWidth(Jy,10.)call MultiboardReleaseItem(Jy)set i=0loop
set Jy=MultiboardGetItem(G9,0,i+0)call MultiboardSetItemValue(Jy,"|cffFFFF80Team|r")call MultiboardReleaseItem(Jy)set Jy=MultiboardGetItem(G9,0,i+1)call MultiboardSetItemValue(Jy,"|cffFFFF80Resc.|r")call MultiboardReleaseItem(Jy)set Jy=MultiboardGetItem(G9,0,i+2)call MultiboardSetItemValue(Jy,"|cffFFFF80Destr.|r")
call MultiboardReleaseItem(Jy)set Jy=MultiboardGetItem(G9,0,i+3)call MultiboardSetItemValue(Jy,"|cffFFFF80Income|r")
call MultiboardReleaseItem(Jy)set Jy=MultiboardGetItem(G9,0,i+4)call MultiboardSetItemValue(Jy,"|cffFFFF80Wins|r")call MultiboardReleaseItem(Jy)call MultiboardSetItemWidthBJ(G9,i+5,0,1.8)set i=i+(6)exitwhen i>6
endloopset Jy=MultiboardGetItem(G9,1,0)
call MultiboardSetItemValue(Jy,"|cffFF0000West|r")call MultiboardReleaseItem(Jy)set Jy=MultiboardGetItem(G9,1,6)
call MultiboardSetItemValue(Jy,"|cff00FF00East|r")call MultiboardReleaseItem(Jy)set Jy=MultiboardGetItem(G9,1,2)
call MultiboardSetItemValue(Jy,"0")call MultiboardReleaseItem(Jy)set Jy=MultiboardGetItem(G9,1,8)
call MultiboardSetItemValue(Jy,"0")call MultiboardReleaseItem(Jy)set Jy=MultiboardGetItem(G9,1,4)
call MultiboardSetItemValue(Jy,I2S(Hd[0]))call MultiboardReleaseItem(Jy)set Jy=MultiboardGetItem(G9,1,$A)call MultiboardSetItemValue(Jy,I2S(Hd[1]))call MultiboardReleaseItem(Jy)set i=0loop
set Jy=MultiboardGetItem(G9,3,i+0)call MultiboardSetItemValue(Jy,"|cffFFFF80Player|r")
call MultiboardReleaseItem(Jy)set Jy=MultiboardGetItem(G9,3,i+1)call MultiboardSetItemStyle(Jy,false,true)call MultiboardSetItemIcon(Jy,"ReplaceableTextures\\CommandButtons\\BTNHolyBolt.blp")call MultiboardReleaseItem(Jy)set Jy=MultiboardGetItem(G9,3,i+2)call MultiboardSetItemStyle(Jy,false,true)call MultiboardSetItemIcon(Jy,"UI\\Feedback\\Resources\\ResourceGold.blp")call MultiboardReleaseItem(Jy)set Jy=MultiboardGetItem(G9,3,i+3)call MultiboardSetItemStyle(Jy,false,true)call MultiboardSetItemIcon(Jy,"UI\\Feedback\\Resources\\ResourceLumber.blp")
call MultiboardReleaseItem(Jy)set Jy=MultiboardGetItem(G9,3,i+4)call MultiboardSetItemStyle(Jy,false,true)call MultiboardSetItemIcon(Jy,"ReplaceableTextures\\CommandButtons\\BTNChestOfGold.blp")
call MultiboardReleaseItem(Jy)set i=i+(6)exitwhen i>6
endloopset i=0set j=4loop
if(IsPlayerInForce(Player(i),ie))thenset H9[i]=jset Jy=MultiboardGetItem(G9,H9[i],0)
call MultiboardSetItemValue(Jy,pe[i])call MultiboardReleaseItem(Jy)set j=j+1else
set H9[i]=0endifset i=i+1exitwhen i>$Bendloopset i=0set j=4loop
if(IsPlayerInForce(Player(i),je))thenset H9[i]=jset Jy=MultiboardGetItem(G9,H9[i],6)
call MultiboardSetItemValue(Jy,pe[i])call MultiboardReleaseItem(Jy)set j=j+1endifset i=i+1exitwhen i>$Bendloopset Jy=nullendfunctionfunction Ny takes nothing returns nothinglocal integer i=0local player plocal string Oy=GetLocalizedString("TEAM_RESOURCES")+":"
if(bd>0 or Dd>0)then
if(h8)thencall Ts()endifendifif(h8)thencall Bn()endifif(G9!=null)then
call DestroyMultiboard(G9)endifset G9=CreateMultiboard()call My()loop
set p=Player(i)if(ne[i]!=null)thenif(D9[i]!=null)thencall DestroyMultiboard(D9[i])endifset D9[i]=CreateMultiboard()
call MultiboardSetRowCount(D9[i],4)call MultiboardSetColumnCount(D9[i],6)call MultiboardSetTitleText(D9[i],Rf)call MultiboardSetItemStyleBJ(D9[i],0,0,true,false)call MultiboardSetItemValueBJ(D9[i],0,0,"0")
call MultiboardSetItemValueBJ(D9[i],0,4,"")call MultiboardSetItemColorBJ(D9[i],6,0,'d',90.,.0,0)call MultiboardSetItemValueBJ(D9[i],1,1,"")call MultiboardSetItemValueBJ(D9[i],2,1,"Resc.")
call MultiboardSetItemValueBJ(D9[i],3,1,"Coins")
call MultiboardSetItemValueBJ(D9[i],4,1,"Destr.")call MultiboardSetItemValueBJ(D9[i],5,1,"Income")call MultiboardSetItemValueBJ(D9[i],6,1,"|cffFFFF80Wins|r")call MultiboardSetItemValueBJ(D9[i],1,2,"|cffFF0000West|r")call MultiboardSetItemValueBJ(D9[i],1,3,"|cff00FF00East|r")call MultiboardSetItemValueBJ(D9[i],1,4,"|cffFFFF00Round Time:|r")call MultiboardSetItemValueBJ(D9[i],6,4,"|cffFFFF000|cffFF8000:|cffFFFF0000|r")call MultiboardSetItemWidthBJ(D9[i],0,4,2.)call MultiboardSetItemWidthBJ(D9[i],1,4,7.)call MultiboardSetItemWidthBJ(D9[i],6,4,3.)if(CountPlayersInForceBJ(ne[i])>0)thencall Ky(i,Oy)endifendifset i=i+1exitwhen i>$Bendloopif(Sf==null)then
set Sf=CreateTimer()
call TimerStart(Sf,1.,true,function ly)endifcall Yr(5,1,I2S(Hd[0]))call Yr(5,2,I2S(Hd[1]))call Iy()endfunctionfunction Py takes nothing returns nothinglocal integer i=0loop
if(Uf[i]>3)thencall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,pe[i]+" |c00ff0000have used stopping bug!|r")endifset Uf[i]=0set i=i+1exitwhen i>$Bendloopendfunctionfunction Qy takes nothing returns booleanlocal unit u=GetTriggerUnit()if(GetIssuedOrderId()==$D0003)thenset Vf[GetPlayerId(GetOwningPlayer(u))]=M9if(IsUnitType(u,UNIT_TYPE_SAPPER))thencall Qo(u)elseif(GetUnitTypeId(u)=='h001')then
call cv(u)endifendifset u=nullreturn false
endfunctionfunction Ry takes nothing returns booleanlocal unit u=GetTriggerUnit()local integer dk=GetPlayerId(GetOwningPlayer(u))
if(GetIssuedOrderId()==$D0003)thenset Vf[GetPlayerId(GetOwningPlayer(u))]=M9if(IsUnitType(u,UNIT_TYPE_SAPPER))thencall Qo(u)set Uf[dk]=Uf[dk]+1elseif(GetUnitTypeId(u)=='h001')then
call cv(u)endifendifset u=nullreturn false
endfunctionfunction Sy takes nothing returns nothingif(Tf!=null)then
returnendifset Tf=CreateTrigger()call TriggerRegisterAnyUnitEventBJ(Tf,EVENT_PLAYER_UNIT_ISSUED_TARGET_ORDER)
call TriggerRegisterAnyUnitEventBJ(Tf,EVENT_PLAYER_UNIT_ISSUED_POINT_ORDER)if(wd)thencall TriggerAddCondition(Tf,Condition(function Ry))call TimerStart(CreateTimer(),1.5,true,function Py)else
call TriggerAddCondition(Tf,Condition(function Qy))endifendfunctionfunction Ty takes nothing returns nothinglocal integer i=0local player ploop
set p=Player(i)if(GetPlayerSlotState(p)==PLAYER_SLOT_STATE_PLAYING and GetPlayerController(p)==MAP_CONTROL_USER and not qe[i])thenif(M9-Vf[i]>4)thencall DisplayTextToPlayer(Player(i),.0,.0,"|cffCA0000WARNING|r: You did not move your worker for 5 minutes. AI will take control in 60 seconds!")
if(M9-Vf[i]>5)thencall Kt(i)endifendifendifset i=i+1exitwhen i>$Bendloopendfunctionfunction Uy takes nothing returns nothingif(Wf!=null)then
call PauseTimer(Wf)endifendfunctionfunction Vy takes nothing returns nothinglocal integer i=0loop
set Vf[i]=0set i=i+1exitwhen i>$Bendloopif(Wf!=null)then
call TimerStart(Wf,60.,true,function Ty)
endifendfunctionfunction Wy takes nothing returns nothingif(Wf==null)then
set Wf=CreateTimer()
endifendfunctionfunction Xy takes boolean fl returns nothing
local string s1local string s2if((not fl)and fg)thenreturnendifset fg=trueif(dd==1)thenif(Z9==0)thenset s1=pe[0]+" has chosen single round/pick race. You may pick your race! The first round determines the winner!"set s2="Single Round Pick"elseif(Z9==1)thenset s1=pe[0]+" has chosen single round/random race. You will get a random race! The first round determines the winner!"set s2="Single Round Random"
elseif(Z9==2)thenset s1=pe[0]+" has chosen single round/mirror mode. Both teams will get the same random races! The first round determines the winner!"set s2="Single Round Random"
elseif(Z9==3)thenset s1=pe[0]+" has chosen single round/draft race. Races will be drafted! The first round determines the winner!"set s2="Single Round Draft"endifelse
if(jd)thenif(Z9==0)thenset s1=pe[0]+" has chosen |cffFFFF00pick|r race. You may pick a race at the beginning that you keep for the |cffFFFF00whole game|r! Number of wins for overall victory: |cffFFFF00"+I2S(dd)+"|r"
set s2="Pick once, |cffFFCC00"+I2S(dd)+"|cffFFFF80 wins"
elseif(Z9==1)thenset s1=pe[0]+" has chosen |cffFFFF00random|r race. You will get a random race at the beginning that you keep for the |cffFFFF00whole game|r! Number of wins for overall victory: |cffFFFF00"+I2S(dd)+"|r"set s2="Random once, |cffFFCC00"+I2S(dd)+"|cffFFFF80 wins"elseif(Z9==2)thenset s1=pe[0]+" has chosen |cffFFFF00mirror mode|r. Both teams will get the same random races at the beginning that they will keep for the |cffFFFF00whole game|r! Number of wins for overall victory: |cffFFFF00"+I2S(dd)+"|r"set s2="Mirror once, |cffFFCC00"+I2S(dd)+"|cffFFFF80 wins"elseif(Z9==3)thenset s1=pe[0]+" has chosen |cffFFFF00draft|r race. You will draft a race at the beginning that you keep for the |cffFFFF00whole game|r! Number of wins for overall victory: |cffFFFF00"+I2S(dd)+"|r"set s2="Draft once, |cffFFCC00"+I2S(dd)+"|cffFFFF80 wins"endifelse
if(Z9==0)thenset s1=pe[0]+" has chosen |cffFFFF00pick|r race |cffFFFF00each round|r. You may pick a new race each round! Number of wins for overall victory: |cffFFFF00"+I2S(dd)+"|r"
set s2="Pick each round, |cffFFCC00"+I2S(dd)+"|cffFFFF80 wins"elseif(Z9==1)thenset s1=pe[0]+" has chosen |cffFFFF00random|r race |cffFFFF00each round|r. You will get a new random race each round! Number of wins for overall victory: |cffFFFF00"+I2S(dd)+"|r"set s2="Random each round, |cffFFCC00"+I2S(dd)+"|cffFFFF80 wins"
elseif(Z9==2)thenset s1=pe[0]+" has chosen  |cffFFFF00mirror mode each round|r. Both teams will get the same random races each round! Number of wins for overall victory: |cffFFFF00"+I2S(dd)+"|r"set s2="Mirror each round, |cffFFCC00"+I2S(dd)+"|cffFFFF80 wins"
elseif(Z9==3)thenset s1=pe[0]+" has chosen |cffFFFF00draft|r race |cffFFFF00each round|r. You will draft a new race each round! Number of wins for overall victory: |cffFFFF00"+I2S(dd)+"|r"set s2="Draft each round, |cffFFCC00"+I2S(dd)+"|cffFFFF80 wins"endifendifendifset Rf="|cffFFFF80"+s2+"|r"if(fl or not c9)then
call DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,25.,s1)endifendfunctionfunction Yy takes nothing returns nothingset eg[0]=nullset eg[1]=nullset eg[2]=nullset eg[3]=nullcall DialogClear(dg)
call DialogDestroy(dg)set dg=nullcall DestroyTimerDialog(Yf)set Yf=nullcall DestroyTimer(Xf)set Xf=nullcall DestroyTrigger(Zf)set Zf=nullcall Xy(false)call TriggerExecute(zg)endfunctionfunction Zy takes nothing returns nothingset jd=not(GetClickedButton()==eg[0])call TriggerSleepAction(.1)call Yy()endfunctionfunction dz takes nothing returns nothingcall TriggerSleepAction(.1)call DialogClear(dg)
call DialogSetMessage(dg,"New races after each round?")set eg[0]=DialogAddButton(dg,"YES",0)set eg[1]=DialogAddButton(dg,"NO",0)
call TriggerClearActions(Zf)
call TriggerAddAction(Zf,function Zy)call DialogDisplay(Player(0),dg,true)endfunctionfunction ez takes nothing returns nothingif(GetClickedButton()==eg[0])thenset V9="fz"set Z9=0
else
set V9="gz"set Z9=1
endifif(dd==1)thenset jd=false
call Yy()else
call dz()endifendfunctionfunction hz takes nothing returns nothingcall TriggerSleepAction(.1)call DialogClear(dg)
call DialogSetMessage(dg,"Race selection?")set eg[0]=DialogAddButton(dg,"Pick your race!",0)set eg[1]=DialogAddButton(dg,"Random race!",0)call TriggerClearActions(Zf)
call TriggerAddAction(Zf,function ez)call DialogDisplay(Player(0),dg,true)endfunctionfunction iz takes nothing returns nothinglocal button cl=GetClickedButton()local integer i=0loop
exitwhen cl==eg[i]set i=i+1endloopset dd=i+1set cl=nullcall hz()endfunctionfunction jz takes nothing returns nothingcall PauseTimer(Xf)set S9=false
if(Z9!=-1)thencall Yy()returnendifcall DialogSetMessage(dg,"Number of victories?")
set eg[0]=DialogAddButton(dg,"1",0)set eg[1]=DialogAddButton(dg,"2",0)set eg[2]=DialogAddButton(dg,"3",0)set eg[3]=DialogAddButton(dg,"4",0)call TriggerAddAction(Zf,function iz)call DialogDisplay(Player(0),dg,true)endfunctionfunction kz takes nothing returns nothingcall TimerStart(Xf,20.,false,function jz)set Yf=CreateTimerDialog(Xf)
call TimerDialogSetTitle(Yf,"Game starts:")call TimerDialogDisplay(Yf,true)
call DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,30.,"Welcome to |cffFFFF80Castle Fight|r |c0000ffffES|r |c0080ff001.22a|r! |cffFF0000"+GetPlayerName(Player(0))+"|r has now 20 seconds to choose game modes. If you are new to this map, you can find some useful hints in the |cff80FF00Manual|r (|cffFFBA17F9|r).")call DisplayTimedTextToPlayer(Player(0),.0,.0,30.,"Welcome to |cffFFFF80Castle Fight|r! You have 20 seconds to enter gamemodes. If you don't enter a valid command, you will be able to choose gamemodes via dialogues. If you don't know how to enter gamemodes read the |cff80FF00Manual|r (|cffFFBA17F9|r).")
call CinematicFadeBJ(1,.0,"ReplaceableTextures\\CameraMasks\\Black_mask.blp",.0,0,0,6.)call FlashQuestDialogButton()endfunctionfunction mz takes nothing returns nothingcall TimerStart(Xf,.01,false,function kz)call TriggerRegisterDialogEvent(Zf,dg)endfunctionfunction nz takes nothing returns nothingcall Rk(("Wins"),(GetEnumPlayer()),p7[('e')],I2S((1)),'g')call dm(GetEnumPlayer(),'g')
endfunctionfunction oz takes nothing returns nothingcall CustomVictoryBJ(GetEnumPlayer(),true,true)endfunctionfunction pz takes nothing returns nothingcall Rk(("Loses"),(GetEnumPlayer()),p7[('e')],I2S((1)),'g')call dm(GetEnumPlayer(),'f')
call CustomDefeatBJ(GetEnumPlayer(),"You were defeated!")endfunctionfunction qz takes nothing returns nothingcall RemoveUnit(GetEnumUnit())endfunctionfunction rz takes nothing returns nothinglocal unit u=GetEnumUnit()call ShowUnit(u,false)call KillUnit(u)
call RemoveUnit(u)set u=nullendfunctionfunction sz takes nothing returns nothingcall RemoveItem(GetEnumItem())endfunctionfunction tz takes nothing returns nothinglocal integer i=0set gg=false
set Fe=truecall Ym(false)call Uy()call FogEnable(false)call PauseTimer(a9)call PauseTimer(B9)call PauseTimer(jf)call PauseTimer(L9)call dj(false)call DestroyFogModifier(Ag)call DestroyFogModifier(ag)call TriggerClearActions(hg)
call DestroyTrigger(hg)call TriggerClearActions(ig)
call DestroyTrigger(ig)call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"The Score is |cffFF0000West|r: |cffFFCC00"+I2S(Hd[0])+" |cff00FF00East|r:|cffFFCC00 "+I2S(Hd[1])+"|r. Number of wins for overall victory: |cffFFCC00"+I2S(dd)+"|r")call Zv()call tm()if(mg>0)then
if(mg==2)thencall ForForce(ie,function nz)else
call ForForce(je,function nz)endifendifcall TriggerSleepAction(4.)call CinematicFadeBJ(1,2,"ReplaceableTextures\\CameraMasks\\Black_mask.blp",0,0,0,6.)call TriggerSleepAction(2.)set U9=false
set nh=false
loop
call GroupEnumUnitsOfPlayer(q4,Player(i),kg)
call ForGroup(q4,function rz)set i=i+1exitwhen i>$Bendloopcall GroupEnumUnitsInRect(q4,C9,kg)call ForGroup(q4,function qz)call TriggerSleepAction(3.)set i=0loop
call GroupEnumUnitsOfPlayer(q4,Player(i),kg)
call ForGroup(q4,function rz)set i=i+1exitwhen i>$Bendloopcall GroupEnumUnitsInRect(q4,C9,kg)call ForGroup(q4,function qz)set nh=trueset Bf[0]=0set Bf[1]=0call EnumItemsInRect(C9,null,function sz)if(mg>0)then
call TriggerSleepAction(11.)
if(mg==2)thencall ForForce(ie,function oz)call ForForce(je,function pz)else
call ForForce(je,function oz)call ForForce(ie,function pz)endifelse
call DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,10.,"Preparing for new round...")call TriggerSleepAction(7.)call TriggerExecute(zg)endifendfunctionfunction uz takes nothing returns booleanlocal unit u=GetFilterUnit()
local boolean Im=GetPlayerId(GetOwningPlayer(u))<$C and GetUnitAbilityLevel(u,'A02E')<1set u=nullreturn Imendfunctionfunction vz takes nothing returns nothingcall Rk(("RoundsWon"),(GetEnumPlayer()),p7[('e')],I2S((1)),'g')endfunctionfunction wz takes nothing returns nothingcall Rk(("RoundsLost"),(GetEnumPlayer()),p7[('e')],I2S((1)),'g')
endfunctionfunction xz takes nothing returns nothingif(not gg)thenreturnendifcall ForForce(ie,function vz)call ForForce(je,function wz)set Hd[1]=Hd[1]+1call Yr(5,2,I2S(Hd[1]))call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cff00FF00Eastern Forces|r have won the round!")if(Hd[1]>=dd)thencall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffFFFF00Congratulations! |cff00FF00Eastern Forces|r|cffFFFF00 have won the match! Game ends in one minute.|r")set mg=1
set T9=trueendifcall tz()endfunctionfunction yz takes nothing returns nothingif(not gg)thenreturnendifcall ForForce(je,function vz)call ForForce(ie,function wz)set Hd[0]=Hd[0]+1call Yr(5,1,I2S(Hd[0]))call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffFF0000Western Forces|r have won the round!")if(Hd[0]>=dd)thencall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffFFFF00Congratulations! |cffFF0000Western Forces|r|cffFFFF00 have won the match! Game ends in one minute.|r")set mg=2
set T9=trueendifcall tz()endfunctionfunction zz takes nothing returns nothingif(not gg)thenreturnendifcall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffFFAC00All players have voted for a draw, round will restart!|r")call tz()endfunctionfunction Az takes nothing returns nothingset kg=Filter(function uz)set jg=CreateTrigger()call TriggerAddAction(jg,function zz)endfunctionfunction az takes nothing returns nothingset pg=-1call TimerDialogDisplay(og,false)call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"Time is up and not all players have agreed. Extra rounds declined!")endfunctionfunction Bz takes integer dk returns nothing
if(pg==-1)thenreturnendifif(rg[dk])thenset rg[dk]=false
set qg=qg-1if(qg>0)then
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,pe[dk]+" has agreed, "+I2S(qg)+" more votes needed")else
set dd=dd+(pg)call PauseTimer(ng)call TimerDialogDisplay(og,false)call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"All players have agreed, number of rounds is increased by "+I2S(pg))set c9=truecall Xy(true)set pg=-1endifelse
call DisplayTextToPlayer(Player(dk),.0,.0,"You have already agreed!")endifendfunctionfunction bz takes integer ws returns nothing
local integer i=0if(ws<1 or ws>3)then
call DisplayTextToPlayer(Player(0),.0,.0,"Invalid number of rounds, must be between 1 and 3")returnendifset pg=wsset qg=0
loop
if(GetPlayerController(Player(i))==MAP_CONTROL_USER and GetPlayerSlotState(Player(i))==PLAYER_SLOT_STATE_PLAYING and(IsPlayerInForce(Player(i),ie)or IsPlayerInForce(Player(i),je)))then
set rg[i]=trueset qg=qg+1endifset i=i+1exitwhen i>$Bendloopcall TimerStart(ng,30.,false,function az)call TimerDialogDisplay(og,true)
call DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,30.,"|cffC6FF00"+I2S(ws)+" Extra Rounds|r vote has been started. You have 30 seconds to agree to it by typing |cffFFFF00-agree|r. If all players agree, the number of wins for overall victory will be increased by "+I2S(ws))
endfunctionfunction Cz takes nothing returns nothingcall TimerDialogDisplay(og,false)call TimerDialogSetTitle(og,"Voting XR")
endfunctionfunction cz takes nothing returns string
local string Imif(tg!=null)then
return tgendifif(Z9==1)thenset Im=" -r"
elseif(Z9==2)thenset Im=" -m"
elseif(Z9==3)thenset Im=" -d"
else
set Im=" -p"
endifif(jd)thenset Im=Im+("p")else
set Im=Im+("r")endifset Im=Im+(I2S(dd))if(ed==1)thenset Im=Im+("-slt")elseif(ed==2)thenset Im=Im+("-slb")endifif(gd>0)then
set Im=Im+"-fow"+I2S(gd)
elseif(gd==0)thenset Im=Im+("-nfow")endifif(hd!=$A)thenset Im=Im+"-it"+I2S(hd)endifif(kd)thenset Im=Im+("-du")endifif(zd)thenset Im=Im+("-ai")endifif(Fd>0)then
set Im=Im+("-fp")endifif(md)thenset Im=Im+("-na")endifif(nd)thenset Im=Im+("-ntb")endifif(od)thenset Im=Im+("-nb")endifif(not pd)thenset Im=Im+("-ns")endifif(not qd)thenset Im=Im+("-ni")endifif(not rd)thenset Im=Im+("-la")endifif(not sd)thenset Im=Im+("-nrs")endifif(td)thenset Im=Im+("-ur")endifif(not sd)thenset Im=Im+("-ca")endifif(vd)thenset Im=Im+("-dom")endifif(wd)thenset Im=Im+("-sd")endifif(xd)thenset Im=Im+("-nafk")endifif(not yd)thenset Im=Im+("-ndb")endifif(Ad==1)thenset Im=Im+("-nt")elseif(Ad==2)thenset Im=Im+("-ht")endifif(ad>-1)thenset Im=Im+"-ll"+I2S(ad)endifif(Bd>0)then
set Im=Im+"-ban"+I2S(Bd)
endifif(Bd<0)then
set Im=Im+"-rban"+I2S(-Bd)endifif(bd>0)then
set Im=Im+"-mp"+I2S(bd)endifif(Dd>0)then
set Im=Im+"-emp"+I2S(Dd)
endifif(Cd==$A)thenset Im=Im+(Im+"-cc")
elseif(Cd==1)thenset Im=Im+("-co")endifif(cd!=0)thenif(cd>0)then
set Im=Im+"-glw"+I2S(cd)
else
set Im=Im+"-gld"+I2S(IAbsBJ(cd))
endifendifif(not ud)thenset Im=Im+("-ca")endifif(W9!=$FA)thenset Im=Im+("-srg"+I2S(W9))endifif(X9!='}')thenset Im=Im+("-srl"+I2S(X9))endifif(Y9!=1)thenset Im=Im+("-sru"+I2S(Y9))endifif(Ed>0)then
set Im=Im+("-nfr"+I2S(Ed))endifset Im=Im+"-bal"+I2S(fd)
set tg=Imreturn Imendfunctionfunction Dz takes string s returns nothingif(StringLength(s)>0 and SubString(s,0,1)==" ")thenset s=SubString(s,1,StringLength(s))
endifset s=StringCase(s,false)if(SubString(s,0,3)=="ice")thencall xj(0)elseif(SubString(s,0,4)=="lava")then
call xj(1)elseif(SubString(s,0,4)=="ice2")then
call xj(2)else
call DisplayTextToPlayer(Player(0),.0,.0,"Sorry, but landscape [|c00ff0000"+s+"|r] not found.")endifendfunctionfunction Ez takes nothing returns nothingset ug=not ugif(ug)thencall PauseTimer(Xf)else
call ResumeTimer(Xf)
if(sg)thencall jz()endifendifendfunctionfunction Console_SpecControlSendsResume takes nothing returns nothingif(not ug)thencall ResumeTimer(Xf)
if(sg)thencall jz()endifendifendfunctionfunction Fz takes player Gz,integer Pk returns nothinglocal integer i=0local player pif(Pk>6)then
set Pk=6
endifif(CountPlayersInForceBJ(ie)+CountPlayersInForceBJ(je)+CountPlayersInForceBJ(ke)<Pk*2)thencall DisplayTextToPlayer(Gz,.0,.0,"Sorry, but command [|c00ff0000Fill|r] coudn't be executed. There are small count of quota players.")returnendifloop
exitwhen CountPlayersInForceBJ(ie)>=Pkset p=zn(true)call ForceRemovePlayer(ke,p)
call ForceAddPlayer(ie,p)call CreateFogModifierRectBJ(true,p,FOG_OF_WAR_VISIBLE,Q9)set Qd[GetPlayerId(p)]=dn(true)set ne[GetPlayerId(p)]=CreateForce()
call It(GetPlayerId(p))set i=i+1endlooploop
exitwhen CountPlayersInForceBJ(je)>=Pkset p=zn(false)call ForceRemovePlayer(ke,p)
call ForceAddPlayer(je,p)call CreateFogModifierRectBJ(true,p,FOG_OF_WAR_VISIBLE,Q9)set Qd[GetPlayerId(p)]=dn(false)
set ne[GetPlayerId(p)]=CreateForce()
call It(GetPlayerId(p))set i=i+1endloopcall Bn()call DisplayTextToPlayer(Gz,.0,.0,"There are added "+I2S(i)+" players.")
endfunctionfunction Hz takes string s returns booleanlocal integer i=S2I(s)if(i<=0)then
return false
endifset dd=IMinBJ(i,6)return trueendfunctionfunction Iz takes string s returns booleanif(s=="g")thenset jd=truereturn trueelseif(s=="r")thenset jd=false
return trueendifreturn false
endfunctionfunction lz takes integer t returns nothingif(t<0)thenreturnendifif(t==0)then
if(gd==-1)thencall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cff808080Deprecated activation of Permanent Fog of War has been encountered. Ignored.|r")
returnendifset gd=-1call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"Permanent |cffC6FF00Fog of War|r has been chosen")
returnendifset gd=t
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Fog of War|r time has been set to |cffFFFF00"+I2S(t)+"|r seconds.")endfunctionfunction Jz takes nothing returns nothingset gd=0
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Fog of War|r has been removed. All map will be visible.")endfunctionfunction Kz takes integer Lz returns nothing
if(Lz==0)thencall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,I2S(GetRandomInt(0,99)))else
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,I2S(GetRandomInt(0,Lz)))endifendfunctionfunction Mz takes string YC returns nothinglocal integer zC
local string ZClocal real i=$C0
local real Nzif ed>0 then
returnendifif YC=="u" or YC=="t" thenset zC=-1elseif YC=="d" or YC=="b" thenset zC=1
else
set zC=(GetRandomInt(0,1)*2)-1endifif zC==1 thenset ed=2
set ZC="bottom"else
set ed=1
set ZC="top"
endifset Nz=GetRectMaxY(bj_mapInitialPlayableArea)loop
exitwhen i>Nzcall CreateDestructable('YTfc',$5C0,i*zC,270,1,0)call CreateDestructable('YTfc',-$5C0,i*zC,270,1,0)set i=i+$80endloopset i=-$5F0loop
exitwhen i>$5F0call SetTerrainPathable(i,272*zC,PATHING_TYPE_WALKABILITY,false)
call SetTerrainPathable(i,272*zC,PATHING_TYPE_FLYABILITY,false)set i=i+32endloopcall CreateDestructable('B004',$5C0,640*zC,270,1.1,0)call CreateDestructable('B004',-$5C0,640*zC,270,1.1,0)call CreateDestructable('B004',$5C0,960*zC,270,1.1,0)call CreateDestructable('B004',-$5C0,960*zC,270,1.1,0)call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Single Lane|r has been chosen. Units are only able to walk/fly over the |cffFFFF00"+ZC+" lane|r.")endfunctionfunction Oz takes integer p,integer Pk returns nothingif(Pk==0)thenif(Xm(p))thencall DisplayTextToPlayer(Player(p),.0,.0,"Your |cffC6FF00Personal Timer|r has been disabled")else
call DisplayTextToPlayer(Player(p),.0,.0,"Your |cffC6FF00Personal Timer|r is already disabled!")
endifreturnendifif(Pk<4)then
call DisplayTextToPlayer(Player(p),.0,.0,"The value for Personal Timer must be more that |c00ff00003|r!")returnendifcall Wm(p,Pk)call DisplayTextToPlayer(Player(p),.0,.0,"Your |cffC6FF00Personal Timer|r has been started")
endfunctionfunction Pz takes integer tk returns nothing
set Gd[tk]=not Gd[tk]if(Gd[tk])thencall DisplayTextToPlayer(Player(tk),.0,.0,"|cffC6FF00Auto Training|r has been activated")else
call DisplayTextToPlayer(Player(tk),.0,.0,"|cffC6FF00Auto Training|r has been deactivated")endifendfunctionfunction Qz takes string Rz,integer Pk returns nothingif(Rz=="g" or Rz=="G")thencall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Start Resources|r has been changed. The amount of start |c00ffdc00Gold|r is |cffFFFF00"+I2S(Pk)+"|r.")set W9=Pkelseif(Rz=="l" or Rz=="L")thencall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Start Resources|r has been changed. The amount of start |c0000c850Lumber|r is |cffFFFF00"+I2S(Pk)+"|r.")
set X9=Pkelseif(Rz=="u" or Rz=="U")thencall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"|cffC6FF00Start Resources|r has been changed. The amount of start |c008000ffLegendaries limit|r is |cffFFFF00"+I2S(Pk)+"|r.")set Y9=Pkelse
call DisplayTextToPlayer(Player(0),.0,.0,"Sorry, but resorce [|c00ff0000"+Rz+"|r] couldn't be identified.")endifendfunctionfunction Sz takes string s,integer tk returns nothinglocal player pif(StringLength(s)<=2)thenreturnendifif(S9 and tk==0 and SubString(s,1,3)=="na")thencall is(false)elseif(S9 and tk==0 and SubString(s,1,3)=="ai")thencall hs(true)elseif(S9 and tk==0 and SubString(s,1,3)=="co")thencall ks()elseif(S9 and tk==0 and SubString(s,1,3)=="cc")thencall ms()elseif(S9 and tk==0 and SubString(s,1,3)=="du")thencall ns(true)elseif(S9 and tk==0 and SubString(s,1,4)=="ntb")then
call ps(false)elseif(S9 and tk==0 and SubString(s,1,3)=="nb")thencall qs(false)elseif(S9 and tk==0 and SubString(s,1,3)=="ns")thencall rs(false)elseif(S9 and tk==0 and SubString(s,1,3)=="ni")thencall ss(false)elseif(S9 and tk==0 and SubString(s,1,3)=="la")thencall ts(false)elseif(S9 and tk==0 and SubString(s,1,3)=="sr" and StringLength(s)>4)thencall Qz(SubString(s,3,4),S2I(SubString(s,4,StringLength(s))))elseif(S9 and tk==0 and SubString(s,1,4)=="nrs")then
call us(false)elseif(S9 and tk==0 and SubString(s,1,3)=="sl" and ed==0)thencall Mz(SubString(s,3,4))elseif(S9 and tk==0 and SubString(s,1,3)=="ur")thencall os(true)elseif(S9 and tk==0 and SubString(s,1,3)=="it")thencall xs(S2I(SubString(s,3,StringLength(s))))
elseif(S9 and tk==0 and SubString(s,1,4)=="glw")then
call Gs(S2I(SubString(s,4,StringLength(s))))
elseif(S9 and tk==0 and SubString(s,1,4)=="gld")then
call Gs(-1*S2I(SubString(s,4,StringLength(s))))elseif((not S9)and tk==0 and SubString(s,1,3)=="xr")then
call bz(S2I(SubString(s,3,StringLength(s))))
elseif(S9 and tk==0 and SubString(s,1,3)=="mp")thencall Ds(S2I(SubString(s,3,StringLength(s))))
elseif(S9 and tk==0 and SubString(s,1,4)=="emp")then
call cs(S2I(SubString(s,4,StringLength(s))))
elseif(S9 and tk==0 and SubString(s,1,3)=="ll")thencall vs(S2I(SubString(s,3,StringLength(s))))
elseif(S9 and tk==0 and SubString(s,1,3)=="ht")thencall ys(2)elseif(S9 and tk==0 and SubString(s,1,3)=="nt")thencall ys(1)elseif(S9 and tk==0 and SubString(s,1,3)=="ca")thencall As(false)elseif(S9 and tk==0 and SubString(s,1,3)=="sd")thencall Es(true)elseif(S9 and tk==0 and SubString(s,1,4)=="dom")then
call as(true)elseif(S9 and tk==0 and SubString(s,1,4)=="fow")then
call lz(S2I(SubString(s,4,StringLength(s))))
elseif(S9 and tk==0 and SubString(s,1,5)=="nfow")thencall Jz()elseif(S9 and tk==0 and SubString(s,1,5)=="rban")thencall bs(S2I(SubString(s,5,StringLength(s))))
elseif(S9 and tk==0 and SubString(s,1,4)=="ban")then
call Cs(S2I(SubString(s,4,StringLength(s))))
elseif(S9 and tk==0 and SubString(s,1,4)=="bal")then
call Bs(S2I(SubString(s,4,StringLength(s))))
elseif(S9 and tk==0 and SubString(s,1,4)=="nfr")then
call Hs(S2I(SubString(s,4,StringLength(s))))
elseif(S9 and tk==0 and SubString(s,1,4)=="ndb")then
call Fs(false)elseif(S9 and tk==0 and SubString(s,1,4)=="env")then
call Dz(SubString(s,4,StringLength(s)))elseif(S9 and tk==0 and SubString(s,1,5)=="fill")thencall Fz(Player(tk),S2I(SubString(s,5,StringLength(s))))elseif(S9 and tk==0 and SubString(s,1,5)=="nafk")thencall js(true)elseif(S9 and tk==0 and SubString(s,1,6)=="pause")thencall Ez()elseif(S9 and tk==0 and SubString(s,1,5)=="skip")thenif(ug)thenset sg=trueelse
call jz()endifelseif(S9 and tk==0 and SubString(s,1,2)=="r" and Iz(SubString(s,2,3))and Hz(SubString(s,3,4)))thenset Z9=1
set V9="gz"call Xy(true)elseif(S9 and tk==0 and SubString(s,1,2)=="p" and Iz(SubString(s,2,3))and Hz(SubString(s,3,4)))thenset Z9=0
set V9="fz"call Xy(true)elseif(S9 and tk==0 and SubString(s,1,2)=="m" and Iz(SubString(s,2,3))and Hz(SubString(s,3,4)))thenset Z9=2
set V9="Tz"call Xy(true)elseif(S9 and tk==0 and SubString(s,1,2)=="d" and Iz(SubString(s,2,3))and Hz(SubString(s,3,4)))thenset Z9=3
set V9="Uz"call Xy(true)elseif(SubString(s,1,6)=="stats" and not S9)then
call Sv(Player(tk))elseif(SubString(s,1,4)=="afk" and(not S9)and not xd)thencall Kt(tk)elseif(SubString(s,1,3)=="at")thencall Pz(tk)elseif(SubString(s,1,5)=="mode" and(not S9))then
call DisplayTimedTextToPlayer(Player(tk),.0,.0,10.,"|cffFFFF00Game-config-string|r:")call DisplayTimedTextToPlayer(Player(tk),.0,.0,10.,cz())
elseif(SubString(s,1,7)=="income" and not S9)thencall Rv(Player(tk))elseif(SubString(s,1,6)=="armor")thenset p=Player(tk)
call DisplayTimedTextToPlayer(p,.0,.0,10.,"|cffFFFF00Armor table:")call DisplayTimedTextToPlayer(p,.0,.0,10.,"|cffFFCC00Chaos damage:    |cffFFFF00neutral against all|r")call DisplayTimedTextToPlayer(p,.0,.0,10.,"|cffFFCC00Normal damage: |cff00FF00good against:|r medium |cffFF0000bad against:|r light")call DisplayTimedTextToPlayer(p,.0,.0,10.,"|cffFFCC00Pierce damage:   |cff00FF00good against:|r light        |cffFF0000bad against:|r heavy")call DisplayTimedTextToPlayer(p,.0,.0,10.,"|cffFFCC00Magic damage:   |cff00FF00good against:|r heavy      |cffFF0000bad against:|r medium")call DisplayTimedTextToPlayer(p,.0,.0,10.,"|cffFFCC00Siege damage:     |cff00FF00good against:|r fortified |cffFF0000bad against:|r all others")
call DisplayTimedTextToPlayer(p,.0,.0,10.,"|cffFFCC00Note:|r All attack types are |cffFF0000bad|r against divine besides chaos!")elseif(tk==0 and SubString(s,1,5)=="roll")thencall Kz(S2I(SubString(s,5,StringLength(s))))
elseif(SubString(s,1,5)=="draw")then
call Zj(tk)elseif(SubString(s,1,3)=="mt")thencall Oz(tk,S2I(SubString(s,3,StringLength(s))))elseif(SubString(s,1,6)=="agree")thencall Bz(tk)else
call DisplayTextToPlayer(Player(tk),.0,.0,"Sorry, but command [|c00ff0000"+SubString(s,1,StringLength(s))+"|r] coudn't be executed. You are not allowed to perform it in current time or you have mistake in syntax.")endifendfunctionfunction Vz takes nothing returns booleanreturn SubString(GetEventPlayerChatString(),0,1)=="-"endfunctionfunction Wz takes nothing returns nothinglocal string Xz=GetEventPlayerChatString()local string s=StringCase(Xz,false)local integer Yz=0local integer Zz=0local integer dA=StringLength(s)
local integer i=0local integer id=GetPlayerId(GetTriggerPlayer())
local string chcall Pj("CE: "+Xz)call Rj()loop
set ch=SubString(s,i,i+1)if ch=="-" thenif Yz!=i thenif Zz>0 then
call Sz(SubString(s,Yz,Zz)+SubString(Xz,Zz,i),id)else
call Sz(SubString(s,Yz,i),id)endifendifset Yz=i
set Zz=0
elseif Zz==0 and ch==" " thenset Zz=i
endifset i=i+1exitwhen i>=dAendloopif Zz>0 then
call Sz(SubString(s,Yz,Zz)+SubString(Xz,Zz,i),id)else
call Sz(SubString(s,Yz,i),id)endifendfunctionfunction eA takes nothing returns nothinglocal trigger t=CreateTrigger()call DestroyTimer(GetExpiredTimer())
call TriggerRegisterPlayerChatEvent(t,Player(0),"-",false)call TriggerRegisterPlayerChatEvent(t,Player(1),"-",false)call TriggerRegisterPlayerChatEvent(t,Player(2),"-",false)call TriggerRegisterPlayerChatEvent(t,Player(3),"-",false)call TriggerRegisterPlayerChatEvent(t,Player(4),"-",false)call TriggerRegisterPlayerChatEvent(t,Player(5),"-",false)call TriggerRegisterPlayerChatEvent(t,Player(6),"-",false)call TriggerRegisterPlayerChatEvent(t,Player(7),"-",false)call TriggerRegisterPlayerChatEvent(t,Player(8),"-",false)call TriggerRegisterPlayerChatEvent(t,Player(9),"-",false)call TriggerRegisterPlayerChatEvent(t,Player($A),"-",false)call TriggerRegisterPlayerChatEvent(t,Player($B),"-",false)call TriggerAddCondition(t,Condition(function Vz))call TriggerAddAction(t,function Wz)
set t=nullendfunctionfunction fA takes nothing returns nothingcall TimerStart(CreateTimer(),.2,false,function eA)endfunctionfunction gA takes nothing returns nothingcall FogEnable(false)set U9=trueendfunctionfunction hA takes nothing returns nothinglocal integer ilocal unit u
local player pllocal player prlocal boolean iA=falseset K9=K9+1call Pj("RE: "+I2S(K9))call Rj()call FogEnable(true)
set pl=ForcePickRandomPlayer(ie)
set pr=ForcePickRandomPlayer(je)
if(K9==1)thencall Lt()endifif(pl==null)then
set pl=Player(0)
endifif(pr==null)then
set pr=Player(6)
if(K9==1)thencall ForceRemovePlayer(ke,pr)call ForceAddPlayer(je,pr)call CreateFogModifierRectBJ(true,pr,FOG_OF_WAR_VISIBLE,Q9)set Qd[6]=dn(false)set ne[6]=CreateForce()call It(6)endifendifcall Ny()call Wo()call DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,9.5,"Get ready for round |cffFFCC00"+I2S(K9)+"|r!")call CinematicFadeBJ(0,4.,"ReplaceableTextures\\CameraMasks\\Black_mask.blp",0,0,0,6.)set Ag=CreateFogModifierRectBJ(true,ForcePickRandomPlayer(ie),FOG_OF_WAR_VISIBLE,cg)
set ag=CreateFogModifierRectBJ(true,ForcePickRandomPlayer(je),FOG_OF_WAR_VISIBLE,Dg)
set hg=CreateTrigger()set ig=CreateTrigger()set oe[0]=CreateUnitAtLoc(pl,'hcas',Id[1],270.)call SetUnitX(oe[0],GetLocationX(Id[1]))
call SetUnitY(oe[0],GetLocationY(Id[1]))
call SetUnitColor(oe[0],PLAYER_COLOR_RED)if(not qd)thencall UnitRemoveAbility(oe[0],'Aall')
call UnitRemoveAbility(oe[0],'Apit')
endifcall TriggerRegisterDeathEvent(hg,oe[0])
set oe[1]=CreateUnitAtLoc(pr,'hcas',Id[0],270.)call SetUnitX(oe[1],GetLocationX(Id[0]))
call SetUnitY(oe[1],GetLocationY(Id[0]))
call SetUnitColor(oe[1],PLAYER_COLOR_GREEN)if(not qd)thencall UnitRemoveAbility(oe[1],'Aall')
call UnitRemoveAbility(oe[1],'Apit')
endifcall TriggerRegisterDeathEvent(ig,oe[1])
call TriggerAddAction(hg,function xz)call TriggerAddAction(ig,function yz)if(vd)thencall Dn()endifcall TriggerSleepAction(4.)call mn()call vm()call Hy()call UnitShareVision(oe[0],pr,true)call UnitShareVision(oe[1],pl,true)call TriggerSleepAction(1.)call UnitShareVision(oe[0],pr,false)
call UnitShareVision(oe[1],pl,false)
call Sy()if(not jd or K9==1)thenif(not xd)thencall Wy()endifcall Lm()if(Bd!=0)thenif(Bd>0)then
call ExecuteFunc("jA")else
call ExecuteFunc("kA")endifloop
call TriggerSleepAction(1.)exitwhen wgendloopset wg=false
endifset i=0loop
set Pd[i]=0set i=i+1exitwhen i>$Bendloopcall Km()call ExecuteFunc(V9)
loop
call TriggerSleepAction(1.)exitwhen wgendloopset wg=false
call DisableTrigger(J7)endifset Md[0]=0set Md[1]=0set Nd[0]=0set Nd[1]=0set i=0loop
if(Pd[i]!=0)then
if(Pd[i]=='h00C')thenset iA=trueendifset u=CreateUnitAtLoc(Player(i),Pd[i],Qd[i],180.*me[i])if(not sd)thencall UnitRemoveAbility(u,'A005')
call UnitRemoveAbility(u,'A06E')
else
set Md[me[i]]=Md[me[i]]+1call Zr(H9[i],me[i]*6+1,"V")
endifcall PanCameraToTimedLocForPlayer(Player(i),Qd[i],.01)call SetPlayerState(Player(i),PLAYER_STATE_RESOURCE_GOLD,W9)
call SetPlayerState(Player(i),PLAYER_STATE_RESOURCE_LUMBER,X9)if(rd)thencall SetPlayerState(Player(i),PLAYER_STATE_RESOURCE_FOOD_CAP,Y9)
else
call SetPlayerState(Player(i),PLAYER_STATE_RESOURCE_FOOD_CAP,0)endifif(E9[i]!=null)thencall UnitAddAbility(u,'A0A5')endifcall Js(i)else
call ls(i)endifset i=i+1exitwhen i>$Bendloopcall Yr(1,1,I2S(Md[0]))call Yr(1,2,I2S(Md[1]))call TimerStart(jf,hd,true,function Qv)call fj()if(gd!=-1)thencall TimerStart(vg,gd,false,function gA)
endifset M9=0
set N9=0
call TimerStart(L9,1.,true,function es)call Nr()call TimerStart(B9,4.,true,function Mr)call nk()call Xj()call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,"Round |cffFFCC00"+I2S(K9)+"|r started! gl & hf!")call PlaySoundBJ(Gg)
call Mt()call Um()set gg=trueset u=nullcall dp(iA)call Ym(true)call Vy()call Zr(I9+1,0,"|cffFFCC00Modes:|r"+cz())endfunctionfunction mA takes nothing returns nothingset xg=nn()set yg=nn()call Om(xg,yg)endfunctionfunction nA takes nothing returns nothingcall li(xg)call li(yg)set wg=trueendfunctionfunction oA takes integer id,boolean pA returns nothingif(kd)thenif(td)thenif(pA)thencall on(yg,id)else
call on(xg,id)endifendifelse
if(td)thencall on(xg,id)call on(yg,id)else
if(pA)thencall on(xg,id)else
call on(yg,id)endifendifendifendfunctionfunction qA takes nothing returns nothingcall TriggerAddAction(zg,function hA)endfunctionfunction jA takes nothing returns nothinglocal timer rAlocal timerdialog sA
local integer ct
local integer tA
local player plocal integer uA
local integer dk
call mA()set rA=CreateTimer()
set sA=CreateTimerDialog(rA)
call TimerDialogSetTitle(sA,"Time to ban:")call TimerDialogDisplay(sA,true)
set ct=GetRandomInt(0,1)
set tA=Bd*2loop
if(ct==0)thenset p=vn(ie)
set ct=1
else
set p=vn(je)
set ct=0
endifset dk=GetPlayerId(p)call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,pe[dk]+", your turn to ban race now...")call TimerStart(rA,15.,false,null)set uA=Fm(CreateUnit(p,'h09W',GetLocationX(Qd[dk]),GetLocationY(Qd[dk]),270.),15.)if(uA==-1)thenset uA=pn(xg)endifcall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,pe[dk]+" has banned |cffFFFF00"+zm(uA))
call on(xg,uA)call Bm(uA,false)set tA=tA-1exitwhen tA<=0endloopcall DestroyTimerDialog(sA)set sA=nullcall DestroyTimer(rA)set rA=nullcall nA()endfunctionfunction vA takes integer Gz returns nothing
call oA(Pd[Gz],IsPlayerInForce(Player(Gz),ie))if(kd)thenif(td)thencall Cm(Pd[Gz],false,ModuloInteger(me[Gz]+1,2))endifelse
if(td)thencall Bm(Pd[Gz],false)else
call Cm(Pd[Gz],false,me[Gz])
endifendifendfunctionfunction wA takes nothing returns nothinglocal trigger t=GetTriggeringTrigger()local timer rAlocal timerdialog sA
local integer xA=0local integer yA=0local integer ct
local player zAlocal integer i=0local integer dk
call mA()set rA=CreateTimer()
set sA=CreateTimerDialog(rA)
call TimerDialogSetTitle(sA,"Time to select:")call TimerDialogDisplay(sA,true)
if(Bg<0)then
set Bg=GetRandomInt(0,1)
endifset Bg=ModuloInteger(Bg+1,2)
set ct=1+2*Bgloop
set Pd[i]=0set i=i+1exitwhen i>$Bendlooploop
set zA=nullif(ct<2)then
loop
if(IsPlayerInForce(Player(xA),ie))thenset zA=Player(xA)endifset xA=xA+1exitwhen zA!=null or xA>$Bendloopelse
loop
if(IsPlayerInForce(Player(yA),je))thenset zA=Player(yA)endifset yA=yA+1exitwhen zA!=null or yA>$Bendloopendifset ct=ct+1if(ct>=4)thenset ct=0
endifexitwhen zA==null and xA>$B and yA>$Bif(zA!=null)then
set dk=GetPlayerId(zA)call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,pe[dk]+" is selecting now...")call TimerStart(rA,15.,false,null)set Pd[dk]=Fm(CreateUnit(zA,'h033',GetLocationX(Qd[dk]),GetLocationY(Qd[dk]),270.),15.)if(Pd[dk]==-1)thencall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,pe[dk]+" skipped selection.")else
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,pe[dk]+" controls |cffFFFF00"+zm(Pd[dk])+"|r.")
call vA(dk)endifendifendloopset i=0loop
if(Pd[i]==-1)thenset zA=Player(i)
if(IsPlayerInForce(zA,ie))thenset Pd[i]=pn(xg)
call vA(i)elseif(IsPlayerInForce(zA,je))thenset Pd[i]=pn(yg)
call vA(i)endifcall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,pe[i]+" controls |cffFFFF00"+zm(Pd[i])+"|r.")endifset i=i+1exitwhen i>$Bendloopcall DestroyTimerDialog(sA)set sA=nullcall DestroyTimer(rA)set rA=nullcall nA()call TriggerClearActions(t)call DestroyTrigger(t)set t=nullendfunctionfunction Uz takes nothing returns nothinglocal trigger t=CreateTrigger()call TriggerAddAction(t,function wA)
call TriggerExecute(t)set t=nullendfunctionfunction Tz takes nothing returns nothinglocal integer i=0local integer j=0local integer array AAlocal force f1local force f2call mA()if(CountPlayersInForceBJ(ie)>=CountPlayersInForceBJ(je))then
set f1=ieset f2=jeelse
set f1=jeset f2=ieendifloop
if(IsPlayerInForce(Player(i),f1))thenset Pd[i]=pn(xg)
if(not kd)thencall on(xg,Pd[i])endifset AA[j]=Pd[i]set j=j+1endifset i=i+1exitwhen i>$Bendloopset i=0set j=0loop
if(IsPlayerInForce(Player(i),f2))thenset Pd[i]=AA[j]set j=j+1endifset i=i+1exitwhen i>$Bendloopset f1=nullset f2=nullcall nA()endfunctionfunction aA takes integer Gz returns nothing
call oA(D7[Gz],IsPlayerInForce(Player(Gz),ie))if(kd)thenif(td)thencall Cm(D7[Gz],false,ModuloInteger(me[Gz]+1,2))endifelse
if(td)thencall Bm(D7[Gz],false)else
call Cm(D7[Gz],false,me[Gz])
endifendifendfunctionfunction BA takes nothing returns booleanset bg=bg-1if(D7[c7]==-1)thenreturn false
endifcall aA(c7)return false
endfunctionfunction bA takes nothing returns nothinglocal trigger t=GetTriggeringTrigger()local timer rAlocal timerdialog sA
local unit array CAlocal integer i=0local player plocal integer uA
local integer dk
call mA()set rA=CreateTimer()
set sA=CreateTimerDialog(rA)
call TimerDialogSetTitle(sA,"Time to select:")call TimerDialogDisplay(sA,true)
set Cg=CreateTrigger()call TriggerAddCondition(Cg,Condition(function BA))set C7=Cgset bg=0
loop
set p=Player(i)if(IsPlayerInForce(p,ie)or IsPlayerInForce(p,je))thenset CA[i]=Em(CreateUnit(p,'h033',GetLocationX(Qd[i]),GetLocationY(Qd[i]),270.))set bg=bg+1endifset i=i+1exitwhen i>$Bendloopcall TimerStart(rA,15.,false,null)loop
call TriggerSleepAction(.33)
exitwhen TimerGetRemaining(rA)<.33 or bg<=0endloopcall TriggerClearConditions(Cg)call DestroyTrigger(Cg)set i=0loop
set p=Player(i)if(IsPlayerInForce(p,ie)or IsPlayerInForce(p,je))thenif(D7[i]==-1 or D7[i]==0)thenif(IsPlayerInForce(p,ie))thenset D7[i]=pn(xg)
elseif(IsPlayerInForce(p,je))thenset D7[i]=pn(yg)
endifcall aA(i)endifset Pd[i]=D7[i]else
set Pd[i]=0endifcall RemoveUnit(CA[i])set CA[i]=nullset i=i+1exitwhen i>$Bendloopcall DestroyTimerDialog(sA)set sA=nullcall DestroyTimer(rA)set rA=nullcall nA()call TriggerClearActions(t)call DestroyTrigger(t)set t=nullendfunctionfunction fz takes nothing returns nothinglocal trigger t=CreateTrigger()call TriggerAddAction(t,function bA)
call TriggerExecute(t)set t=nullendfunctionfunction kA takes nothing returns nothinglocal integer tA=IAbsBJ(Bd)local string s=""local integer uA
call mA()loop
set uA=pn(xg)call on(xg,uA)call Bm(uA,false)if(s=="")thenset s=zm(uA)
else
set s=s+", "+zm(uA)endifset tA=tA-1exitwhen tA<=0endloopcall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,s+" have banned by Random.")call nA()endfunctionfunction gz takes nothing returns nothinglocal integer i=0call mA()loop
if(IsPlayerInForce(Player(i),ie))thenset Pd[i]=pn(xg)
call oA(Pd[i],true)elseif(IsPlayerInForce(Player(i),je))thenset Pd[i]=pn(yg)
call oA(Pd[i],false)
endifset i=i+1exitwhen i>$Bendloopcall nA()endfunctionfunction cA takes unit u,unit j returns nothingif(GetUnitAbilityLevel(j,'A0DZ')>0)thencall Wr(u,j)
endifendfunctionfunction DA takes nothing returns nothinglocal unit u=GetSummonedUnit()local integer aj=GetUnitTypeId(u)if(aj=='h03C')thencall SetUnitState(u,UNIT_STATE_MANA,30.)
elseif(aj=='h03A')thencall TriggerSleepAction(.7)call IssueImmediateOrderById(u,$D0057)call TriggerSleepAction(.1)elseif(GetUnitAbilityLevel(u,'A07M')>0)thencall Mo(u)call GroupAddUnit(z9,u)elseif(aj=='h030')thencall UnitRemoveType(u,UNIT_TYPE_SUMMONED)if(GetUnitTypeId(GetSummoningUnit())=='h030')thenset u=ReplaceUnitBJ(u,'h02Z',2)else
call cA(u,GetSummoningUnit())endifendifcall Qo(u)set u=nullendfunctionfunction FA takes integer dk returns nothing
local unit u
call GroupEnumUnitsOfPlayer(q4,Player(dk),b9)set u=FirstOfGroup(q4)if(u==null)thenreturnendifif(GetUnitAbilityLevel(u,'A005')>0)thenset Md[me[dk]]=Md[me[dk]]-1if(Md[me[dk]]==0)thencall Yr(1,me[dk]+1,"|cffFF00000|r")else
call Yr(1,me[dk]+1,I2S(Md[me[dk]]))endifendifcall RemoveUnit(u)set u=nullendfunctionfunction GA takes nothing returns nothinglocal unit u=GetEnumUnit()local integer HA
if(IsUnitType(u,UNIT_TYPE_STRUCTURE))thencall SetUnitOwner(u,ForcePickRandomPlayer(mh),true)set HA=(x4[GetUnitPointValue((u))])if(HA>0)then
call IssueImmediateOrderById(u,HA)call IssueImmediateOrderById(u,HA)endifset HA=GetPlayerId(GetOwningPlayer(u))call Nv(HA,u)if(not v4[GetUnitPointValue(u)])then
set Ud[HA]=Ud[HA]+1endifelse
call SetUnitOwner(u,ForcePickRandomPlayer(mh),true)call Qo(u)endifset u=nullendfunctionfunction IA takes nothing returns nothinglocal player p=GetEnumPlayer()local integer dk=GetPlayerId(p)local integer i=CountPlayersInForceBJ(mh)local integer g=GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)/ ilocal integer l=GetPlayerState(p,PLAYER_STATE_RESOURCE_LUMBER)/ ilocal string s="You received |cffFFFF00"+I2S(g)+"|r gold and |cffFFFF00"+I2S(l)+"|r lumber from "+pe[dk]
call ls(dk)call FA(dk)call fn(Qd[dk])call ForceAddPlayer(ke,p)call GroupEnumUnitsOfPlayer(q4,p,null)call ForGroup(q4,function GA)set i=0loop
set p=Player(i)if(IsPlayerInForce(p,mh))thencall AdjustPlayerStateBJ(g,p,PLAYER_STATE_RESOURCE_GOLD)
call AdjustPlayerStateBJ(l,p,PLAYER_STATE_RESOURCE_LUMBER)call DisplayTextToPlayer(p,.0,.0,s)endifset i=i+1exitwhen i>$Bendloopendfunctionfunction lA takes integer dk returns nothing
local player p=Player(dk)call ForceRemovePlayer(mh,p)
call wn(mh,ne[dk])call ForceAddPlayer(ne[dk],p)call ForForce(ne[dk],function IA)call DestroyForce(ne[dk])set ne[dk]=nullendfunctionfunction JA takes integer dk returns nothing
local integer i=0local player p=Player(dk)local force KA=ne[dk]local unit u
call ForceAddPlayer(KA,p)set ne[dk]=nullloop
if(IsPlayerInForce(Player(i),mh)and ne[i]!=null)then
set p=vn(KA)
exitwhen p==null
call ForceRemovePlayer(KA,p)
call ForceAddPlayer(ne[i],p)
call SetPlayerName(p,l9[i])call Ls(GetPlayerId(p))call GroupEnumUnitsOfPlayer(q4,p,b9)
set u=FirstOfGroup(q4)if(u!=null and GetUnitAbilityLevel(u,'A0A5')<=0)then
call UnitAddAbility(u,'A0A5')endifendifset i=i+1if(i>$B)then
set i=0endifendloopset h8=truecall Ny()set u=nullendfunctionfunction LA takes player p returns nothinglocal integer dk=GetPlayerId(p)if(T9)thenreturnendifcall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,pe[dk]+" |cffCA0000has left the game!|r")call Zj(dk)if(IsPlayerInForce(p,ie))thencall Rk(("Loses"),(p),p7[('e')],I2S((1)),'g')call dm(p,'h')set mh=ieif(xn()<=1)thenset mg=1
set T9=truecall DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,60.,"All players of |cffFF0000Western Forces|r left. |cff00FF00Eastern Forces|r have won!")call TriggerExecute(hg)returnendifelseif(IsPlayerInForce(p,je))thencall Rk(("Loses"),(p),p7[('e')],I2S((1)),'g')call dm(p,'h')set mh=jeif(yn()<=1)thenset mg=2
set T9=truecall DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,60.,"All players of |cff00FF00Eastern Forces|r left. |cffFF0000Western Forces|r have won!")call TriggerExecute(ig)returnendifelse
returnendifif(fd==0)thencall lA(dk)elseif(fd==1)thencall JA(dk)else
call It(dk)endifendfunctionfunction MA takes nothing returns nothingcall LA(GetTriggerPlayer())endfunctionfunction OA takes integer dk returns nothing
set Q[me[dk]+4]=Q[me[dk]+4]+1call Yr(2,me[dk]+1,I2S(Q[me[dk]+4]))
if(Q[me[dk]]==dk)thenset Q[me[dk]+2]=Q[me[dk]+2]+1if(Q[me[dk]+2]==3)thencall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,pe[dk]+"|cffFFFF80 just collected |cffFFFF003|cffFFFF80 coins in a row for the "+Od[me[dk]]+"|cffFFFF00! Very nice!")elseif(Q[me[dk]+2]==5)thencall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,pe[dk]+"|cffFFFF80 just collected|cffFFFF00 5|cffFFFF80 coins in a row for the "+Od[me[dk]]+"|cffFFFF00! Impressive!")elseif(Q[me[dk]+2]==$A)thencall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,pe[dk]+"|cffFFFF80 just collected|cffFFFF00 10|cffFFFF80 coins in a row for the "+Od[me[dk]]+"|cffFFFF00! Sick!")endifelse
set Q[me[dk]]=dk
set Q[me[dk]+2]=1endifendfunctionfunction PA takes nothing returns nothinglocal integer mk
local unit u=GetTriggerUnit()local player p=GetOwningPlayer(u)local item it=GetManipulatedItem()local integer bj=GetItemTypeId(it)if(bj=='I004')thencall RemoveItem(it)if(rd)thenset mk=GetPlayerId(p)set fe[mk]=fe[mk]+($5DC)
call AdjustPlayerStateBJ(1,p,PLAYER_STATE_RESOURCE_FOOD_CAP)
else
call AdjustPlayerStateBJ($5DC,p,PLAYER_STATE_RESOURCE_GOLD)call DisplayTextToPlayer(p,.0,.0,"|cffFF0000You can't increase your Legendaries limit! No Legendaries is activated!|r")endifelseif(bj=='I008')thenset mk=GetPlayerId(p)set fe[mk]=fe[mk]+(600)set u=CreateUnitAtLoc(p,'e008',R9,.0)call UnitAddAbility(u,'A06D')call UnitApplyTimedLife(u,'BTLF',29.)elseif(bj=='I007')thenset mk=GetPlayerId(p)set fe[mk]=fe[mk]+($578)
set u=CreateUnitAtLoc(p,'e008',R9,.0)call UnitAddAbility(u,'A06C')call UnitApplyTimedLife(u,'BTLF',29.)elseif(bj=='I001')thenset mk=GetPlayerId(p)set fe[mk]=fe[mk]+($96)elseif(bj=='I005')thenset mk=GetPlayerId(p)set fe[mk]=fe[mk]+($96)elseif(bj=='I003')thenset mk=GetPlayerId(p)set fe[mk]=fe[mk]+(650)elseif(bj=='I00A')thenset mk=GetPlayerId(p)set fe[mk]=fe[mk]+(600)elseif(bj=='I009')thenset mk=GetPlayerId(p)set fe[mk]=fe[mk]+(500)elseif(bj=='I006')thenset mk=GetPlayerId(p)set fe[mk]=fe[mk]+(550)elseif(bj=='I000')thencall Yi(p)call RemoveItem(it)call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\Transmute\\PileofGold.mdl",u,"origin"))
call OA(GetPlayerId(p))endifset it=nullset u=nullendfunctionfunction RA takes nothing returns booleanlocal unit u=GetTriggerUnit()local player pif(IsUnitType(u,UNIT_TYPE_PEON))then
set p=GetOwningPlayer(u)
call PingMinimapForPlayer(p,GetUnitX(u),GetUnitY(u),1.)call SetUnitPositionLoc(u,Qd[GetPlayerId(p)])call DisplayTextToPlayer(p,.0,.0,"|cffFF0000Your worker may not leave your castle!|r")endifset u=nullreturn false
endfunctionfunction TA takes nothing returns nothinglocal unit u=GetTriggerUnit()local player p=GetOwningPlayer(u)local integer HA=GetPlayerId(p)local integer aj=GetUnitPointValue(u)call Hj(u)set ee[HA]=ee[HA]+(t4[aj])if(v4[aj])thenif(w4[aj])thencall cr(u,t4[aj]*3/ 4)else
call cr(u,t4[aj])endifelse
set Ud[HA]=Ud[HA]+1endifcall Lv(HA,u)call GroupEnumUnitsOfPlayer(q4,p,b9)
call ForGroup(q4,function Rr)set HA=(x4[GetUnitPointValue((u))])if(HA>0)then
if(Gd[GetPlayerId(p)])thencall IssueImmediateOrderById(u,HA)call IssueImmediateOrderById(u,HA)endifelse
set aj=GetUnitTypeId(u)if(aj=='h001')thencall cv(u)call GroupAddUnit(ff,u)elseif(aj=='h05G')thencall Fv(u)elseif(aj=='h059')thencall sv(p)elseif(aj=='h063')thencall qo(p)elseif(aj=='h02D')thencall TimerStart(A7,4.,true,function qm)elseif(aj=='h00G')thencall UnitAddAbility(u,'A008')call UnitAddAbility(u,'A007')elseif(aj=='h061')thencall oo(u)elseif(aj=='h056' or aj=='h03L' or aj=='h01W' or aj=='h01X' or aj=='h05R')thencall IssueImmediateOrderById(u,$D027A)call TriggerSleepAction(1.)call IssueImmediateOrderById(u,$D027A)call IssueTargetOrderById(u,$D0279,GroupPickRandomUnit(P9))call TriggerSleepAction(45.)
call IssueTargetOrderById(u,$D0279,GroupPickRandomUnit(P9))elseif(aj=='h09T')thencall UnitAddAbility(u,'A09S')call UnitAddAbility(u,'A09P')call UnitAddAbility(u,'A09V')call GroupAddUnit(rf,u)elseif(aj=='h01O')thencall UnitAddAbility(u,'A01V')elseif(aj=='h008')thenset aj=GetPlayerId(p)set ge[aj]=ge[aj]+1endifendifif(yd)thencall Pj("BE: "+GetPlayerName(p)+" ->"+GetUnitName(u))call Rj()endifset u=nullendfunctionfunction VA takes nothing returns nothinglocal unit u=GetTriggerUnit()call cj(u)set u=nullendfunctionfunction XA takes nothing returns nothingcall Hj(GetTriggerUnit())endfunctionfunction ZA takes nothing returns booleanlocal unit u=GetTriggerUnit()local integer dk
if((x4[GetUnitPointValue((u))])>0)thenset dk=GetPlayerId(GetOwningPlayer(u))set Td[dk]=Td[dk]+1if(GetUnitAbilityLevel(u,'A0DS')>0)thencall Gn(u)endifendifset u=nullreturn false
endfunctionfunction ea takes nothing returns booleanlocal unit u=GetFilterUnit()
if(GetWidgetLife(u)>.405 and IsUnitAlly(u,r4)and IsUnitType(u,UNIT_TYPE_SAPPER))then
if(GetUnitTypeId(u)==bj_forLoopAIndex)thencall SetWidgetLife(u,GetWidgetLife(u)+bj_forLoopAIndexEnd)else
call SetWidgetLife(u,GetWidgetLife(u)+.3*bj_forLoopAIndexEnd)endifcall DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\Heal\\HealTarget.mdl",u,"overhead"))endifset u=nullreturn false
endfunctionfunction fa takes nothing returns nothinglocal unit u=GetTriggerUnit()local unit k=GetKillingUnit()local integer tif(IsUnitType(u,UNIT_TYPE_SAPPER))thenif(GetUnitAbilityLevel(u,'A07M')>=1)then
call GroupRemoveUnit(z9,u)set M8[GetUnitUserData((u))]=falseelseif(GetUnitTypeId(u)=='h06B')then
call Qw(u)endifif(k!=null)thenif(not IsUnitType(k,UNIT_TYPE_STRUCTURE))thenset t=GetPlayerId(GetOwningPlayer(k))set Sd[t]=Sd[t]+1if(GetUnitTypeId(u)=='e00A')then
call UnitDamageTarget(u,k,350.,true,false,ATTACK_TYPE_CHAOS,DAMAGE_TYPE_NORMAL,WEAPON_TYPE_WHOKNOWS)
endifset t=GetUnitTypeId(k)if(t=='n00V' or t=='n01O')thencall IssueImmediateOrderById(k,$D0084)call Po(k)elseif(t=='e00B')thencall SetUnitLifePercentBJ(k,GetUnitLifePercent(k)+14.)elseif(t=='e00A')thencall SetUnitLifePercentBJ(k,GetUnitLifePercent(k)+20.)elseif(t=='h01U' and GetUnitAbilityLevel(u,'A08H')<=0 and(not IsUnitType(u,UNIT_TYPE_MECHANICAL))and(not IsUnitType(u,UNIT_TYPE_UNDEAD)))thencall hy(k,u,'h01V')set u=nullelseif(t=='h05H' and GetUnitAbilityLevel(u,'A08H')<=0 and(not IsUnitType(u,UNIT_TYPE_MECHANICAL))and(not IsUnitType(u,UNIT_TYPE_UNDEAD)))thencall hy(k,u,'h01U')set u=nullelseif(GetUnitAbilityLevel(u,'A07M')>=1)then
call Lo(u)endifendifif(GetUnitAbilityLevel(u,'A07G')<=0 and GetUnitAbilityLevel(u,'A07H')<=0 and not IsUnitType(u,UNIT_TYPE_SUMMONED))thenset t=me[GetPlayerId(GetOwningPlayer(u))]if(Kd[t]>0 and GetUnitAbilityLevel(u,'A0F5')>0)thenset r4=GetOwningPlayer(u)set bj_forLoopAIndexEnd=IMinBJ(20*Fn(GetPlayerId(r4)),500)call GroupEnumUnitsInRange(q4,GetUnitX(u),GetUnitY(u),512.,oh)endifif(ld[t]>0)thencall TriggerSleepAction(2.)if(u!=null and GetWidgetLife(u)<.405 and GetRandomInt(0,99)<IMinBJ(ld[t],40))thenset k=CreateUnit(GetOwningPlayer(u),GetUnitTypeId(u),GetUnitX(u),GetUnitY(u),.0)
call RemoveUnit(u)call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\Resurrect\\ResurrectCaster.mdl",k,"origin"))if(GetUnitAbilityLevel(k,'A07M')>=1)then
call Mo(k)call GroupAddUnit(z9,k)endifendifendifendifendifelseif(IsUnitType(u,UNIT_TYPE_STRUCTURE))thencall cj(u)call Mv(GetPlayerId(GetOwningPlayer(u)),u)if(GetUnitAbilityLevel(u,'A0EL')>0)thencall Mn(u)endifset t=GetUnitTypeId(u)if(t=='h05G')thencall Gv(u)elseif(t=='h059')thencall tv(u)elseif(t=='h063')thencall ro(u)elseif(t=='h008')thenset t=GetPlayerId(GetOwningPlayer(u))set ge[t]=ge[t]-1elseif(GetUnitAbilityLevel(u,'A0DS')>0)thencall In(u)elseif(t=='h061')thencall po(u)endifcall FlushChildHashtable(O9,GetHandleId(u))call GroupRemoveUnit(ff,u)call GroupRemoveUnit(rf,u)set u=GetKillingUnit()if(u!=null and nh)thenset t=me[GetPlayerId(GetOwningPlayer(u))]set Nd[t]=Nd[t]+1call Yr(3,t+1,I2S(Nd[t]))endifendifset k=nullset u=nullendfunctionfunction ha takes unit u,real tx,real ty returns nothing
local player p=GetOwningPlayer(u)local unit c=CreateUnit(p,'h04X',tx,ty,.0)local group g=CreateGroup()local real mj=.0
local integer Dj=0local unit j
local boolean ia
local integer dk
call SetUnitVertexColor(c,0,0,0,0)call UnitRemoveAbility(u,'A005')
call UnitRemoveAbility(u,'A06E')
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Items\\TomeOfRetraining\\TomeOfRetrainingCaster.mdl",u,"origin"))call DestroyEffect(AddSpecialEffectTarget("Units\\NightElf\\Wisp\\WispExplode.mdl",c,"origin"))call DestroyEffect(AddSpecialEffectTarget("Units\\NightElf\\Wisp\\WispExplode.mdl",c,"origin"))call DestroyEffect(AddSpecialEffectTarget("Units\\NightElf\\Wisp\\WispExplode.mdl",c,"origin"))call TriggerSleepAction(.35)
set r4=p
call GroupEnumUnitsInRange(g,tx,ty,700.,null)set ia=zdset zd=false
loop
set j=FirstOfGroup(g)exitwhen j==null
call GroupRemoveUnit(g,j)if(IsUnitEnemy(j,p)and GetWidgetLife(j)>.405 and GetUnitAbilityLevel(j,'Avul')<=0)thenset Dj=Dj+1set mj=mj+(GetWidgetLife(j))
call UnitDamageTarget(u,j,4444.,true,false,ATTACK_TYPE_CHAOS,DAMAGE_TYPE_DEATH,WEAPON_TYPE_WHOKNOWS)
call UnitDamageTarget(u,j,4444.,true,false,ATTACK_TYPE_MAGIC,DAMAGE_TYPE_DEATH,WEAPON_TYPE_WHOKNOWS)
endifendloopcall DestroyGroup(g)
set g=nullcall IssueImmediateOrderById(c,$D022E)set zd=iacall TriggerSleepAction(1.5)
call RemoveUnit(c)set c=nullset dk=GetPlayerId(p)set Wd[dk]=R2I(mj)set Xd[dk]=Djset Md[me[dk]]=Md[me[dk]]-1if(Md[me[dk]]==0)thencall Yr(1,me[dk]+1,"|cffFF00000|r")else
call Yr(1,me[dk]+1,I2S(Md[me[dk]]))endifcall Zr(H9[dk],me[dk]*6+1," ")if(Dj==0)thencall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,pe[dk]+" wasted his Rescue Strike, killing no unit! Epic Fail!")elseif(Dj==1)thencall DisplayTextToForce(bj_FORCE_ALL_PLAYERS,pe[dk]+" wasted his Rescue Strike, killing only one unit!")
elseif(Dj<5)then
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,pe[dk]+" wasted his Rescue Strike, dealing only |cffFFFF00"+I2S(Wd[dk])+"|r damage and killing only |cffFFFF00"+I2S(Dj)+"|r units!")else
call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,pe[dk]+" dealt |cffFFFF00"+I2S(Wd[dk])+"|r damage with his Rescue Strike, killing |cffFFFF00"+I2S(Dj)+"|r units!")endifendfunctionfunction ja takes unit u,real tx,real ty returns nothing
local unit c=CreateUnit(GetOwningPlayer(u),'e008',tx,ty,.0)call UnitAddAbility(c,'A02G')call IssueImmediateOrderById(c,$D012D)call UnitApplyTimedLife(c,'BTLF',1.)
set c=nullendfunctionfunction ka takes unit u,integer ma returns nothinglocal player p=GetOwningPlayer(u)if(ma==0)thenset ma='I008'elseif(ma==1)thenset ma='I007'elseif(ma==2)thenset ma='I006'elseif(ma==3)thenset ma='I003'elseif(ma==4)thenset ma='I004'elseif(ma==5)thenset ma='I005'elseif(ma==6)thenset ma='I00A'elseif(ma==7)thenset ma='I001'elseif(ma==8)thenset ma='I009'endifcall IssueNeutralImmediateOrderById(p,oe[me[GetPlayerId(p)]],ma)
endfunctionfunction na takes nothing returns nothinglocal unit u=GetTriggerUnit()local integer oa=GetSpellAbilityId()
if(IsUnitType(u,UNIT_TYPE_STRUCTURE))thenif(oa=='A09A')thencall Ar(u,(A4[GetUnitPointValue((u))]))elseif(oa=='A0EK')thencall Jn(u,GetSpellTargetUnit())else
call Kj(u)endifelseif(oa=='A005')thencall ha(u,GetSpellTargetX(),GetSpellTargetY())elseif(oa=='A08Y')thencall ja(u,GetSpellTargetX(),GetSpellTargetY())elseif(oa>='IBA0' and oa<='IBA8')thencall ka(u,oa-'IBA0')
else
call Nj(u,oa,GetSpellTargetUnit())endifset u=nullendfunctionfunction qa takes nothing returns nothinglocal unit u=GetTrainedUnit()local unit j=GetTriggerUnit()local integer bj=GetTrainedUnitType()if(GetUnitAbilityLevel(u,'A07J')>0)thenset u=Su(u)elseif(GetUnitTypeId(u)=='h06U')then
call SetUnitState(u,UNIT_STATE_MANA,GetRandomReal(.0,50.))endifcall Wr(u,j)
set u=nullif(Gd[GetPlayerId(GetOwningPlayer(j))])thencall TriggerSleepAction(.1)call IssueImmediateOrderById(j,bj)endifset j=nullendfunctionfunction sa takes nothing returns booleanlocal unit u=GetTriggerUnit()local integer aj
if(IsUnitType(u,UNIT_TYPE_SAPPER))thencall TriggerRegisterUnitEvent(Nf,u,EVENT_UNIT_DAMAGED)set aj=GetUnitTypeId(u)if(aj=='n01B')thencall SetUnitVertexColor(u,82,0,$87,'f')elseif(aj=='e00F')thenset u=nullreturn trueelseif(GetUnitAbilityLevel(u,'A0E5')>0)thencall SetUnitVertexColor(u,$FF,$FF,$FF,$FF-60*GetUnitLevel(u))endifcall Qo(u)endifset u=nullreturn false
endfunctionfunction ta takes nothing returns nothingcall hx(GetTriggerUnit())endfunctionfunction va takes nothing returns nothinglocal unit u=GetTriggerUnit()if(IsUnitType(GetTriggerUnit(),UNIT_TYPE_SAPPER)and not IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE))thenif(GetUnitAbilityLevel(u,'A07H')>0)thencall DisableTrigger(kh)call SetUnitOwner(u,GetChangingUnitPrevOwner(),true)
call EnableTrigger(kh)call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\DispelMagic\\DispelMagicTarget.mdl",u,"origin"))elseif(GetUnitTypeId(GetTriggerUnit())=='h03A')thencall TriggerSleepAction(.1)call IssueImmediateOrderById(u,$D0057)call TriggerSleepAction(.1)endifendifcall Qo(u)set u=nullendfunctionfunction InitCustomTeams takes nothing returns nothingcall SetPlayerTeam(Player(0),0)call SetPlayerState(Player(0),PLAYER_STATE_ALLIED_VICTORY,1)
call SetPlayerTeam(Player(1),0)call SetPlayerState(Player(1),PLAYER_STATE_ALLIED_VICTORY,1)
call SetPlayerAllianceStateAllyBJ(Player(0),Player(1),true)call SetPlayerAllianceStateAllyBJ(Player(1),Player(0),true)call SetPlayerAllianceStateVisionBJ(Player(0),Player(1),true)call SetPlayerAllianceStateVisionBJ(Player(1),Player(0),true)call SetPlayerTeam(Player(6),1)call SetPlayerState(Player(6),PLAYER_STATE_ALLIED_VICTORY,1)
call SetPlayerTeam(Player(7),1)call SetPlayerState(Player(7),PLAYER_STATE_ALLIED_VICTORY,1)
call SetPlayerAllianceStateAllyBJ(Player(6),Player(7),true)call SetPlayerAllianceStateAllyBJ(Player(7),Player(6),true)call SetPlayerAllianceStateVisionBJ(Player(6),Player(7),true)call SetPlayerAllianceStateVisionBJ(Player(7),Player(6),true)endfunctionfunction main takes nothing returns nothinglocal weathereffect wecall SetCameraBounds(-5632.+GetCameraMargin(CAMERA_MARGIN_LEFT),-3584.+GetCameraMargin(CAMERA_MARGIN_BOTTOM),5632.-GetCameraMargin(CAMERA_MARGIN_RIGHT),3584.-GetCameraMargin(CAMERA_MARGIN_TOP),-5632.+GetCameraMargin(CAMERA_MARGIN_LEFT),3584.-GetCameraMargin(CAMERA_MARGIN_TOP),5632.-GetCameraMargin(CAMERA_MARGIN_RIGHT),-3584.+GetCameraMargin(CAMERA_MARGIN_BOTTOM))call SetDayNightModels("Environment\\DNC\\DNCAshenvale\\DNCAshenvaleTerrain\\DNCAshenvaleTerrain.mdl","Environment\\DNC\\DNCAshenvale\\DNCAshenvaleUnit\\DNCAshenvaleUnit.mdl")call NewSoundEnvironment("Default")call SetAmbientDaySound("AshenvaleDay")call SetAmbientNightSound("AshenvaleNight")call SetMapMusic("Music",true,0)
set Gg=CreateSound("Sound\\Ambient\\DoodadEffects\\TheHornOfCenarius.wav",false,false,false,$A,$A,"DefaultEAXON")call SetSoundParamsFromLabel(Gg,"HornOfCenariusSound")call SetSoundDuration(Gg,$2F59)set Hg=CreateSound("Sound\\Interface\\CreepAggroWhat1.wav",false,false,false,$A,$A,"DefaultEAXON")call SetSoundParamsFromLabel(Hg,"CreepAggro")call SetSoundDuration(Hg,$4D4)set Ig=CreateSound("Units\\Demon\\HeroPitLord\\HPitLordYesAttack2.wav",false,false,false,$A,$A,"HeroAcksEAX")call SetSoundParamsFromLabel(Ig,"HeroPitLordYesAttack")call SetSoundDuration(Ig,$9C7)set lg=CreateSound("Units\\NightElf\\Wisp\\WispPissed3.wav",false,false,false,$A,$A,"DefaultEAXON")call SetSoundParamsFromLabel(lg,"WispPissed")call SetSoundDuration(lg,$A7A)set Jg=CreateSound("Units\\Critters\\BloodElfPeasant\\BloodElfEngineerWarcry1.wav",false,false,false,$A,$A,"DefaultEAXON")call SetSoundParamsFromLabel(Jg,"BloodElfEngineerWarcry")call SetSoundDuration(Jg,$44E)set Kg=CreateSound("Units\\Human\\Peasant\\PeasantReady1.wav",false,false,false,$A,$A,"DefaultEAXON")call SetSoundParamsFromLabel(Kg,"PeasantReady")call SetSoundDuration(Kg,892)set Lg=CreateSound("Units\\Creeps\\HeroTinker\\HeroTinkerReady1.wav",false,false,false,$A,$A,"HeroAcksEAX")call SetSoundParamsFromLabel(Lg,"HeroTinkerReady")call SetSoundDuration(Lg,$AF3)set Mg=CreateSound("Units\\Creeps\\Murloc\\MurlocPissed2.wav",false,false,false,$A,$A,"DefaultEAXON")call SetSoundParamsFromLabel(Mg,"MurlocPissed")call SetSoundDuration(Mg,853)set Ng=CreateSound("Units\\NightElf\\Ent\\EntReady1.wav",false,false,false,$A,$A,"DefaultEAXON")
call SetSoundParamsFromLabel(Ng,"EntReady")call SetSoundDuration(Ng,$912)call SetSoundChannel(Ng,1)set Og=CreateSound("Units\\NightElf\\Runner\\RunnerWarcry1.wav",false,false,false,$A,$A,"DefaultEAXON")call SetSoundParamsFromLabel(Og,"RunnerWarcry")call SetSoundDuration(Og,$478)set Pg=CreateSound("Units\\Creeps\\Bandit\\BanditWhat1.wav",false,false,false,$A,$A,"DefaultEAXON")call SetSoundParamsFromLabel(Pg,"BanditWhat")call SetSoundDuration(Pg,520)set Qg=CreateSound("Units\\Orc\\Peon\\PeonReady1.wav",false,false,false,$A,$A,"DefaultEAXON")call SetSoundParamsFromLabel(Qg,"PeonReady")
call SetSoundDuration(Qg,$6BC)call SetSoundChannel(Qg,1)set Rg=CreateSound("Units\\Undead\\Acolyte\\AcolyteWarcry1.wav",false,false,false,$A,$A,"DefaultEAXON")call SetSoundParamsFromLabel(Rg,"AcolyteWarcry")
call SetSoundDuration(Rg,$72D)set Sg=CreateSound("Units\\Demon\\Pitlord\\PitLordYesAttack1.wav",false,false,true,$A,$A,"DefaultEAXON")
call SetSoundParamsFromLabel(Sg,"PitLordYesAttack")call SetSoundDuration(Sg,$A67)call SetSoundChannel(Sg,1)set Tg=CreateSound("Sound\\Interface\\BattleNetTick.wav",false,false,false,$A,$A,"DefaultEAXON")
call SetSoundParamsFromLabel(Tg,"ChatroomTimerTick")
call SetSoundDuration(Tg,476)set Ug=CreateSound("Sound\\Interface\\Hint.wav",false,false,false,$A,$A,"DefaultEAXON")call SetSoundParamsFromLabel(Ug,"Hint")call SetSoundDuration(Ug,$7D6)set cg=Rect(-5632.,-2048.,-1440.,2048.)set Dg=Rect(1440.,-2048.,5632.,2048.)set Eg=Rect(-5248.,-384.,-4480.,384.)set Fg=Rect(4480.,-384.,5248.,384.)call InitBlizzard()call ExecuteFunc("xa")call ExecuteFunc("gj")call ExecuteFunc("pj")call ExecuteFunc("Oj")call ExecuteFunc("Wj")call ExecuteFunc("ik")call ExecuteFunc("ok")call ExecuteFunc("qk")call ExecuteFunc("ak")call ExecuteFunc("pm")call ExecuteFunc("ym")call ExecuteFunc("Pm")call ExecuteFunc("Zm")call ExecuteFunc("hn")call ExecuteFunc("bn")call ExecuteFunc("so")call ExecuteFunc("ao")call ExecuteFunc("Go")call ExecuteFunc("No")call ExecuteFunc("Zo")call ExecuteFunc("Xr")call ExecuteFunc("Us")call ExecuteFunc("Tu")call ExecuteFunc("gv")call ExecuteFunc("uv")call ExecuteFunc("Iv")call ExecuteFunc("dw")call ExecuteFunc("Bw")call ExecuteFunc("Gw")call ExecuteFunc("kx")call ExecuteFunc("Hx")call ExecuteFunc("Vx")call ExecuteFunc("iy")call ExecuteFunc("mz")call ExecuteFunc("Az")call ExecuteFunc("Cz")call ExecuteFunc("fA")call ExecuteFunc("qA")set Vg=CreateTrigger()call TriggerRegisterAnyUnitEventBJ(Vg,EVENT_PLAYER_UNIT_SUMMON)call TriggerAddAction(Vg,function DA)set Wg=CreateTrigger()call TriggerRegisterPlayerEventLeave(Wg,Player(0))call TriggerRegisterPlayerEventLeave(Wg,Player(1))call TriggerRegisterPlayerEventLeave(Wg,Player(2))call TriggerRegisterPlayerEventLeave(Wg,Player(3))call TriggerRegisterPlayerEventLeave(Wg,Player(4))call TriggerRegisterPlayerEventLeave(Wg,Player(5))call TriggerRegisterPlayerEventLeave(Wg,Player(6))call TriggerRegisterPlayerEventLeave(Wg,Player(7))call TriggerRegisterPlayerEventLeave(Wg,Player(8))call TriggerRegisterPlayerEventLeave(Wg,Player(9))call TriggerRegisterPlayerEventLeave(Wg,Player($A))call TriggerRegisterPlayerEventLeave(Wg,Player($B))call TriggerAddAction(Wg,function MA)set Xg=CreateTrigger()call TriggerAddAction(Xg,function PA)call TriggerRegisterAnyUnitEventBJ(Xg,EVENT_PLAYER_UNIT_PICKUP_ITEM)
set Yg=CreateTrigger()call TriggerRegisterLeaveRectSimple(Yg,cg)call TriggerRegisterLeaveRectSimple(Yg,Dg)call TriggerAddCondition(Yg,Condition(function RA))set Zg=CreateTrigger()call TriggerRegisterAnyUnitEventBJ(Zg,EVENT_PLAYER_UNIT_CONSTRUCT_FINISH)call TriggerRegisterAnyUnitEventBJ(Zg,EVENT_PLAYER_UNIT_UPGRADE_FINISH)call TriggerAddAction(Zg,function TA)set dh=CreateTrigger()call TriggerRegisterAnyUnitEventBJ(dh,EVENT_PLAYER_UNIT_UPGRADE_START)call TriggerAddAction(dh,function VA)set eh=CreateTrigger()call TriggerRegisterAnyUnitEventBJ(eh,EVENT_PLAYER_UNIT_UPGRADE_CANCEL)call TriggerAddAction(eh,function XA)set fh=CreateTrigger()call TriggerRegisterAnyUnitEventBJ(fh,EVENT_PLAYER_UNIT_CONSTRUCT_FINISH)call TriggerAddCondition(fh,Condition(function ZA))set gh=CreateTrigger()call TriggerRegisterAnyUnitEventBJ(gh,EVENT_PLAYER_UNIT_DEATH)call TriggerAddAction(gh,function fa)set oh=Filter(function ea)set hh=CreateTrigger()call TriggerRegisterAnyUnitEventBJ(hh,EVENT_PLAYER_UNIT_SPELL_EFFECT)call TriggerAddAction(hh,function na)set ih=CreateTrigger()call TriggerRegisterAnyUnitEventBJ(ih,EVENT_PLAYER_UNIT_TRAIN_FINISH)call TriggerAddAction(ih,function qa)set jh=CreateTrigger()call TriggerRegisterEnterRectSimple(jh,bj_mapInitialPlayableArea)call TriggerAddCondition(jh,Condition(function sa))call TriggerAddAction(jh,function ta)set kh=CreateTrigger()call TriggerRegisterAnyUnitEventBJ(kh,EVENT_PLAYER_UNIT_CHANGE_OWNER)call TriggerAddAction(kh,function va)endfunctionfunction config takes nothing returns nothingcall SetMapName("|cffFFD700Castle Fight 1.22a ES")call SetMapDescription("An epic battle between the two castles!

Recommended gamemode is 4on4 with 2 wins.

hf!")call SetPlayers(4)call SetTeams(4)
call SetGamePlacement(MAP_PLACEMENT_TEAMS_TOGETHER)call DefineStartLocation(0,-4288.,448.)call DefineStartLocation(1,-4288.,320.)call DefineStartLocation(2,4288.,448.)call DefineStartLocation(3,4288.,320.)call SetPlayerStartLocation(Player(0),0)
call ForcePlayerStartLocation(Player(0),0)call SetPlayerColor(Player(0),ConvertPlayerColor(0))
call SetPlayerRacePreference(Player(0),RACE_PREF_NIGHTELF)call SetPlayerRaceSelectable(Player(0),false)call SetPlayerController(Player(0),MAP_CONTROL_USER)
call SetPlayerStartLocation(Player(1),1)
call ForcePlayerStartLocation(Player(1),1)call SetPlayerColor(Player(1),ConvertPlayerColor(1))
call SetPlayerRacePreference(Player(1),RACE_PREF_NIGHTELF)call SetPlayerRaceSelectable(Player(1),false)call SetPlayerController(Player(1),MAP_CONTROL_USER)
call SetPlayerStartLocation(Player(6),2)
call ForcePlayerStartLocation(Player(6),2)call SetPlayerColor(Player(6),ConvertPlayerColor(6))
call SetPlayerRacePreference(Player(6),RACE_PREF_UNDEAD)
call SetPlayerRaceSelectable(Player(6),false)call SetPlayerController(Player(6),MAP_CONTROL_USER)
call SetPlayerStartLocation(Player(7),3)
call ForcePlayerStartLocation(Player(7),3)call SetPlayerColor(Player(7),ConvertPlayerColor(7))
call SetPlayerRacePreference(Player(7),RACE_PREF_UNDEAD)
call SetPlayerRaceSelectable(Player(7),false)call SetPlayerController(Player(7),MAP_CONTROL_USER)
call InitCustomTeams()call SetStartLocPrioCount(0,1)call SetStartLocPrio(0,0,1,MAP_LOC_PRIO_HIGH)call SetStartLocPrioCount(1,1)call SetStartLocPrio(1,0,0,MAP_LOC_PRIO_HIGH)call SetStartLocPrioCount(2,1)call SetStartLocPrio(2,0,3,MAP_LOC_PRIO_HIGH)call SetStartLocPrioCount(3,1)call SetStartLocPrio(3,0,2,MAP_LOC_PRIO_HIGH)endfunctionfunction ya takes nothing returns booleanlocal integer oi=kicall FlushStoredInteger(t7,"val:"+vh[oi],th[oi])
call FlushStoredInteger(t7,"chk:"+vh[oi],vh[oi])
set th[oi]=nullset vh[oi]=nullset wh[oi]=0
return trueendfunctionfunction za takes nothing returns booleanset mi=tp(ki,ii)
return trueendfunctionfunction Aa takes nothing returns booleanset mi=sp(ki,ii)
return trueendfunctionfunction aa takes nothing returns booleanset mi=rp(ki,ii)
return trueendfunctionfunction Ba takes nothing returns booleanset mi=qp(ki,ii)
return trueendfunctionfunction ba takes nothing returns booleanset mi=pp(ki,ii)
return trueendfunctionfunction Ca takes nothing returns booleanset mi=np(ki,ii)
return trueendfunctionfunction ca takes nothing returns booleanset mi=kp(ki,ii)
return trueendfunctionfunction Da takes nothing returns booleanset mi=jp(ki,ii)
return trueendfunctionfunction Ea takes nothing returns booleanset mi=ip(ki,ii)
return trueendfunctionfunction Fa takes nothing returns booleanset mi=hp(ki,ii)
return trueendfunctionfunction Ga takes nothing returns booleanset mi=gp(ki,ii)
return trueendfunctionfunction Ha takes nothing returns booleanset mi=fp(ki,ii)
return trueendfunctionfunction Ia takes nothing returns booleanlocal integer oi=kilocal integer Hi=jiset Eh[Fh[oi]+Gh[oi]]=Hi
set Gh[oi]=Gh[oi]+1return trueendfunctionfunction la takes nothing returns booleanset mi=up(ki,ii)
return trueendfunctionfunction xa takes nothing returns nothingset gi=CreateTrigger()call TriggerAddCondition(gi,Condition(function ya))set Bh[16]=CreateTrigger()call TriggerAddCondition(Bh[16],Condition(function za))call TriggerAddAction(Bh[16],function za)set ah[16]=nullset Bh[$F]=CreateTrigger()call TriggerAddCondition(Bh[$F],Condition(function Aa))call TriggerAddAction(Bh[$F],function Aa)set ah[$F]=nullset Bh[$E]=CreateTrigger()call TriggerAddCondition(Bh[$E],Condition(function aa))call TriggerAddAction(Bh[$E],function aa)set ah[$E]=nullset Bh[$D]=CreateTrigger()call TriggerAddCondition(Bh[$D],Condition(function Ba))call TriggerAddAction(Bh[$D],function Ba)set ah[$D]=nullset Bh[$C]=CreateTrigger()call TriggerAddCondition(Bh[$C],Condition(function ba))call TriggerAddAction(Bh[$C],function ba)set ah[$C]=nullset Bh[$B]=CreateTrigger()call TriggerAddCondition(Bh[$B],Condition(function Ca))call TriggerAddAction(Bh[$B],function Ca)set ah[$B]=nullset Bh[$A]=CreateTrigger()call TriggerAddCondition(Bh[$A],Condition(function ca))call TriggerAddAction(Bh[$A],function ca)set ah[$A]=nullset Bh[9]=CreateTrigger()call TriggerAddCondition(Bh[9],Condition(function Da))call TriggerAddAction(Bh[9],function Da)
set ah[9]=nullset Bh[8]=CreateTrigger()call TriggerAddCondition(Bh[8],Condition(function Ea))call TriggerAddAction(Bh[8],function Ea)
set ah[8]=nullset Bh[7]=CreateTrigger()call TriggerAddCondition(Bh[7],Condition(function Fa))call TriggerAddAction(Bh[7],function Fa)
set ah[7]=nullset Bh[6]=CreateTrigger()call TriggerAddCondition(Bh[6],Condition(function Ga))call TriggerAddAction(Bh[6],function Ga)
set ah[6]=nullset Bh[5]=CreateTrigger()call TriggerAddCondition(Bh[5],Condition(function Ha))call TriggerAddAction(Bh[5],function Ha)
set ah[5]=nullset hi=CreateTrigger()call TriggerAddCondition(hi,Condition(function Ia))set Bh[17]=CreateTrigger()call TriggerAddCondition(Bh[17],Condition(function la))call TriggerAddAction(Bh[17],function la)set ah[17]=nullendfunction